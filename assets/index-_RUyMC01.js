(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function Lf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Gu={exports:{}},Ga={},Ku={exports:{}},X={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cs=Symbol.for("react.element"),Of=Symbol.for("react.portal"),Mf=Symbol.for("react.fragment"),Af=Symbol.for("react.strict_mode"),If=Symbol.for("react.profiler"),Bf=Symbol.for("react.provider"),$f=Symbol.for("react.context"),Df=Symbol.for("react.forward_ref"),Gf=Symbol.for("react.suspense"),Kf=Symbol.for("react.memo"),Uf=Symbol.for("react.lazy"),Ql=Symbol.iterator;function Ff(e){return e===null||typeof e!="object"?null:(e=Ql&&e[Ql]||e["@@iterator"],typeof e=="function"?e:null)}var Uu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Fu=Object.assign,Wu={};function Tn(e,t,r){this.props=e,this.context=t,this.refs=Wu,this.updater=r||Uu}Tn.prototype.isReactComponent={};Tn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Tn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function zu(){}zu.prototype=Tn.prototype;function Qo(e,t,r){this.props=e,this.context=t,this.refs=Wu,this.updater=r||Uu}var Jo=Qo.prototype=new zu;Jo.constructor=Qo;Fu(Jo,Tn.prototype);Jo.isPureReactComponent=!0;var Jl=Array.isArray,Hu=Object.prototype.hasOwnProperty,Xo={current:null},Vu={key:!0,ref:!0,__self:!0,__source:!0};function qu(e,t,r){var n,s={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Hu.call(t,n)&&!Vu.hasOwnProperty(n)&&(s[n]=t[n]);var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}if(e&&e.defaultProps)for(n in c=e.defaultProps,c)s[n]===void 0&&(s[n]=c[n]);return{$$typeof:Cs,type:e,key:a,ref:o,props:s,_owner:Xo.current}}function Wf(e,t){return{$$typeof:Cs,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Zo(e){return typeof e=="object"&&e!==null&&e.$$typeof===Cs}function zf(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Xl=/\/+/g;function ai(e,t){return typeof e=="object"&&e!==null&&e.key!=null?zf(""+e.key):t.toString(36)}function ea(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Cs:case Of:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+ai(o,0):n,Jl(s)?(r="",e!=null&&(r=e.replace(Xl,"$&/")+"/"),ea(s,t,r,"",function(u){return u})):s!=null&&(Zo(s)&&(s=Wf(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Xl,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",Jl(e))for(var c=0;c<e.length;c++){a=e[c];var l=n+ai(a,c);o+=ea(a,t,r,l,s)}else if(l=Ff(e),typeof l=="function")for(e=l.call(e),c=0;!(a=e.next()).done;)a=a.value,l=n+ai(a,c++),o+=ea(a,t,r,l,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Os(e,t,r){if(e==null)return e;var n=[],s=0;return ea(e,n,"","",function(a){return t.call(r,a,s++)}),n}function Hf(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ve={current:null},ta={transition:null},Vf={ReactCurrentDispatcher:Ve,ReactCurrentBatchConfig:ta,ReactCurrentOwner:Xo};function Yu(){throw Error("act(...) is not supported in production builds of React.")}X.Children={map:Os,forEach:function(e,t,r){Os(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Os(e,function(){t++}),t},toArray:function(e){return Os(e,function(t){return t})||[]},only:function(e){if(!Zo(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};X.Component=Tn;X.Fragment=Mf;X.Profiler=If;X.PureComponent=Qo;X.StrictMode=Af;X.Suspense=Gf;X.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vf;X.act=Yu;X.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Fu({},e.props),s=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=Xo.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)Hu.call(t,l)&&!Vu.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&c!==void 0?c[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];n.children=c}return{$$typeof:Cs,type:e.type,key:s,ref:a,props:n,_owner:o}};X.createContext=function(e){return e={$$typeof:$f,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Bf,_context:e},e.Consumer=e};X.createElement=qu;X.createFactory=function(e){var t=qu.bind(null,e);return t.type=e,t};X.createRef=function(){return{current:null}};X.forwardRef=function(e){return{$$typeof:Df,render:e}};X.isValidElement=Zo;X.lazy=function(e){return{$$typeof:Uf,_payload:{_status:-1,_result:e},_init:Hf}};X.memo=function(e,t){return{$$typeof:Kf,type:e,compare:t===void 0?null:t}};X.startTransition=function(e){var t=ta.transition;ta.transition={};try{e()}finally{ta.transition=t}};X.unstable_act=Yu;X.useCallback=function(e,t){return Ve.current.useCallback(e,t)};X.useContext=function(e){return Ve.current.useContext(e)};X.useDebugValue=function(){};X.useDeferredValue=function(e){return Ve.current.useDeferredValue(e)};X.useEffect=function(e,t){return Ve.current.useEffect(e,t)};X.useId=function(){return Ve.current.useId()};X.useImperativeHandle=function(e,t,r){return Ve.current.useImperativeHandle(e,t,r)};X.useInsertionEffect=function(e,t){return Ve.current.useInsertionEffect(e,t)};X.useLayoutEffect=function(e,t){return Ve.current.useLayoutEffect(e,t)};X.useMemo=function(e,t){return Ve.current.useMemo(e,t)};X.useReducer=function(e,t,r){return Ve.current.useReducer(e,t,r)};X.useRef=function(e){return Ve.current.useRef(e)};X.useState=function(e){return Ve.current.useState(e)};X.useSyncExternalStore=function(e,t,r){return Ve.current.useSyncExternalStore(e,t,r)};X.useTransition=function(){return Ve.current.useTransition()};X.version="18.3.1";Ku.exports=X;var N=Ku.exports;const qf=Lf(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yf=N,Qf=Symbol.for("react.element"),Jf=Symbol.for("react.fragment"),Xf=Object.prototype.hasOwnProperty,Zf=Yf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ep={key:!0,ref:!0,__self:!0,__source:!0};function Qu(e,t,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)Xf.call(t,n)&&!ep.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:Qf,type:e,key:a,ref:o,props:s,_owner:Zf.current}}Ga.Fragment=Jf;Ga.jsx=Qu;Ga.jsxs=Qu;Gu.exports=Ga;var i=Gu.exports,Ki={},Ju={exports:{}},dt={},Xu={exports:{}},Zu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,G){var K=O.length;O.push(G);e:for(;0<K;){var J=K-1>>>1,ne=O[J];if(0<s(ne,G))O[J]=G,O[K]=ne,K=J;else break e}}function r(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var G=O[0],K=O.pop();if(K!==G){O[0]=K;e:for(var J=0,ne=O.length,et=ne>>>1;J<et;){var ke=2*(J+1)-1,kt=O[ke],L=ke+1,W=O[L];if(0>s(kt,K))L<ne&&0>s(W,kt)?(O[J]=W,O[L]=K,J=L):(O[J]=kt,O[ke]=K,J=ke);else if(L<ne&&0>s(W,K))O[J]=W,O[L]=K,J=L;else break e}}return G}function s(O,G){var K=O.sortIndex-G.sortIndex;return K!==0?K:O.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();e.unstable_now=function(){return o.now()-c}}var l=[],u=[],g=1,m=null,h=3,v=!1,y=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,d=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function f(O){for(var G=r(u);G!==null;){if(G.callback===null)n(u);else if(G.startTime<=O)n(u),G.sortIndex=G.expirationTime,t(l,G);else break;G=r(u)}}function w(O){if(b=!1,f(O),!y)if(r(l)!==null)y=!0,z(j);else{var G=r(u);G!==null&&re(w,G.startTime-O)}}function j(O,G){y=!1,b&&(b=!1,d(S),S=-1),v=!0;var K=h;try{for(f(G),m=r(l);m!==null&&(!(m.expirationTime>G)||O&&!M());){var J=m.callback;if(typeof J=="function"){m.callback=null,h=m.priorityLevel;var ne=J(m.expirationTime<=G);G=e.unstable_now(),typeof ne=="function"?m.callback=ne:m===r(l)&&n(l),f(G)}else n(l);m=r(l)}if(m!==null)var et=!0;else{var ke=r(u);ke!==null&&re(w,ke.startTime-G),et=!1}return et}finally{m=null,h=K,v=!1}}var _=!1,k=null,S=-1,C=5,R=-1;function M(){return!(e.unstable_now()-R<C)}function I(){if(k!==null){var O=e.unstable_now();R=O;var G=!0;try{G=k(!0,O)}finally{G?E():(_=!1,k=null)}}else _=!1}var E;if(typeof p=="function")E=function(){p(I)};else if(typeof MessageChannel<"u"){var T=new MessageChannel,D=T.port2;T.port1.onmessage=I,E=function(){D.postMessage(null)}}else E=function(){x(I,0)};function z(O){k=O,_||(_=!0,E())}function re(O,G){S=x(function(){O(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){y||v||(y=!0,z(j))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(O){switch(h){case 1:case 2:case 3:var G=3;break;default:G=h}var K=h;h=G;try{return O()}finally{h=K}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,G){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var K=h;h=O;try{return G()}finally{h=K}},e.unstable_scheduleCallback=function(O,G,K){var J=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?J+K:J):K=J,O){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=K+ne,O={id:g++,callback:G,priorityLevel:O,startTime:K,expirationTime:ne,sortIndex:-1},K>J?(O.sortIndex=K,t(u,O),r(l)===null&&O===r(u)&&(b?(d(S),S=-1):b=!0,re(w,K-J))):(O.sortIndex=ne,t(l,O),y||v||(y=!0,z(j))),O},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(O){var G=h;return function(){var K=h;h=G;try{return O.apply(this,arguments)}finally{h=K}}}})(Zu);Xu.exports=Zu;var tp=Xu.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rp=N,ct=tp;function P(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ed=new Set,ns={};function Kr(e,t){Sn(e,t),Sn(e+"Capture",t)}function Sn(e,t){for(ns[e]=t,e=0;e<t.length;e++)ed.add(t[e])}var Vt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ui=Object.prototype.hasOwnProperty,np=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zl={},ec={};function sp(e){return Ui.call(ec,e)?!0:Ui.call(Zl,e)?!1:np.test(e)?ec[e]=!0:(Zl[e]=!0,!1)}function ap(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ip(e,t,r,n){if(t===null||typeof t>"u"||ap(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function qe(e,t,r,n,s,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Be={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Be[e]=new qe(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Be[t]=new qe(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Be[e]=new qe(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Be[e]=new qe(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Be[e]=new qe(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Be[e]=new qe(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Be[e]=new qe(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Be[e]=new qe(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Be[e]=new qe(e,5,!1,e.toLowerCase(),null,!1,!1)});var el=/[\-:]([a-z])/g;function tl(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(el,tl);Be[t]=new qe(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(el,tl);Be[t]=new qe(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(el,tl);Be[t]=new qe(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Be[e]=new qe(e,1,!1,e.toLowerCase(),null,!1,!1)});Be.xlinkHref=new qe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Be[e]=new qe(e,1,!1,e.toLowerCase(),null,!0,!0)});function rl(e,t,r,n){var s=Be.hasOwnProperty(t)?Be[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ip(t,r,s,n)&&(r=null),n||s===null?sp(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Jt=rp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ms=Symbol.for("react.element"),tn=Symbol.for("react.portal"),rn=Symbol.for("react.fragment"),nl=Symbol.for("react.strict_mode"),Fi=Symbol.for("react.profiler"),td=Symbol.for("react.provider"),rd=Symbol.for("react.context"),sl=Symbol.for("react.forward_ref"),Wi=Symbol.for("react.suspense"),zi=Symbol.for("react.suspense_list"),al=Symbol.for("react.memo"),tr=Symbol.for("react.lazy"),nd=Symbol.for("react.offscreen"),tc=Symbol.iterator;function On(e){return e===null||typeof e!="object"?null:(e=tc&&e[tc]||e["@@iterator"],typeof e=="function"?e:null)}var ye=Object.assign,ii;function Kn(e){if(ii===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ii=t&&t[1]||""}return`
`+ii+e}var oi=!1;function li(e,t){if(!e||oi)return"";oi=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,c=a.length-1;1<=o&&0<=c&&s[o]!==a[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==a[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==a[c]){var l=`
`+s[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=c);break}}}finally{oi=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Kn(e):""}function op(e){switch(e.tag){case 5:return Kn(e.type);case 16:return Kn("Lazy");case 13:return Kn("Suspense");case 19:return Kn("SuspenseList");case 0:case 2:case 15:return e=li(e.type,!1),e;case 11:return e=li(e.type.render,!1),e;case 1:return e=li(e.type,!0),e;default:return""}}function Hi(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case rn:return"Fragment";case tn:return"Portal";case Fi:return"Profiler";case nl:return"StrictMode";case Wi:return"Suspense";case zi:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case rd:return(e.displayName||"Context")+".Consumer";case td:return(e._context.displayName||"Context")+".Provider";case sl:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case al:return t=e.displayName||null,t!==null?t:Hi(e.type)||"Memo";case tr:t=e._payload,e=e._init;try{return Hi(e(t))}catch{}}return null}function lp(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hi(t);case 8:return t===nl?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function yr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function sd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function cp(e){var t=sd(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function As(e){e._valueTracker||(e._valueTracker=cp(e))}function ad(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=sd(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function ha(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Vi(e,t){var r=t.checked;return ye({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function rc(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=yr(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function id(e,t){t=t.checked,t!=null&&rl(e,"checked",t,!1)}function qi(e,t){id(e,t);var r=yr(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Yi(e,t.type,r):t.hasOwnProperty("defaultValue")&&Yi(e,t.type,yr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function nc(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Yi(e,t,r){(t!=="number"||ha(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Un=Array.isArray;function gn(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+yr(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Qi(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(P(91));return ye({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function sc(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(P(92));if(Un(r)){if(1<r.length)throw Error(P(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:yr(r)}}function od(e,t){var r=yr(t.value),n=yr(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function ac(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ld(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ji(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ld(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Is,cd=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Is=Is||document.createElement("div"),Is.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Is.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ss(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Hn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},up=["Webkit","ms","Moz","O"];Object.keys(Hn).forEach(function(e){up.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Hn[t]=Hn[e]})});function ud(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Hn.hasOwnProperty(e)&&Hn[e]?(""+t).trim():t+"px"}function dd(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=ud(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var dp=ye({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xi(e,t){if(t){if(dp[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(P(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(P(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(P(61))}if(t.style!=null&&typeof t.style!="object")throw Error(P(62))}}function Zi(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eo=null;function il(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var to=null,yn=null,vn=null;function ic(e){if(e=Es(e)){if(typeof to!="function")throw Error(P(280));var t=e.stateNode;t&&(t=za(t),to(e.stateNode,e.type,t))}}function hd(e){yn?vn?vn.push(e):vn=[e]:yn=e}function fd(){if(yn){var e=yn,t=vn;if(vn=yn=null,ic(e),t)for(e=0;e<t.length;e++)ic(t[e])}}function pd(e,t){return e(t)}function md(){}var ci=!1;function gd(e,t,r){if(ci)return e(t,r);ci=!0;try{return pd(e,t,r)}finally{ci=!1,(yn!==null||vn!==null)&&(md(),fd())}}function as(e,t){var r=e.stateNode;if(r===null)return null;var n=za(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(P(231,t,typeof r));return r}var ro=!1;if(Vt)try{var Mn={};Object.defineProperty(Mn,"passive",{get:function(){ro=!0}}),window.addEventListener("test",Mn,Mn),window.removeEventListener("test",Mn,Mn)}catch{ro=!1}function hp(e,t,r,n,s,a,o,c,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(g){this.onError(g)}}var Vn=!1,fa=null,pa=!1,no=null,fp={onError:function(e){Vn=!0,fa=e}};function pp(e,t,r,n,s,a,o,c,l){Vn=!1,fa=null,hp.apply(fp,arguments)}function mp(e,t,r,n,s,a,o,c,l){if(pp.apply(this,arguments),Vn){if(Vn){var u=fa;Vn=!1,fa=null}else throw Error(P(198));pa||(pa=!0,no=u)}}function Ur(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function yd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function oc(e){if(Ur(e)!==e)throw Error(P(188))}function gp(e){var t=e.alternate;if(!t){if(t=Ur(e),t===null)throw Error(P(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return oc(s),e;if(a===n)return oc(s),t;a=a.sibling}throw Error(P(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,c=s.child;c;){if(c===r){o=!0,r=s,n=a;break}if(c===n){o=!0,n=s,r=a;break}c=c.sibling}if(!o){for(c=a.child;c;){if(c===r){o=!0,r=a,n=s;break}if(c===n){o=!0,n=a,r=s;break}c=c.sibling}if(!o)throw Error(P(189))}}if(r.alternate!==n)throw Error(P(190))}if(r.tag!==3)throw Error(P(188));return r.stateNode.current===r?e:t}function vd(e){return e=gp(e),e!==null?xd(e):null}function xd(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=xd(e);if(t!==null)return t;e=e.sibling}return null}var wd=ct.unstable_scheduleCallback,lc=ct.unstable_cancelCallback,yp=ct.unstable_shouldYield,vp=ct.unstable_requestPaint,be=ct.unstable_now,xp=ct.unstable_getCurrentPriorityLevel,ol=ct.unstable_ImmediatePriority,bd=ct.unstable_UserBlockingPriority,ma=ct.unstable_NormalPriority,wp=ct.unstable_LowPriority,kd=ct.unstable_IdlePriority,Ka=null,$t=null;function bp(e){if($t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(Ka,e,void 0,(e.current.flags&128)===128)}catch{}}var Pt=Math.clz32?Math.clz32:_p,kp=Math.log,Sp=Math.LN2;function _p(e){return e>>>=0,e===0?32:31-(kp(e)/Sp|0)|0}var Bs=64,$s=4194304;function Fn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ga(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var c=o&~s;c!==0?n=Fn(c):(a&=o,a!==0&&(n=Fn(a)))}else o=r&~s,o!==0?n=Fn(o):a!==0&&(n=Fn(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Pt(t),s=1<<r,n|=e[r],t&=~s;return n}function jp(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cp(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Pt(a),c=1<<o,l=s[o];l===-1?(!(c&r)||c&n)&&(s[o]=jp(c,t)):l<=t&&(e.expiredLanes|=c),a&=~c}}function so(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Sd(){var e=Bs;return Bs<<=1,!(Bs&4194240)&&(Bs=64),e}function ui(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ns(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pt(t),e[t]=r}function Np(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Pt(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function ll(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Pt(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var se=0;function _d(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var jd,cl,Cd,Nd,Rd,ao=!1,Ds=[],cr=null,ur=null,dr=null,is=new Map,os=new Map,sr=[],Rp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cc(e,t){switch(e){case"focusin":case"focusout":cr=null;break;case"dragenter":case"dragleave":ur=null;break;case"mouseover":case"mouseout":dr=null;break;case"pointerover":case"pointerout":is.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":os.delete(t.pointerId)}}function An(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=Es(t),t!==null&&cl(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Ep(e,t,r,n,s){switch(t){case"focusin":return cr=An(cr,e,t,r,n,s),!0;case"dragenter":return ur=An(ur,e,t,r,n,s),!0;case"mouseover":return dr=An(dr,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return is.set(a,An(is.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,os.set(a,An(os.get(a)||null,e,t,r,n,s)),!0}return!1}function Ed(e){var t=Tr(e.target);if(t!==null){var r=Ur(t);if(r!==null){if(t=r.tag,t===13){if(t=yd(r),t!==null){e.blockedOn=t,Rd(e.priority,function(){Cd(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ra(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=io(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);eo=n,r.target.dispatchEvent(n),eo=null}else return t=Es(r),t!==null&&cl(t),e.blockedOn=r,!1;t.shift()}return!0}function uc(e,t,r){ra(e)&&r.delete(t)}function Tp(){ao=!1,cr!==null&&ra(cr)&&(cr=null),ur!==null&&ra(ur)&&(ur=null),dr!==null&&ra(dr)&&(dr=null),is.forEach(uc),os.forEach(uc)}function In(e,t){e.blockedOn===t&&(e.blockedOn=null,ao||(ao=!0,ct.unstable_scheduleCallback(ct.unstable_NormalPriority,Tp)))}function ls(e){function t(s){return In(s,e)}if(0<Ds.length){In(Ds[0],e);for(var r=1;r<Ds.length;r++){var n=Ds[r];n.blockedOn===e&&(n.blockedOn=null)}}for(cr!==null&&In(cr,e),ur!==null&&In(ur,e),dr!==null&&In(dr,e),is.forEach(t),os.forEach(t),r=0;r<sr.length;r++)n=sr[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<sr.length&&(r=sr[0],r.blockedOn===null);)Ed(r),r.blockedOn===null&&sr.shift()}var xn=Jt.ReactCurrentBatchConfig,ya=!0;function Pp(e,t,r,n){var s=se,a=xn.transition;xn.transition=null;try{se=1,ul(e,t,r,n)}finally{se=s,xn.transition=a}}function Lp(e,t,r,n){var s=se,a=xn.transition;xn.transition=null;try{se=4,ul(e,t,r,n)}finally{se=s,xn.transition=a}}function ul(e,t,r,n){if(ya){var s=io(e,t,r,n);if(s===null)wi(e,t,n,va,r),cc(e,n);else if(Ep(s,e,t,r,n))n.stopPropagation();else if(cc(e,n),t&4&&-1<Rp.indexOf(e)){for(;s!==null;){var a=Es(s);if(a!==null&&jd(a),a=io(e,t,r,n),a===null&&wi(e,t,n,va,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else wi(e,t,n,null,r)}}var va=null;function io(e,t,r,n){if(va=null,e=il(n),e=Tr(e),e!==null)if(t=Ur(e),t===null)e=null;else if(r=t.tag,r===13){if(e=yd(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return va=e,null}function Td(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xp()){case ol:return 1;case bd:return 4;case ma:case wp:return 16;case kd:return 536870912;default:return 16}default:return 16}}var or=null,dl=null,na=null;function Pd(){if(na)return na;var e,t=dl,r=t.length,n,s="value"in or?or.value:or.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[a-n];n++);return na=s.slice(e,1<n?1-n:void 0)}function sa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Gs(){return!0}function dc(){return!1}function ht(e){function t(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(r=e[c],this[c]=r?r(a):a[c]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Gs:dc,this.isPropagationStopped=dc,this}return ye(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Gs)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Gs)},persist:function(){},isPersistent:Gs}),t}var Pn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hl=ht(Pn),Rs=ye({},Pn,{view:0,detail:0}),Op=ht(Rs),di,hi,Bn,Ua=ye({},Rs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bn&&(Bn&&e.type==="mousemove"?(di=e.screenX-Bn.screenX,hi=e.screenY-Bn.screenY):hi=di=0,Bn=e),di)},movementY:function(e){return"movementY"in e?e.movementY:hi}}),hc=ht(Ua),Mp=ye({},Ua,{dataTransfer:0}),Ap=ht(Mp),Ip=ye({},Rs,{relatedTarget:0}),fi=ht(Ip),Bp=ye({},Pn,{animationName:0,elapsedTime:0,pseudoElement:0}),$p=ht(Bp),Dp=ye({},Pn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Gp=ht(Dp),Kp=ye({},Pn,{data:0}),fc=ht(Kp),Up={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Wp[e])?!!t[e]:!1}function fl(){return zp}var Hp=ye({},Rs,{key:function(e){if(e.key){var t=Up[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=sa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Fp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fl,charCode:function(e){return e.type==="keypress"?sa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?sa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Vp=ht(Hp),qp=ye({},Ua,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pc=ht(qp),Yp=ye({},Rs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fl}),Qp=ht(Yp),Jp=ye({},Pn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xp=ht(Jp),Zp=ye({},Ua,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),em=ht(Zp),tm=[9,13,27,32],pl=Vt&&"CompositionEvent"in window,qn=null;Vt&&"documentMode"in document&&(qn=document.documentMode);var rm=Vt&&"TextEvent"in window&&!qn,Ld=Vt&&(!pl||qn&&8<qn&&11>=qn),mc=" ",gc=!1;function Od(e,t){switch(e){case"keyup":return tm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Md(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var nn=!1;function nm(e,t){switch(e){case"compositionend":return Md(t);case"keypress":return t.which!==32?null:(gc=!0,mc);case"textInput":return e=t.data,e===mc&&gc?null:e;default:return null}}function sm(e,t){if(nn)return e==="compositionend"||!pl&&Od(e,t)?(e=Pd(),na=dl=or=null,nn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ld&&t.locale!=="ko"?null:t.data;default:return null}}var am={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!am[e.type]:t==="textarea"}function Ad(e,t,r,n){hd(n),t=xa(t,"onChange"),0<t.length&&(r=new hl("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Yn=null,cs=null;function im(e){Hd(e,0)}function Fa(e){var t=on(e);if(ad(t))return e}function om(e,t){if(e==="change")return t}var Id=!1;if(Vt){var pi;if(Vt){var mi="oninput"in document;if(!mi){var vc=document.createElement("div");vc.setAttribute("oninput","return;"),mi=typeof vc.oninput=="function"}pi=mi}else pi=!1;Id=pi&&(!document.documentMode||9<document.documentMode)}function xc(){Yn&&(Yn.detachEvent("onpropertychange",Bd),cs=Yn=null)}function Bd(e){if(e.propertyName==="value"&&Fa(cs)){var t=[];Ad(t,cs,e,il(e)),gd(im,t)}}function lm(e,t,r){e==="focusin"?(xc(),Yn=t,cs=r,Yn.attachEvent("onpropertychange",Bd)):e==="focusout"&&xc()}function cm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Fa(cs)}function um(e,t){if(e==="click")return Fa(t)}function dm(e,t){if(e==="input"||e==="change")return Fa(t)}function hm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ot=typeof Object.is=="function"?Object.is:hm;function us(e,t){if(Ot(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Ui.call(t,s)||!Ot(e[s],t[s]))return!1}return!0}function wc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function bc(e,t){var r=wc(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=wc(r)}}function $d(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?$d(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Dd(){for(var e=window,t=ha();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ha(e.document)}return t}function ml(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function fm(e){var t=Dd(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&$d(r.ownerDocument.documentElement,r)){if(n!==null&&ml(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=bc(r,a);var o=bc(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pm=Vt&&"documentMode"in document&&11>=document.documentMode,sn=null,oo=null,Qn=null,lo=!1;function kc(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;lo||sn==null||sn!==ha(n)||(n=sn,"selectionStart"in n&&ml(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Qn&&us(Qn,n)||(Qn=n,n=xa(oo,"onSelect"),0<n.length&&(t=new hl("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=sn)))}function Ks(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var an={animationend:Ks("Animation","AnimationEnd"),animationiteration:Ks("Animation","AnimationIteration"),animationstart:Ks("Animation","AnimationStart"),transitionend:Ks("Transition","TransitionEnd")},gi={},Gd={};Vt&&(Gd=document.createElement("div").style,"AnimationEvent"in window||(delete an.animationend.animation,delete an.animationiteration.animation,delete an.animationstart.animation),"TransitionEvent"in window||delete an.transitionend.transition);function Wa(e){if(gi[e])return gi[e];if(!an[e])return e;var t=an[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Gd)return gi[e]=t[r];return e}var Kd=Wa("animationend"),Ud=Wa("animationiteration"),Fd=Wa("animationstart"),Wd=Wa("transitionend"),zd=new Map,Sc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xr(e,t){zd.set(e,t),Kr(t,[e])}for(var yi=0;yi<Sc.length;yi++){var vi=Sc[yi],mm=vi.toLowerCase(),gm=vi[0].toUpperCase()+vi.slice(1);xr(mm,"on"+gm)}xr(Kd,"onAnimationEnd");xr(Ud,"onAnimationIteration");xr(Fd,"onAnimationStart");xr("dblclick","onDoubleClick");xr("focusin","onFocus");xr("focusout","onBlur");xr(Wd,"onTransitionEnd");Sn("onMouseEnter",["mouseout","mouseover"]);Sn("onMouseLeave",["mouseout","mouseover"]);Sn("onPointerEnter",["pointerout","pointerover"]);Sn("onPointerLeave",["pointerout","pointerover"]);Kr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Kr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Kr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Kr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Kr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Kr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ym=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wn));function _c(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,mp(n,t,void 0,e),e.currentTarget=null}function Hd(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var c=n[o],l=c.instance,u=c.currentTarget;if(c=c.listener,l!==a&&s.isPropagationStopped())break e;_c(s,c,u),a=l}else for(o=0;o<n.length;o++){if(c=n[o],l=c.instance,u=c.currentTarget,c=c.listener,l!==a&&s.isPropagationStopped())break e;_c(s,c,u),a=l}}}if(pa)throw e=no,pa=!1,no=null,e}function de(e,t){var r=t[po];r===void 0&&(r=t[po]=new Set);var n=e+"__bubble";r.has(n)||(Vd(t,e,2,!1),r.add(n))}function xi(e,t,r){var n=0;t&&(n|=4),Vd(r,e,n,t)}var Us="_reactListening"+Math.random().toString(36).slice(2);function ds(e){if(!e[Us]){e[Us]=!0,ed.forEach(function(r){r!=="selectionchange"&&(ym.has(r)||xi(r,!1,e),xi(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Us]||(t[Us]=!0,xi("selectionchange",!1,t))}}function Vd(e,t,r,n){switch(Td(t)){case 1:var s=Pp;break;case 4:s=Lp;break;default:s=ul}r=s.bind(null,t,r,e),s=void 0,!ro||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function wi(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var c=n.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;c!==null;){if(o=Tr(c),o===null)return;if(l=o.tag,l===5||l===6){n=a=o;continue e}c=c.parentNode}}n=n.return}gd(function(){var u=a,g=il(r),m=[];e:{var h=zd.get(e);if(h!==void 0){var v=hl,y=e;switch(e){case"keypress":if(sa(r)===0)break e;case"keydown":case"keyup":v=Vp;break;case"focusin":y="focus",v=fi;break;case"focusout":y="blur",v=fi;break;case"beforeblur":case"afterblur":v=fi;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=hc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=Ap;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Qp;break;case Kd:case Ud:case Fd:v=$p;break;case Wd:v=Xp;break;case"scroll":v=Op;break;case"wheel":v=em;break;case"copy":case"cut":case"paste":v=Gp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=pc}var b=(t&4)!==0,x=!b&&e==="scroll",d=b?h!==null?h+"Capture":null:h;b=[];for(var p=u,f;p!==null;){f=p;var w=f.stateNode;if(f.tag===5&&w!==null&&(f=w,d!==null&&(w=as(p,d),w!=null&&b.push(hs(p,w,f)))),x)break;p=p.return}0<b.length&&(h=new v(h,y,null,r,g),m.push({event:h,listeners:b}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",h&&r!==eo&&(y=r.relatedTarget||r.fromElement)&&(Tr(y)||y[qt]))break e;if((v||h)&&(h=g.window===g?g:(h=g.ownerDocument)?h.defaultView||h.parentWindow:window,v?(y=r.relatedTarget||r.toElement,v=u,y=y?Tr(y):null,y!==null&&(x=Ur(y),y!==x||y.tag!==5&&y.tag!==6)&&(y=null)):(v=null,y=u),v!==y)){if(b=hc,w="onMouseLeave",d="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(b=pc,w="onPointerLeave",d="onPointerEnter",p="pointer"),x=v==null?h:on(v),f=y==null?h:on(y),h=new b(w,p+"leave",v,r,g),h.target=x,h.relatedTarget=f,w=null,Tr(g)===u&&(b=new b(d,p+"enter",y,r,g),b.target=f,b.relatedTarget=x,w=b),x=w,v&&y)t:{for(b=v,d=y,p=0,f=b;f;f=Wr(f))p++;for(f=0,w=d;w;w=Wr(w))f++;for(;0<p-f;)b=Wr(b),p--;for(;0<f-p;)d=Wr(d),f--;for(;p--;){if(b===d||d!==null&&b===d.alternate)break t;b=Wr(b),d=Wr(d)}b=null}else b=null;v!==null&&jc(m,h,v,b,!1),y!==null&&x!==null&&jc(m,x,y,b,!0)}}e:{if(h=u?on(u):window,v=h.nodeName&&h.nodeName.toLowerCase(),v==="select"||v==="input"&&h.type==="file")var j=om;else if(yc(h))if(Id)j=dm;else{j=cm;var _=lm}else(v=h.nodeName)&&v.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(j=um);if(j&&(j=j(e,u))){Ad(m,j,r,g);break e}_&&_(e,h,u),e==="focusout"&&(_=h._wrapperState)&&_.controlled&&h.type==="number"&&Yi(h,"number",h.value)}switch(_=u?on(u):window,e){case"focusin":(yc(_)||_.contentEditable==="true")&&(sn=_,oo=u,Qn=null);break;case"focusout":Qn=oo=sn=null;break;case"mousedown":lo=!0;break;case"contextmenu":case"mouseup":case"dragend":lo=!1,kc(m,r,g);break;case"selectionchange":if(pm)break;case"keydown":case"keyup":kc(m,r,g)}var k;if(pl)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else nn?Od(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(Ld&&r.locale!=="ko"&&(nn||S!=="onCompositionStart"?S==="onCompositionEnd"&&nn&&(k=Pd()):(or=g,dl="value"in or?or.value:or.textContent,nn=!0)),_=xa(u,S),0<_.length&&(S=new fc(S,e,null,r,g),m.push({event:S,listeners:_}),k?S.data=k:(k=Md(r),k!==null&&(S.data=k)))),(k=rm?nm(e,r):sm(e,r))&&(u=xa(u,"onBeforeInput"),0<u.length&&(g=new fc("onBeforeInput","beforeinput",null,r,g),m.push({event:g,listeners:u}),g.data=k))}Hd(m,t)})}function hs(e,t,r){return{instance:e,listener:t,currentTarget:r}}function xa(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=as(e,r),a!=null&&n.unshift(hs(e,a,s)),a=as(e,t),a!=null&&n.push(hs(e,a,s))),e=e.return}return n}function Wr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function jc(e,t,r,n,s){for(var a=t._reactName,o=[];r!==null&&r!==n;){var c=r,l=c.alternate,u=c.stateNode;if(l!==null&&l===n)break;c.tag===5&&u!==null&&(c=u,s?(l=as(r,a),l!=null&&o.unshift(hs(r,l,c))):s||(l=as(r,a),l!=null&&o.push(hs(r,l,c)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var vm=/\r\n?/g,xm=/\u0000|\uFFFD/g;function Cc(e){return(typeof e=="string"?e:""+e).replace(vm,`
`).replace(xm,"")}function Fs(e,t,r){if(t=Cc(t),Cc(e)!==t&&r)throw Error(P(425))}function wa(){}var co=null,uo=null;function ho(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var fo=typeof setTimeout=="function"?setTimeout:void 0,wm=typeof clearTimeout=="function"?clearTimeout:void 0,Nc=typeof Promise=="function"?Promise:void 0,bm=typeof queueMicrotask=="function"?queueMicrotask:typeof Nc<"u"?function(e){return Nc.resolve(null).then(e).catch(km)}:fo;function km(e){setTimeout(function(){throw e})}function bi(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),ls(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);ls(t)}function hr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Rc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ln=Math.random().toString(36).slice(2),Bt="__reactFiber$"+Ln,fs="__reactProps$"+Ln,qt="__reactContainer$"+Ln,po="__reactEvents$"+Ln,Sm="__reactListeners$"+Ln,_m="__reactHandles$"+Ln;function Tr(e){var t=e[Bt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[qt]||r[Bt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Rc(e);e!==null;){if(r=e[Bt])return r;e=Rc(e)}return t}e=r,r=e.parentNode}return null}function Es(e){return e=e[Bt]||e[qt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function on(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(P(33))}function za(e){return e[fs]||null}var mo=[],ln=-1;function wr(e){return{current:e}}function he(e){0>ln||(e.current=mo[ln],mo[ln]=null,ln--)}function ce(e,t){ln++,mo[ln]=e.current,e.current=t}var vr={},Ue=wr(vr),Je=wr(!1),Ir=vr;function _n(e,t){var r=e.type.contextTypes;if(!r)return vr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Xe(e){return e=e.childContextTypes,e!=null}function ba(){he(Je),he(Ue)}function Ec(e,t,r){if(Ue.current!==vr)throw Error(P(168));ce(Ue,t),ce(Je,r)}function qd(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(P(108,lp(e)||"Unknown",s));return ye({},r,n)}function ka(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||vr,Ir=Ue.current,ce(Ue,e),ce(Je,Je.current),!0}function Tc(e,t,r){var n=e.stateNode;if(!n)throw Error(P(169));r?(e=qd(e,t,Ir),n.__reactInternalMemoizedMergedChildContext=e,he(Je),he(Ue),ce(Ue,e)):he(Je),ce(Je,r)}var Ft=null,Ha=!1,ki=!1;function Yd(e){Ft===null?Ft=[e]:Ft.push(e)}function jm(e){Ha=!0,Yd(e)}function br(){if(!ki&&Ft!==null){ki=!0;var e=0,t=se;try{var r=Ft;for(se=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ft=null,Ha=!1}catch(s){throw Ft!==null&&(Ft=Ft.slice(e+1)),wd(ol,br),s}finally{se=t,ki=!1}}return null}var cn=[],un=0,Sa=null,_a=0,pt=[],mt=0,Br=null,Wt=1,zt="";function _r(e,t){cn[un++]=_a,cn[un++]=Sa,Sa=e,_a=t}function Qd(e,t,r){pt[mt++]=Wt,pt[mt++]=zt,pt[mt++]=Br,Br=e;var n=Wt;e=zt;var s=32-Pt(n)-1;n&=~(1<<s),r+=1;var a=32-Pt(t)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Wt=1<<32-Pt(t)+s|r<<s|n,zt=a+e}else Wt=1<<a|r<<s|n,zt=e}function gl(e){e.return!==null&&(_r(e,1),Qd(e,1,0))}function yl(e){for(;e===Sa;)Sa=cn[--un],cn[un]=null,_a=cn[--un],cn[un]=null;for(;e===Br;)Br=pt[--mt],pt[mt]=null,zt=pt[--mt],pt[mt]=null,Wt=pt[--mt],pt[mt]=null}var lt=null,ot=null,fe=!1,Tt=null;function Jd(e,t){var r=vt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Pc(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,lt=e,ot=hr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,lt=e,ot=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Br!==null?{id:Wt,overflow:zt}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=vt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,lt=e,ot=null,!0):!1;default:return!1}}function go(e){return(e.mode&1)!==0&&(e.flags&128)===0}function yo(e){if(fe){var t=ot;if(t){var r=t;if(!Pc(e,t)){if(go(e))throw Error(P(418));t=hr(r.nextSibling);var n=lt;t&&Pc(e,t)?Jd(n,r):(e.flags=e.flags&-4097|2,fe=!1,lt=e)}}else{if(go(e))throw Error(P(418));e.flags=e.flags&-4097|2,fe=!1,lt=e}}}function Lc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;lt=e}function Ws(e){if(e!==lt)return!1;if(!fe)return Lc(e),fe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ho(e.type,e.memoizedProps)),t&&(t=ot)){if(go(e))throw Xd(),Error(P(418));for(;t;)Jd(e,t),t=hr(t.nextSibling)}if(Lc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(P(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ot=hr(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ot=null}}else ot=lt?hr(e.stateNode.nextSibling):null;return!0}function Xd(){for(var e=ot;e;)e=hr(e.nextSibling)}function jn(){ot=lt=null,fe=!1}function vl(e){Tt===null?Tt=[e]:Tt.push(e)}var Cm=Jt.ReactCurrentBatchConfig;function $n(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(P(309));var n=r.stateNode}if(!n)throw Error(P(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var c=s.refs;o===null?delete c[a]:c[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(P(284));if(!r._owner)throw Error(P(290,e))}return e}function zs(e,t){throw e=Object.prototype.toString.call(t),Error(P(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Oc(e){var t=e._init;return t(e._payload)}function Zd(e){function t(d,p){if(e){var f=d.deletions;f===null?(d.deletions=[p],d.flags|=16):f.push(p)}}function r(d,p){if(!e)return null;for(;p!==null;)t(d,p),p=p.sibling;return null}function n(d,p){for(d=new Map;p!==null;)p.key!==null?d.set(p.key,p):d.set(p.index,p),p=p.sibling;return d}function s(d,p){return d=gr(d,p),d.index=0,d.sibling=null,d}function a(d,p,f){return d.index=f,e?(f=d.alternate,f!==null?(f=f.index,f<p?(d.flags|=2,p):f):(d.flags|=2,p)):(d.flags|=1048576,p)}function o(d){return e&&d.alternate===null&&(d.flags|=2),d}function c(d,p,f,w){return p===null||p.tag!==6?(p=Ei(f,d.mode,w),p.return=d,p):(p=s(p,f),p.return=d,p)}function l(d,p,f,w){var j=f.type;return j===rn?g(d,p,f.props.children,w,f.key):p!==null&&(p.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===tr&&Oc(j)===p.type)?(w=s(p,f.props),w.ref=$n(d,p,f),w.return=d,w):(w=da(f.type,f.key,f.props,null,d.mode,w),w.ref=$n(d,p,f),w.return=d,w)}function u(d,p,f,w){return p===null||p.tag!==4||p.stateNode.containerInfo!==f.containerInfo||p.stateNode.implementation!==f.implementation?(p=Ti(f,d.mode,w),p.return=d,p):(p=s(p,f.children||[]),p.return=d,p)}function g(d,p,f,w,j){return p===null||p.tag!==7?(p=Ar(f,d.mode,w,j),p.return=d,p):(p=s(p,f),p.return=d,p)}function m(d,p,f){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Ei(""+p,d.mode,f),p.return=d,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Ms:return f=da(p.type,p.key,p.props,null,d.mode,f),f.ref=$n(d,null,p),f.return=d,f;case tn:return p=Ti(p,d.mode,f),p.return=d,p;case tr:var w=p._init;return m(d,w(p._payload),f)}if(Un(p)||On(p))return p=Ar(p,d.mode,f,null),p.return=d,p;zs(d,p)}return null}function h(d,p,f,w){var j=p!==null?p.key:null;if(typeof f=="string"&&f!==""||typeof f=="number")return j!==null?null:c(d,p,""+f,w);if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Ms:return f.key===j?l(d,p,f,w):null;case tn:return f.key===j?u(d,p,f,w):null;case tr:return j=f._init,h(d,p,j(f._payload),w)}if(Un(f)||On(f))return j!==null?null:g(d,p,f,w,null);zs(d,f)}return null}function v(d,p,f,w,j){if(typeof w=="string"&&w!==""||typeof w=="number")return d=d.get(f)||null,c(p,d,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ms:return d=d.get(w.key===null?f:w.key)||null,l(p,d,w,j);case tn:return d=d.get(w.key===null?f:w.key)||null,u(p,d,w,j);case tr:var _=w._init;return v(d,p,f,_(w._payload),j)}if(Un(w)||On(w))return d=d.get(f)||null,g(p,d,w,j,null);zs(p,w)}return null}function y(d,p,f,w){for(var j=null,_=null,k=p,S=p=0,C=null;k!==null&&S<f.length;S++){k.index>S?(C=k,k=null):C=k.sibling;var R=h(d,k,f[S],w);if(R===null){k===null&&(k=C);break}e&&k&&R.alternate===null&&t(d,k),p=a(R,p,S),_===null?j=R:_.sibling=R,_=R,k=C}if(S===f.length)return r(d,k),fe&&_r(d,S),j;if(k===null){for(;S<f.length;S++)k=m(d,f[S],w),k!==null&&(p=a(k,p,S),_===null?j=k:_.sibling=k,_=k);return fe&&_r(d,S),j}for(k=n(d,k);S<f.length;S++)C=v(k,d,S,f[S],w),C!==null&&(e&&C.alternate!==null&&k.delete(C.key===null?S:C.key),p=a(C,p,S),_===null?j=C:_.sibling=C,_=C);return e&&k.forEach(function(M){return t(d,M)}),fe&&_r(d,S),j}function b(d,p,f,w){var j=On(f);if(typeof j!="function")throw Error(P(150));if(f=j.call(f),f==null)throw Error(P(151));for(var _=j=null,k=p,S=p=0,C=null,R=f.next();k!==null&&!R.done;S++,R=f.next()){k.index>S?(C=k,k=null):C=k.sibling;var M=h(d,k,R.value,w);if(M===null){k===null&&(k=C);break}e&&k&&M.alternate===null&&t(d,k),p=a(M,p,S),_===null?j=M:_.sibling=M,_=M,k=C}if(R.done)return r(d,k),fe&&_r(d,S),j;if(k===null){for(;!R.done;S++,R=f.next())R=m(d,R.value,w),R!==null&&(p=a(R,p,S),_===null?j=R:_.sibling=R,_=R);return fe&&_r(d,S),j}for(k=n(d,k);!R.done;S++,R=f.next())R=v(k,d,S,R.value,w),R!==null&&(e&&R.alternate!==null&&k.delete(R.key===null?S:R.key),p=a(R,p,S),_===null?j=R:_.sibling=R,_=R);return e&&k.forEach(function(I){return t(d,I)}),fe&&_r(d,S),j}function x(d,p,f,w){if(typeof f=="object"&&f!==null&&f.type===rn&&f.key===null&&(f=f.props.children),typeof f=="object"&&f!==null){switch(f.$$typeof){case Ms:e:{for(var j=f.key,_=p;_!==null;){if(_.key===j){if(j=f.type,j===rn){if(_.tag===7){r(d,_.sibling),p=s(_,f.props.children),p.return=d,d=p;break e}}else if(_.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===tr&&Oc(j)===_.type){r(d,_.sibling),p=s(_,f.props),p.ref=$n(d,_,f),p.return=d,d=p;break e}r(d,_);break}else t(d,_);_=_.sibling}f.type===rn?(p=Ar(f.props.children,d.mode,w,f.key),p.return=d,d=p):(w=da(f.type,f.key,f.props,null,d.mode,w),w.ref=$n(d,p,f),w.return=d,d=w)}return o(d);case tn:e:{for(_=f.key;p!==null;){if(p.key===_)if(p.tag===4&&p.stateNode.containerInfo===f.containerInfo&&p.stateNode.implementation===f.implementation){r(d,p.sibling),p=s(p,f.children||[]),p.return=d,d=p;break e}else{r(d,p);break}else t(d,p);p=p.sibling}p=Ti(f,d.mode,w),p.return=d,d=p}return o(d);case tr:return _=f._init,x(d,p,_(f._payload),w)}if(Un(f))return y(d,p,f,w);if(On(f))return b(d,p,f,w);zs(d,f)}return typeof f=="string"&&f!==""||typeof f=="number"?(f=""+f,p!==null&&p.tag===6?(r(d,p.sibling),p=s(p,f),p.return=d,d=p):(r(d,p),p=Ei(f,d.mode,w),p.return=d,d=p),o(d)):r(d,p)}return x}var Cn=Zd(!0),eh=Zd(!1),ja=wr(null),Ca=null,dn=null,xl=null;function wl(){xl=dn=Ca=null}function bl(e){var t=ja.current;he(ja),e._currentValue=t}function vo(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function wn(e,t){Ca=e,xl=dn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Qe=!0),e.firstContext=null)}function wt(e){var t=e._currentValue;if(xl!==e)if(e={context:e,memoizedValue:t,next:null},dn===null){if(Ca===null)throw Error(P(308));dn=e,Ca.dependencies={lanes:0,firstContext:e}}else dn=dn.next=e;return t}var Pr=null;function kl(e){Pr===null?Pr=[e]:Pr.push(e)}function th(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,kl(t)):(r.next=s.next,s.next=r),t.interleaved=r,Yt(e,n)}function Yt(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var rr=!1;function Sl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rh(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ht(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fr(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,te&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Yt(e,r)}return s=n.interleaved,s===null?(t.next=t,kl(n)):(t.next=s.next,s.next=t),n.interleaved=t,Yt(e,r)}function aa(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ll(e,r)}}function Mc(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Na(e,t,r,n){var s=e.updateQueue;rr=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var l=c,u=l.next;l.next=null,o===null?a=u:o.next=u,o=l;var g=e.alternate;g!==null&&(g=g.updateQueue,c=g.lastBaseUpdate,c!==o&&(c===null?g.firstBaseUpdate=u:c.next=u,g.lastBaseUpdate=l))}if(a!==null){var m=s.baseState;o=0,g=u=l=null,c=a;do{var h=c.lane,v=c.eventTime;if((n&h)===h){g!==null&&(g=g.next={eventTime:v,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var y=e,b=c;switch(h=t,v=r,b.tag){case 1:if(y=b.payload,typeof y=="function"){m=y.call(v,m,h);break e}m=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=b.payload,h=typeof y=="function"?y.call(v,m,h):y,h==null)break e;m=ye({},m,h);break e;case 2:rr=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[c]:h.push(c))}else v={eventTime:v,lane:h,tag:c.tag,payload:c.payload,callback:c.callback,next:null},g===null?(u=g=v,l=m):g=g.next=v,o|=h;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;h=c,c=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(g===null&&(l=m),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=g,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Dr|=o,e.lanes=o,e.memoizedState=m}}function Ac(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(P(191,s));s.call(n)}}}var Ts={},Dt=wr(Ts),ps=wr(Ts),ms=wr(Ts);function Lr(e){if(e===Ts)throw Error(P(174));return e}function _l(e,t){switch(ce(ms,t),ce(ps,e),ce(Dt,Ts),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ji(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ji(t,e)}he(Dt),ce(Dt,t)}function Nn(){he(Dt),he(ps),he(ms)}function nh(e){Lr(ms.current);var t=Lr(Dt.current),r=Ji(t,e.type);t!==r&&(ce(ps,e),ce(Dt,r))}function jl(e){ps.current===e&&(he(Dt),he(ps))}var me=wr(0);function Ra(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Si=[];function Cl(){for(var e=0;e<Si.length;e++)Si[e]._workInProgressVersionPrimary=null;Si.length=0}var ia=Jt.ReactCurrentDispatcher,_i=Jt.ReactCurrentBatchConfig,$r=0,ge=null,Ce=null,Re=null,Ea=!1,Jn=!1,gs=0,Nm=0;function De(){throw Error(P(321))}function Nl(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ot(e[r],t[r]))return!1;return!0}function Rl(e,t,r,n,s,a){if($r=a,ge=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=e===null||e.memoizedState===null?Pm:Lm,e=r(n,s),Jn){a=0;do{if(Jn=!1,gs=0,25<=a)throw Error(P(301));a+=1,Re=Ce=null,t.updateQueue=null,ia.current=Om,e=r(n,s)}while(Jn)}if(ia.current=Ta,t=Ce!==null&&Ce.next!==null,$r=0,Re=Ce=ge=null,Ea=!1,t)throw Error(P(300));return e}function El(){var e=gs!==0;return gs=0,e}function It(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Re===null?ge.memoizedState=Re=e:Re=Re.next=e,Re}function bt(){if(Ce===null){var e=ge.alternate;e=e!==null?e.memoizedState:null}else e=Ce.next;var t=Re===null?ge.memoizedState:Re.next;if(t!==null)Re=t,Ce=e;else{if(e===null)throw Error(P(310));Ce=e,e={memoizedState:Ce.memoizedState,baseState:Ce.baseState,baseQueue:Ce.baseQueue,queue:Ce.queue,next:null},Re===null?ge.memoizedState=Re=e:Re=Re.next=e}return Re}function ys(e,t){return typeof t=="function"?t(e):t}function ji(e){var t=bt(),r=t.queue;if(r===null)throw Error(P(311));r.lastRenderedReducer=e;var n=Ce,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var c=o=null,l=null,u=a;do{var g=u.lane;if(($r&g)===g)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var m={lane:g,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(c=l=m,o=n):l=l.next=m,ge.lanes|=g,Dr|=g}u=u.next}while(u!==null&&u!==a);l===null?o=n:l.next=c,Ot(n,t.memoizedState)||(Qe=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,ge.lanes|=a,Dr|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ci(e){var t=bt(),r=t.queue;if(r===null)throw Error(P(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=e(a,o.action),o=o.next;while(o!==s);Ot(a,t.memoizedState)||(Qe=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function sh(){}function ah(e,t){var r=ge,n=bt(),s=t(),a=!Ot(n.memoizedState,s);if(a&&(n.memoizedState=s,Qe=!0),n=n.queue,Tl(lh.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Re!==null&&Re.memoizedState.tag&1){if(r.flags|=2048,vs(9,oh.bind(null,r,n,s,t),void 0,null),Ee===null)throw Error(P(349));$r&30||ih(r,t,s)}return s}function ih(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ge.updateQueue,t===null?(t={lastEffect:null,stores:null},ge.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function oh(e,t,r,n){t.value=r,t.getSnapshot=n,ch(t)&&uh(e)}function lh(e,t,r){return r(function(){ch(t)&&uh(e)})}function ch(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ot(e,r)}catch{return!0}}function uh(e){var t=Yt(e,1);t!==null&&Lt(t,e,1,-1)}function Ic(e){var t=It();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:e},t.queue=e,e=e.dispatch=Tm.bind(null,ge,e),[t.memoizedState,e]}function vs(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ge.updateQueue,t===null?(t={lastEffect:null,stores:null},ge.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function dh(){return bt().memoizedState}function oa(e,t,r,n){var s=It();ge.flags|=e,s.memoizedState=vs(1|t,r,void 0,n===void 0?null:n)}function Va(e,t,r,n){var s=bt();n=n===void 0?null:n;var a=void 0;if(Ce!==null){var o=Ce.memoizedState;if(a=o.destroy,n!==null&&Nl(n,o.deps)){s.memoizedState=vs(t,r,a,n);return}}ge.flags|=e,s.memoizedState=vs(1|t,r,a,n)}function Bc(e,t){return oa(8390656,8,e,t)}function Tl(e,t){return Va(2048,8,e,t)}function hh(e,t){return Va(4,2,e,t)}function fh(e,t){return Va(4,4,e,t)}function ph(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function mh(e,t,r){return r=r!=null?r.concat([e]):null,Va(4,4,ph.bind(null,t,e),r)}function Pl(){}function gh(e,t){var r=bt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Nl(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function yh(e,t){var r=bt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Nl(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function vh(e,t,r){return $r&21?(Ot(r,t)||(r=Sd(),ge.lanes|=r,Dr|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Qe=!0),e.memoizedState=r)}function Rm(e,t){var r=se;se=r!==0&&4>r?r:4,e(!0);var n=_i.transition;_i.transition={};try{e(!1),t()}finally{se=r,_i.transition=n}}function xh(){return bt().memoizedState}function Em(e,t,r){var n=mr(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},wh(e))bh(t,r);else if(r=th(e,t,r,n),r!==null){var s=He();Lt(r,e,n,s),kh(r,t,n)}}function Tm(e,t,r){var n=mr(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(wh(e))bh(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,c=a(o,r);if(s.hasEagerState=!0,s.eagerState=c,Ot(c,o)){var l=t.interleaved;l===null?(s.next=s,kl(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=th(e,t,s,n),r!==null&&(s=He(),Lt(r,e,n,s),kh(r,t,n))}}function wh(e){var t=e.alternate;return e===ge||t!==null&&t===ge}function bh(e,t){Jn=Ea=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function kh(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ll(e,r)}}var Ta={readContext:wt,useCallback:De,useContext:De,useEffect:De,useImperativeHandle:De,useInsertionEffect:De,useLayoutEffect:De,useMemo:De,useReducer:De,useRef:De,useState:De,useDebugValue:De,useDeferredValue:De,useTransition:De,useMutableSource:De,useSyncExternalStore:De,useId:De,unstable_isNewReconciler:!1},Pm={readContext:wt,useCallback:function(e,t){return It().memoizedState=[e,t===void 0?null:t],e},useContext:wt,useEffect:Bc,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,oa(4194308,4,ph.bind(null,t,e),r)},useLayoutEffect:function(e,t){return oa(4194308,4,e,t)},useInsertionEffect:function(e,t){return oa(4,2,e,t)},useMemo:function(e,t){var r=It();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=It();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Em.bind(null,ge,e),[n.memoizedState,e]},useRef:function(e){var t=It();return e={current:e},t.memoizedState=e},useState:Ic,useDebugValue:Pl,useDeferredValue:function(e){return It().memoizedState=e},useTransition:function(){var e=Ic(!1),t=e[0];return e=Rm.bind(null,e[1]),It().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ge,s=It();if(fe){if(r===void 0)throw Error(P(407));r=r()}else{if(r=t(),Ee===null)throw Error(P(349));$r&30||ih(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,Bc(lh.bind(null,n,a,e),[e]),n.flags|=2048,vs(9,oh.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=It(),t=Ee.identifierPrefix;if(fe){var r=zt,n=Wt;r=(n&~(1<<32-Pt(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=gs++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Nm++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Lm={readContext:wt,useCallback:gh,useContext:wt,useEffect:Tl,useImperativeHandle:mh,useInsertionEffect:hh,useLayoutEffect:fh,useMemo:yh,useReducer:ji,useRef:dh,useState:function(){return ji(ys)},useDebugValue:Pl,useDeferredValue:function(e){var t=bt();return vh(t,Ce.memoizedState,e)},useTransition:function(){var e=ji(ys)[0],t=bt().memoizedState;return[e,t]},useMutableSource:sh,useSyncExternalStore:ah,useId:xh,unstable_isNewReconciler:!1},Om={readContext:wt,useCallback:gh,useContext:wt,useEffect:Tl,useImperativeHandle:mh,useInsertionEffect:hh,useLayoutEffect:fh,useMemo:yh,useReducer:Ci,useRef:dh,useState:function(){return Ci(ys)},useDebugValue:Pl,useDeferredValue:function(e){var t=bt();return Ce===null?t.memoizedState=e:vh(t,Ce.memoizedState,e)},useTransition:function(){var e=Ci(ys)[0],t=bt().memoizedState;return[e,t]},useMutableSource:sh,useSyncExternalStore:ah,useId:xh,unstable_isNewReconciler:!1};function Ct(e,t){if(e&&e.defaultProps){t=ye({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function xo(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ye({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var qa={isMounted:function(e){return(e=e._reactInternals)?Ur(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=He(),s=mr(e),a=Ht(n,s);a.payload=t,r!=null&&(a.callback=r),t=fr(e,a,s),t!==null&&(Lt(t,e,s,n),aa(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=He(),s=mr(e),a=Ht(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=fr(e,a,s),t!==null&&(Lt(t,e,s,n),aa(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=He(),n=mr(e),s=Ht(r,n);s.tag=2,t!=null&&(s.callback=t),t=fr(e,s,n),t!==null&&(Lt(t,e,n,r),aa(t,e,n))}};function $c(e,t,r,n,s,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!us(r,n)||!us(s,a):!0}function Sh(e,t,r){var n=!1,s=vr,a=t.contextType;return typeof a=="object"&&a!==null?a=wt(a):(s=Xe(t)?Ir:Ue.current,n=t.contextTypes,a=(n=n!=null)?_n(e,s):vr),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=qa,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function Dc(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&qa.enqueueReplaceState(t,t.state,null)}function wo(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Sl(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=wt(a):(a=Xe(t)?Ir:Ue.current,s.context=_n(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(xo(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&qa.enqueueReplaceState(s,s.state,null),Na(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Rn(e,t){try{var r="",n=t;do r+=op(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function Ni(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function bo(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Mm=typeof WeakMap=="function"?WeakMap:Map;function _h(e,t,r){r=Ht(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){La||(La=!0,Po=n),bo(e,t)},r}function jh(e,t,r){r=Ht(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){bo(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){bo(e,t),typeof n!="function"&&(pr===null?pr=new Set([this]):pr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function Gc(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Mm;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=qm.bind(null,e,t,r),t.then(e,e))}function Kc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Uc(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ht(-1,1),t.tag=2,fr(r,t,1))),r.lanes|=1),e)}var Am=Jt.ReactCurrentOwner,Qe=!1;function ze(e,t,r,n){t.child=e===null?eh(t,null,r,n):Cn(t,e.child,r,n)}function Fc(e,t,r,n,s){r=r.render;var a=t.ref;return wn(t,s),n=Rl(e,t,r,n,a,s),r=El(),e!==null&&!Qe?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Qt(e,t,s)):(fe&&r&&gl(t),t.flags|=1,ze(e,t,n,s),t.child)}function Wc(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Dl(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,Ch(e,t,a,n,s)):(e=da(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:us,r(o,n)&&e.ref===t.ref)return Qt(e,t,s)}return t.flags|=1,e=gr(a,n),e.ref=t.ref,e.return=t,t.child=e}function Ch(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(us(a,n)&&e.ref===t.ref)if(Qe=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(Qe=!0);else return t.lanes=e.lanes,Qt(e,t,s)}return ko(e,t,r,n,s)}function Nh(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ce(fn,st),st|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ce(fn,st),st|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,ce(fn,st),st|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,ce(fn,st),st|=n;return ze(e,t,s,r),t.child}function Rh(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ko(e,t,r,n,s){var a=Xe(r)?Ir:Ue.current;return a=_n(t,a),wn(t,s),r=Rl(e,t,r,n,a,s),n=El(),e!==null&&!Qe?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Qt(e,t,s)):(fe&&n&&gl(t),t.flags|=1,ze(e,t,r,s),t.child)}function zc(e,t,r,n,s){if(Xe(r)){var a=!0;ka(t)}else a=!1;if(wn(t,s),t.stateNode===null)la(e,t),Sh(t,r,n),wo(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,c=t.memoizedProps;o.props=c;var l=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=wt(u):(u=Xe(r)?Ir:Ue.current,u=_n(t,u));var g=r.getDerivedStateFromProps,m=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==n||l!==u)&&Dc(t,o,n,u),rr=!1;var h=t.memoizedState;o.state=h,Na(t,n,o,s),l=t.memoizedState,c!==n||h!==l||Je.current||rr?(typeof g=="function"&&(xo(t,r,g,n),l=t.memoizedState),(c=rr||$c(t,r,c,n,h,l,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=u,n=c):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,rh(e,t),c=t.memoizedProps,u=t.type===t.elementType?c:Ct(t.type,c),o.props=u,m=t.pendingProps,h=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=wt(l):(l=Xe(r)?Ir:Ue.current,l=_n(t,l));var v=r.getDerivedStateFromProps;(g=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==m||h!==l)&&Dc(t,o,n,l),rr=!1,h=t.memoizedState,o.state=h,Na(t,n,o,s);var y=t.memoizedState;c!==m||h!==y||Je.current||rr?(typeof v=="function"&&(xo(t,r,v,n),y=t.memoizedState),(u=rr||$c(t,r,u,n,h,y,l)||!1)?(g||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),o.props=n,o.state=y,o.context=l,n=u):(typeof o.componentDidUpdate!="function"||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return So(e,t,r,n,a,s)}function So(e,t,r,n,s,a){Rh(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&Tc(t,r,!1),Qt(e,t,a);n=t.stateNode,Am.current=t;var c=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Cn(t,e.child,null,a),t.child=Cn(t,null,c,a)):ze(e,t,c,a),t.memoizedState=n.state,s&&Tc(t,r,!0),t.child}function Eh(e){var t=e.stateNode;t.pendingContext?Ec(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Ec(e,t.context,!1),_l(e,t.containerInfo)}function Hc(e,t,r,n,s){return jn(),vl(s),t.flags|=256,ze(e,t,r,n),t.child}var _o={dehydrated:null,treeContext:null,retryLane:0};function jo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Th(e,t,r){var n=t.pendingProps,s=me.current,a=!1,o=(t.flags&128)!==0,c;if((c=o)||(c=e!==null&&e.memoizedState===null?!1:(s&2)!==0),c?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ce(me,s&1),e===null)return yo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Ja(o,n,0,null),e=Ar(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=jo(r),t.memoizedState=_o,e):Ll(t,o));if(s=e.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return Im(e,t,o,n,c,s,r);if(a){a=n.fallback,o=t.mode,s=e.child,c=s.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=gr(s,l),n.subtreeFlags=s.subtreeFlags&14680064),c!==null?a=gr(c,a):(a=Ar(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?jo(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=_o,n}return a=e.child,e=a.sibling,n=gr(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ll(e,t){return t=Ja({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Hs(e,t,r,n){return n!==null&&vl(n),Cn(t,e.child,null,r),e=Ll(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Im(e,t,r,n,s,a,o){if(r)return t.flags&256?(t.flags&=-257,n=Ni(Error(P(422))),Hs(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Ja({mode:"visible",children:n.children},s,0,null),a=Ar(a,s,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Cn(t,e.child,null,o),t.child.memoizedState=jo(o),t.memoizedState=_o,a);if(!(t.mode&1))return Hs(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var c=n.dgst;return n=c,a=Error(P(419)),n=Ni(a,n,void 0),Hs(e,t,o,n)}if(c=(o&e.childLanes)!==0,Qe||c){if(n=Ee,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Yt(e,s),Lt(n,e,s,-1))}return $l(),n=Ni(Error(P(421))),Hs(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Ym.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,ot=hr(s.nextSibling),lt=t,fe=!0,Tt=null,e!==null&&(pt[mt++]=Wt,pt[mt++]=zt,pt[mt++]=Br,Wt=e.id,zt=e.overflow,Br=t),t=Ll(t,n.children),t.flags|=4096,t)}function Vc(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),vo(e.return,t,r)}function Ri(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function Ph(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(ze(e,t,n.children,r),n=me.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Vc(e,r,t);else if(e.tag===19)Vc(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ce(me,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Ra(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Ri(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ra(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Ri(t,!0,r,null,a);break;case"together":Ri(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function la(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qt(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Dr|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(P(153));if(t.child!==null){for(e=t.child,r=gr(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=gr(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Bm(e,t,r){switch(t.tag){case 3:Eh(t),jn();break;case 5:nh(t);break;case 1:Xe(t.type)&&ka(t);break;case 4:_l(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;ce(ja,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ce(me,me.current&1),t.flags|=128,null):r&t.child.childLanes?Th(e,t,r):(ce(me,me.current&1),e=Qt(e,t,r),e!==null?e.sibling:null);ce(me,me.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Ph(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ce(me,me.current),n)break;return null;case 22:case 23:return t.lanes=0,Nh(e,t,r)}return Qt(e,t,r)}var Lh,Co,Oh,Mh;Lh=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Co=function(){};Oh=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Lr(Dt.current);var a=null;switch(r){case"input":s=Vi(e,s),n=Vi(e,n),a=[];break;case"select":s=ye({},s,{value:void 0}),n=ye({},n,{value:void 0}),a=[];break;case"textarea":s=Qi(e,s),n=Qi(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=wa)}Xi(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var c=s[u];for(o in c)c.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ns.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var l=n[u];if(c=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&l!==c&&(l!=null||c!=null))if(u==="style")if(c){for(o in c)!c.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&c[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(a||(a=[]),a.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,c=c?c.__html:void 0,l!=null&&c!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ns.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&de("scroll",e),a||c===l||(a=[])):(a=a||[]).push(u,l))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};Mh=function(e,t,r,n){r!==n&&(t.flags|=4)};function Dn(e,t){if(!fe)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ge(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function $m(e,t,r){var n=t.pendingProps;switch(yl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ge(t),null;case 1:return Xe(t.type)&&ba(),Ge(t),null;case 3:return n=t.stateNode,Nn(),he(Je),he(Ue),Cl(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ws(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Tt!==null&&(Mo(Tt),Tt=null))),Co(e,t),Ge(t),null;case 5:jl(t);var s=Lr(ms.current);if(r=t.type,e!==null&&t.stateNode!=null)Oh(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(P(166));return Ge(t),null}if(e=Lr(Dt.current),Ws(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Bt]=t,n[fs]=a,e=(t.mode&1)!==0,r){case"dialog":de("cancel",n),de("close",n);break;case"iframe":case"object":case"embed":de("load",n);break;case"video":case"audio":for(s=0;s<Wn.length;s++)de(Wn[s],n);break;case"source":de("error",n);break;case"img":case"image":case"link":de("error",n),de("load",n);break;case"details":de("toggle",n);break;case"input":rc(n,a),de("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},de("invalid",n);break;case"textarea":sc(n,a),de("invalid",n)}Xi(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="children"?typeof c=="string"?n.textContent!==c&&(a.suppressHydrationWarning!==!0&&Fs(n.textContent,c,e),s=["children",c]):typeof c=="number"&&n.textContent!==""+c&&(a.suppressHydrationWarning!==!0&&Fs(n.textContent,c,e),s=["children",""+c]):ns.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&de("scroll",n)}switch(r){case"input":As(n),nc(n,a,!0);break;case"textarea":As(n),ac(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=wa)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ld(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Bt]=t,e[fs]=n,Lh(e,t,!1,!1),t.stateNode=e;e:{switch(o=Zi(r,n),r){case"dialog":de("cancel",e),de("close",e),s=n;break;case"iframe":case"object":case"embed":de("load",e),s=n;break;case"video":case"audio":for(s=0;s<Wn.length;s++)de(Wn[s],e);s=n;break;case"source":de("error",e),s=n;break;case"img":case"image":case"link":de("error",e),de("load",e),s=n;break;case"details":de("toggle",e),s=n;break;case"input":rc(e,n),s=Vi(e,n),de("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=ye({},n,{value:void 0}),de("invalid",e);break;case"textarea":sc(e,n),s=Qi(e,n),de("invalid",e);break;default:s=n}Xi(r,s),c=s;for(a in c)if(c.hasOwnProperty(a)){var l=c[a];a==="style"?dd(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&cd(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ss(e,l):typeof l=="number"&&ss(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(ns.hasOwnProperty(a)?l!=null&&a==="onScroll"&&de("scroll",e):l!=null&&rl(e,a,l,o))}switch(r){case"input":As(e),nc(e,n,!1);break;case"textarea":As(e),ac(e);break;case"option":n.value!=null&&e.setAttribute("value",""+yr(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?gn(e,!!n.multiple,a,!1):n.defaultValue!=null&&gn(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=wa)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ge(t),null;case 6:if(e&&t.stateNode!=null)Mh(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(P(166));if(r=Lr(ms.current),Lr(Dt.current),Ws(t)){if(n=t.stateNode,r=t.memoizedProps,n[Bt]=t,(a=n.nodeValue!==r)&&(e=lt,e!==null))switch(e.tag){case 3:Fs(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Fs(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Bt]=t,t.stateNode=n}return Ge(t),null;case 13:if(he(me),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(fe&&ot!==null&&t.mode&1&&!(t.flags&128))Xd(),jn(),t.flags|=98560,a=!1;else if(a=Ws(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(P(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(P(317));a[Bt]=t}else jn(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ge(t),a=!1}else Tt!==null&&(Mo(Tt),Tt=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||me.current&1?Ne===0&&(Ne=3):$l())),t.updateQueue!==null&&(t.flags|=4),Ge(t),null);case 4:return Nn(),Co(e,t),e===null&&ds(t.stateNode.containerInfo),Ge(t),null;case 10:return bl(t.type._context),Ge(t),null;case 17:return Xe(t.type)&&ba(),Ge(t),null;case 19:if(he(me),a=t.memoizedState,a===null)return Ge(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)Dn(a,!1);else{if(Ne!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ra(e),o!==null){for(t.flags|=128,Dn(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ce(me,me.current&1|2),t.child}e=e.sibling}a.tail!==null&&be()>En&&(t.flags|=128,n=!0,Dn(a,!1),t.lanes=4194304)}else{if(!n)if(e=Ra(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Dn(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!fe)return Ge(t),null}else 2*be()-a.renderingStartTime>En&&r!==1073741824&&(t.flags|=128,n=!0,Dn(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=be(),t.sibling=null,r=me.current,ce(me,n?r&1|2:r&1),t):(Ge(t),null);case 22:case 23:return Bl(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?st&1073741824&&(Ge(t),t.subtreeFlags&6&&(t.flags|=8192)):Ge(t),null;case 24:return null;case 25:return null}throw Error(P(156,t.tag))}function Dm(e,t){switch(yl(t),t.tag){case 1:return Xe(t.type)&&ba(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Nn(),he(Je),he(Ue),Cl(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return jl(t),null;case 13:if(he(me),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(P(340));jn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return he(me),null;case 4:return Nn(),null;case 10:return bl(t.type._context),null;case 22:case 23:return Bl(),null;case 24:return null;default:return null}}var Vs=!1,Ke=!1,Gm=typeof WeakSet=="function"?WeakSet:Set,B=null;function hn(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){we(e,t,n)}else r.current=null}function No(e,t,r){try{r()}catch(n){we(e,t,n)}}var qc=!1;function Km(e,t){if(co=ya,e=Dd(),ml(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,c=-1,l=-1,u=0,g=0,m=e,h=null;t:for(;;){for(var v;m!==r||s!==0&&m.nodeType!==3||(c=o+s),m!==a||n!==0&&m.nodeType!==3||(l=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)h=m,m=v;for(;;){if(m===e)break t;if(h===r&&++u===s&&(c=o),h===a&&++g===n&&(l=o),(v=m.nextSibling)!==null)break;m=h,h=m.parentNode}m=v}r=c===-1||l===-1?null:{start:c,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(uo={focusedElem:e,selectionRange:r},ya=!1,B=t;B!==null;)if(t=B,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,B=e;else for(;B!==null;){t=B;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var b=y.memoizedProps,x=y.memoizedState,d=t.stateNode,p=d.getSnapshotBeforeUpdate(t.elementType===t.type?b:Ct(t.type,b),x);d.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var f=t.stateNode.containerInfo;f.nodeType===1?f.textContent="":f.nodeType===9&&f.documentElement&&f.removeChild(f.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(P(163))}}catch(w){we(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,B=e;break}B=t.return}return y=qc,qc=!1,y}function Xn(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&No(t,r,a)}s=s.next}while(s!==n)}}function Ya(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Ro(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Ah(e){var t=e.alternate;t!==null&&(e.alternate=null,Ah(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Bt],delete t[fs],delete t[po],delete t[Sm],delete t[_m])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ih(e){return e.tag===5||e.tag===3||e.tag===4}function Yc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ih(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Eo(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=wa));else if(n!==4&&(e=e.child,e!==null))for(Eo(e,t,r),e=e.sibling;e!==null;)Eo(e,t,r),e=e.sibling}function To(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(To(e,t,r),e=e.sibling;e!==null;)To(e,t,r),e=e.sibling}var Ae=null,Rt=!1;function Zt(e,t,r){for(r=r.child;r!==null;)Bh(e,t,r),r=r.sibling}function Bh(e,t,r){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(Ka,r)}catch{}switch(r.tag){case 5:Ke||hn(r,t);case 6:var n=Ae,s=Rt;Ae=null,Zt(e,t,r),Ae=n,Rt=s,Ae!==null&&(Rt?(e=Ae,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ae.removeChild(r.stateNode));break;case 18:Ae!==null&&(Rt?(e=Ae,r=r.stateNode,e.nodeType===8?bi(e.parentNode,r):e.nodeType===1&&bi(e,r),ls(e)):bi(Ae,r.stateNode));break;case 4:n=Ae,s=Rt,Ae=r.stateNode.containerInfo,Rt=!0,Zt(e,t,r),Ae=n,Rt=s;break;case 0:case 11:case 14:case 15:if(!Ke&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&No(r,t,o),s=s.next}while(s!==n)}Zt(e,t,r);break;case 1:if(!Ke&&(hn(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(c){we(r,t,c)}Zt(e,t,r);break;case 21:Zt(e,t,r);break;case 22:r.mode&1?(Ke=(n=Ke)||r.memoizedState!==null,Zt(e,t,r),Ke=n):Zt(e,t,r);break;default:Zt(e,t,r)}}function Qc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Gm),t.forEach(function(n){var s=Qm.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function _t(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,o=t,c=o;e:for(;c!==null;){switch(c.tag){case 5:Ae=c.stateNode,Rt=!1;break e;case 3:Ae=c.stateNode.containerInfo,Rt=!0;break e;case 4:Ae=c.stateNode.containerInfo,Rt=!0;break e}c=c.return}if(Ae===null)throw Error(P(160));Bh(a,o,s),Ae=null,Rt=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){we(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)$h(t,e),t=t.sibling}function $h(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(_t(t,e),At(e),n&4){try{Xn(3,e,e.return),Ya(3,e)}catch(b){we(e,e.return,b)}try{Xn(5,e,e.return)}catch(b){we(e,e.return,b)}}break;case 1:_t(t,e),At(e),n&512&&r!==null&&hn(r,r.return);break;case 5:if(_t(t,e),At(e),n&512&&r!==null&&hn(r,r.return),e.flags&32){var s=e.stateNode;try{ss(s,"")}catch(b){we(e,e.return,b)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,c=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{c==="input"&&a.type==="radio"&&a.name!=null&&id(s,a),Zi(c,o);var u=Zi(c,a);for(o=0;o<l.length;o+=2){var g=l[o],m=l[o+1];g==="style"?dd(s,m):g==="dangerouslySetInnerHTML"?cd(s,m):g==="children"?ss(s,m):rl(s,g,m,u)}switch(c){case"input":qi(s,a);break;case"textarea":od(s,a);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var v=a.value;v!=null?gn(s,!!a.multiple,v,!1):h!==!!a.multiple&&(a.defaultValue!=null?gn(s,!!a.multiple,a.defaultValue,!0):gn(s,!!a.multiple,a.multiple?[]:"",!1))}s[fs]=a}catch(b){we(e,e.return,b)}}break;case 6:if(_t(t,e),At(e),n&4){if(e.stateNode===null)throw Error(P(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(b){we(e,e.return,b)}}break;case 3:if(_t(t,e),At(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ls(t.containerInfo)}catch(b){we(e,e.return,b)}break;case 4:_t(t,e),At(e);break;case 13:_t(t,e),At(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Al=be())),n&4&&Qc(e);break;case 22:if(g=r!==null&&r.memoizedState!==null,e.mode&1?(Ke=(u=Ke)||g,_t(t,e),Ke=u):_t(t,e),At(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!g&&e.mode&1)for(B=e,g=e.child;g!==null;){for(m=B=g;B!==null;){switch(h=B,v=h.child,h.tag){case 0:case 11:case 14:case 15:Xn(4,h,h.return);break;case 1:hn(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(b){we(n,r,b)}}break;case 5:hn(h,h.return);break;case 22:if(h.memoizedState!==null){Xc(m);continue}}v!==null?(v.return=h,B=v):Xc(m)}g=g.sibling}e:for(g=null,m=e;;){if(m.tag===5){if(g===null){g=m;try{s=m.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(c=m.stateNode,l=m.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,c.style.display=ud("display",o))}catch(b){we(e,e.return,b)}}}else if(m.tag===6){if(g===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(b){we(e,e.return,b)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;g===m&&(g=null),m=m.return}g===m&&(g=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:_t(t,e),At(e),n&4&&Qc(e);break;case 21:break;default:_t(t,e),At(e)}}function At(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Ih(r)){var n=r;break e}r=r.return}throw Error(P(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(ss(s,""),n.flags&=-33);var a=Yc(e);To(e,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,c=Yc(e);Eo(e,c,o);break;default:throw Error(P(161))}}catch(l){we(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Um(e,t,r){B=e,Dh(e)}function Dh(e,t,r){for(var n=(e.mode&1)!==0;B!==null;){var s=B,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Vs;if(!o){var c=s.alternate,l=c!==null&&c.memoizedState!==null||Ke;c=Vs;var u=Ke;if(Vs=o,(Ke=l)&&!u)for(B=s;B!==null;)o=B,l=o.child,o.tag===22&&o.memoizedState!==null?Zc(s):l!==null?(l.return=o,B=l):Zc(s);for(;a!==null;)B=a,Dh(a),a=a.sibling;B=s,Vs=c,Ke=u}Jc(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,B=a):Jc(e)}}function Jc(e){for(;B!==null;){var t=B;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ke||Ya(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ke)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Ct(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Ac(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Ac(t,o,r)}break;case 5:var c=t.stateNode;if(r===null&&t.flags&4){r=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var g=u.memoizedState;if(g!==null){var m=g.dehydrated;m!==null&&ls(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(P(163))}Ke||t.flags&512&&Ro(t)}catch(h){we(t,t.return,h)}}if(t===e){B=null;break}if(r=t.sibling,r!==null){r.return=t.return,B=r;break}B=t.return}}function Xc(e){for(;B!==null;){var t=B;if(t===e){B=null;break}var r=t.sibling;if(r!==null){r.return=t.return,B=r;break}B=t.return}}function Zc(e){for(;B!==null;){var t=B;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Ya(4,t)}catch(l){we(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){we(t,s,l)}}var a=t.return;try{Ro(t)}catch(l){we(t,a,l)}break;case 5:var o=t.return;try{Ro(t)}catch(l){we(t,o,l)}}}catch(l){we(t,t.return,l)}if(t===e){B=null;break}var c=t.sibling;if(c!==null){c.return=t.return,B=c;break}B=t.return}}var Fm=Math.ceil,Pa=Jt.ReactCurrentDispatcher,Ol=Jt.ReactCurrentOwner,xt=Jt.ReactCurrentBatchConfig,te=0,Ee=null,_e=null,Ie=0,st=0,fn=wr(0),Ne=0,xs=null,Dr=0,Qa=0,Ml=0,Zn=null,Ye=null,Al=0,En=1/0,Kt=null,La=!1,Po=null,pr=null,qs=!1,lr=null,Oa=0,es=0,Lo=null,ca=-1,ua=0;function He(){return te&6?be():ca!==-1?ca:ca=be()}function mr(e){return e.mode&1?te&2&&Ie!==0?Ie&-Ie:Cm.transition!==null?(ua===0&&(ua=Sd()),ua):(e=se,e!==0||(e=window.event,e=e===void 0?16:Td(e.type)),e):1}function Lt(e,t,r,n){if(50<es)throw es=0,Lo=null,Error(P(185));Ns(e,r,n),(!(te&2)||e!==Ee)&&(e===Ee&&(!(te&2)&&(Qa|=r),Ne===4&&ar(e,Ie)),Ze(e,n),r===1&&te===0&&!(t.mode&1)&&(En=be()+500,Ha&&br()))}function Ze(e,t){var r=e.callbackNode;Cp(e,t);var n=ga(e,e===Ee?Ie:0);if(n===0)r!==null&&lc(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&lc(r),t===1)e.tag===0?jm(eu.bind(null,e)):Yd(eu.bind(null,e)),bm(function(){!(te&6)&&br()}),r=null;else{switch(_d(n)){case 1:r=ol;break;case 4:r=bd;break;case 16:r=ma;break;case 536870912:r=kd;break;default:r=ma}r=Vh(r,Gh.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Gh(e,t){if(ca=-1,ua=0,te&6)throw Error(P(327));var r=e.callbackNode;if(bn()&&e.callbackNode!==r)return null;var n=ga(e,e===Ee?Ie:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Ma(e,n);else{t=n;var s=te;te|=2;var a=Uh();(Ee!==e||Ie!==t)&&(Kt=null,En=be()+500,Mr(e,t));do try{Hm();break}catch(c){Kh(e,c)}while(!0);wl(),Pa.current=a,te=s,_e!==null?t=0:(Ee=null,Ie=0,t=Ne)}if(t!==0){if(t===2&&(s=so(e),s!==0&&(n=s,t=Oo(e,s))),t===1)throw r=xs,Mr(e,0),ar(e,n),Ze(e,be()),r;if(t===6)ar(e,n);else{if(s=e.current.alternate,!(n&30)&&!Wm(s)&&(t=Ma(e,n),t===2&&(a=so(e),a!==0&&(n=a,t=Oo(e,a))),t===1))throw r=xs,Mr(e,0),ar(e,n),Ze(e,be()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(P(345));case 2:jr(e,Ye,Kt);break;case 3:if(ar(e,n),(n&130023424)===n&&(t=Al+500-be(),10<t)){if(ga(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){He(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=fo(jr.bind(null,e,Ye,Kt),t);break}jr(e,Ye,Kt);break;case 4:if(ar(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-Pt(n);a=1<<o,o=t[o],o>s&&(s=o),n&=~a}if(n=s,n=be()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Fm(n/1960))-n,10<n){e.timeoutHandle=fo(jr.bind(null,e,Ye,Kt),n);break}jr(e,Ye,Kt);break;case 5:jr(e,Ye,Kt);break;default:throw Error(P(329))}}}return Ze(e,be()),e.callbackNode===r?Gh.bind(null,e):null}function Oo(e,t){var r=Zn;return e.current.memoizedState.isDehydrated&&(Mr(e,t).flags|=256),e=Ma(e,t),e!==2&&(t=Ye,Ye=r,t!==null&&Mo(t)),e}function Mo(e){Ye===null?Ye=e:Ye.push.apply(Ye,e)}function Wm(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Ot(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ar(e,t){for(t&=~Ml,t&=~Qa,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Pt(t),n=1<<r;e[r]=-1,t&=~n}}function eu(e){if(te&6)throw Error(P(327));bn();var t=ga(e,0);if(!(t&1))return Ze(e,be()),null;var r=Ma(e,t);if(e.tag!==0&&r===2){var n=so(e);n!==0&&(t=n,r=Oo(e,n))}if(r===1)throw r=xs,Mr(e,0),ar(e,t),Ze(e,be()),r;if(r===6)throw Error(P(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,jr(e,Ye,Kt),Ze(e,be()),null}function Il(e,t){var r=te;te|=1;try{return e(t)}finally{te=r,te===0&&(En=be()+500,Ha&&br())}}function Gr(e){lr!==null&&lr.tag===0&&!(te&6)&&bn();var t=te;te|=1;var r=xt.transition,n=se;try{if(xt.transition=null,se=1,e)return e()}finally{se=n,xt.transition=r,te=t,!(te&6)&&br()}}function Bl(){st=fn.current,he(fn)}function Mr(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,wm(r)),_e!==null)for(r=_e.return;r!==null;){var n=r;switch(yl(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ba();break;case 3:Nn(),he(Je),he(Ue),Cl();break;case 5:jl(n);break;case 4:Nn();break;case 13:he(me);break;case 19:he(me);break;case 10:bl(n.type._context);break;case 22:case 23:Bl()}r=r.return}if(Ee=e,_e=e=gr(e.current,null),Ie=st=t,Ne=0,xs=null,Ml=Qa=Dr=0,Ye=Zn=null,Pr!==null){for(t=0;t<Pr.length;t++)if(r=Pr[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}Pr=null}return e}function Kh(e,t){do{var r=_e;try{if(wl(),ia.current=Ta,Ea){for(var n=ge.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ea=!1}if($r=0,Re=Ce=ge=null,Jn=!1,gs=0,Ol.current=null,r===null||r.return===null){Ne=1,xs=t,_e=null;break}e:{var a=e,o=r.return,c=r,l=t;if(t=Ie,c.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,g=c,m=g.tag;if(!(g.mode&1)&&(m===0||m===11||m===15)){var h=g.alternate;h?(g.updateQueue=h.updateQueue,g.memoizedState=h.memoizedState,g.lanes=h.lanes):(g.updateQueue=null,g.memoizedState=null)}var v=Kc(o);if(v!==null){v.flags&=-257,Uc(v,o,c,a,t),v.mode&1&&Gc(a,u,t),t=v,l=u;var y=t.updateQueue;if(y===null){var b=new Set;b.add(l),t.updateQueue=b}else y.add(l);break e}else{if(!(t&1)){Gc(a,u,t),$l();break e}l=Error(P(426))}}else if(fe&&c.mode&1){var x=Kc(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Uc(x,o,c,a,t),vl(Rn(l,c));break e}}a=l=Rn(l,c),Ne!==4&&(Ne=2),Zn===null?Zn=[a]:Zn.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var d=_h(a,l,t);Mc(a,d);break e;case 1:c=l;var p=a.type,f=a.stateNode;if(!(a.flags&128)&&(typeof p.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(pr===null||!pr.has(f)))){a.flags|=65536,t&=-t,a.lanes|=t;var w=jh(a,c,t);Mc(a,w);break e}}a=a.return}while(a!==null)}Wh(r)}catch(j){t=j,_e===r&&r!==null&&(_e=r=r.return);continue}break}while(!0)}function Uh(){var e=Pa.current;return Pa.current=Ta,e===null?Ta:e}function $l(){(Ne===0||Ne===3||Ne===2)&&(Ne=4),Ee===null||!(Dr&268435455)&&!(Qa&268435455)||ar(Ee,Ie)}function Ma(e,t){var r=te;te|=2;var n=Uh();(Ee!==e||Ie!==t)&&(Kt=null,Mr(e,t));do try{zm();break}catch(s){Kh(e,s)}while(!0);if(wl(),te=r,Pa.current=n,_e!==null)throw Error(P(261));return Ee=null,Ie=0,Ne}function zm(){for(;_e!==null;)Fh(_e)}function Hm(){for(;_e!==null&&!yp();)Fh(_e)}function Fh(e){var t=Hh(e.alternate,e,st);e.memoizedProps=e.pendingProps,t===null?Wh(e):_e=t,Ol.current=null}function Wh(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Dm(r,t),r!==null){r.flags&=32767,_e=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ne=6,_e=null;return}}else if(r=$m(r,t,st),r!==null){_e=r;return}if(t=t.sibling,t!==null){_e=t;return}_e=t=e}while(t!==null);Ne===0&&(Ne=5)}function jr(e,t,r){var n=se,s=xt.transition;try{xt.transition=null,se=1,Vm(e,t,r,n)}finally{xt.transition=s,se=n}return null}function Vm(e,t,r,n){do bn();while(lr!==null);if(te&6)throw Error(P(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(P(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(Np(e,a),e===Ee&&(_e=Ee=null,Ie=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||qs||(qs=!0,Vh(ma,function(){return bn(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=xt.transition,xt.transition=null;var o=se;se=1;var c=te;te|=4,Ol.current=null,Km(e,r),$h(r,e),fm(uo),ya=!!co,uo=co=null,e.current=r,Um(r),vp(),te=c,se=o,xt.transition=a}else e.current=r;if(qs&&(qs=!1,lr=e,Oa=s),a=e.pendingLanes,a===0&&(pr=null),bp(r.stateNode),Ze(e,be()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(La)throw La=!1,e=Po,Po=null,e;return Oa&1&&e.tag!==0&&bn(),a=e.pendingLanes,a&1?e===Lo?es++:(es=0,Lo=e):es=0,br(),null}function bn(){if(lr!==null){var e=_d(Oa),t=xt.transition,r=se;try{if(xt.transition=null,se=16>e?16:e,lr===null)var n=!1;else{if(e=lr,lr=null,Oa=0,te&6)throw Error(P(331));var s=te;for(te|=4,B=e.current;B!==null;){var a=B,o=a.child;if(B.flags&16){var c=a.deletions;if(c!==null){for(var l=0;l<c.length;l++){var u=c[l];for(B=u;B!==null;){var g=B;switch(g.tag){case 0:case 11:case 15:Xn(8,g,a)}var m=g.child;if(m!==null)m.return=g,B=m;else for(;B!==null;){g=B;var h=g.sibling,v=g.return;if(Ah(g),g===u){B=null;break}if(h!==null){h.return=v,B=h;break}B=v}}}var y=a.alternate;if(y!==null){var b=y.child;if(b!==null){y.child=null;do{var x=b.sibling;b.sibling=null,b=x}while(b!==null)}}B=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,B=o;else e:for(;B!==null;){if(a=B,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Xn(9,a,a.return)}var d=a.sibling;if(d!==null){d.return=a.return,B=d;break e}B=a.return}}var p=e.current;for(B=p;B!==null;){o=B;var f=o.child;if(o.subtreeFlags&2064&&f!==null)f.return=o,B=f;else e:for(o=p;B!==null;){if(c=B,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Ya(9,c)}}catch(j){we(c,c.return,j)}if(c===o){B=null;break e}var w=c.sibling;if(w!==null){w.return=c.return,B=w;break e}B=c.return}}if(te=s,br(),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(Ka,e)}catch{}n=!0}return n}finally{se=r,xt.transition=t}}return!1}function tu(e,t,r){t=Rn(r,t),t=_h(e,t,1),e=fr(e,t,1),t=He(),e!==null&&(Ns(e,1,t),Ze(e,t))}function we(e,t,r){if(e.tag===3)tu(e,e,r);else for(;t!==null;){if(t.tag===3){tu(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(pr===null||!pr.has(n))){e=Rn(r,e),e=jh(t,e,1),t=fr(t,e,1),e=He(),t!==null&&(Ns(t,1,e),Ze(t,e));break}}t=t.return}}function qm(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=He(),e.pingedLanes|=e.suspendedLanes&r,Ee===e&&(Ie&r)===r&&(Ne===4||Ne===3&&(Ie&130023424)===Ie&&500>be()-Al?Mr(e,0):Ml|=r),Ze(e,t)}function zh(e,t){t===0&&(e.mode&1?(t=$s,$s<<=1,!($s&130023424)&&($s=4194304)):t=1);var r=He();e=Yt(e,t),e!==null&&(Ns(e,t,r),Ze(e,r))}function Ym(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),zh(e,r)}function Qm(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(P(314))}n!==null&&n.delete(t),zh(e,r)}var Hh;Hh=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Je.current)Qe=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Qe=!1,Bm(e,t,r);Qe=!!(e.flags&131072)}else Qe=!1,fe&&t.flags&1048576&&Qd(t,_a,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;la(e,t),e=t.pendingProps;var s=_n(t,Ue.current);wn(t,r),s=Rl(null,t,n,e,s,r);var a=El();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Xe(n)?(a=!0,ka(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Sl(t),s.updater=qa,t.stateNode=s,s._reactInternals=t,wo(t,n,e,r),t=So(null,t,n,!0,a,r)):(t.tag=0,fe&&a&&gl(t),ze(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(la(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=Xm(n),e=Ct(n,e),s){case 0:t=ko(null,t,n,e,r);break e;case 1:t=zc(null,t,n,e,r);break e;case 11:t=Fc(null,t,n,e,r);break e;case 14:t=Wc(null,t,n,Ct(n.type,e),r);break e}throw Error(P(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ct(n,s),ko(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ct(n,s),zc(e,t,n,s,r);case 3:e:{if(Eh(t),e===null)throw Error(P(387));n=t.pendingProps,a=t.memoizedState,s=a.element,rh(e,t),Na(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=Rn(Error(P(423)),t),t=Hc(e,t,n,r,s);break e}else if(n!==s){s=Rn(Error(P(424)),t),t=Hc(e,t,n,r,s);break e}else for(ot=hr(t.stateNode.containerInfo.firstChild),lt=t,fe=!0,Tt=null,r=eh(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(jn(),n===s){t=Qt(e,t,r);break e}ze(e,t,n,r)}t=t.child}return t;case 5:return nh(t),e===null&&yo(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,o=s.children,ho(n,s)?o=null:a!==null&&ho(n,a)&&(t.flags|=32),Rh(e,t),ze(e,t,o,r),t.child;case 6:return e===null&&yo(t),null;case 13:return Th(e,t,r);case 4:return _l(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Cn(t,null,n,r):ze(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ct(n,s),Fc(e,t,n,s,r);case 7:return ze(e,t,t.pendingProps,r),t.child;case 8:return ze(e,t,t.pendingProps.children,r),t.child;case 12:return ze(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,o=s.value,ce(ja,n._currentValue),n._currentValue=o,a!==null)if(Ot(a.value,o)){if(a.children===s.children&&!Je.current){t=Qt(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var c=a.dependencies;if(c!==null){o=a.child;for(var l=c.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=Ht(-1,r&-r),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var g=u.pending;g===null?l.next=l:(l.next=g.next,g.next=l),u.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),vo(a.return,r,t),c.lanes|=r;break}l=l.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(P(341));o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),vo(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}ze(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,wn(t,r),s=wt(s),n=n(s),t.flags|=1,ze(e,t,n,r),t.child;case 14:return n=t.type,s=Ct(n,t.pendingProps),s=Ct(n.type,s),Wc(e,t,n,s,r);case 15:return Ch(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ct(n,s),la(e,t),t.tag=1,Xe(n)?(e=!0,ka(t)):e=!1,wn(t,r),Sh(t,n,s),wo(t,n,s,r),So(null,t,n,!0,e,r);case 19:return Ph(e,t,r);case 22:return Nh(e,t,r)}throw Error(P(156,t.tag))};function Vh(e,t){return wd(e,t)}function Jm(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vt(e,t,r,n){return new Jm(e,t,r,n)}function Dl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Xm(e){if(typeof e=="function")return Dl(e)?1:0;if(e!=null){if(e=e.$$typeof,e===sl)return 11;if(e===al)return 14}return 2}function gr(e,t){var r=e.alternate;return r===null?(r=vt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function da(e,t,r,n,s,a){var o=2;if(n=e,typeof e=="function")Dl(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case rn:return Ar(r.children,s,a,t);case nl:o=8,s|=8;break;case Fi:return e=vt(12,r,t,s|2),e.elementType=Fi,e.lanes=a,e;case Wi:return e=vt(13,r,t,s),e.elementType=Wi,e.lanes=a,e;case zi:return e=vt(19,r,t,s),e.elementType=zi,e.lanes=a,e;case nd:return Ja(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case td:o=10;break e;case rd:o=9;break e;case sl:o=11;break e;case al:o=14;break e;case tr:o=16,n=null;break e}throw Error(P(130,e==null?e:typeof e,""))}return t=vt(o,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Ar(e,t,r,n){return e=vt(7,e,n,t),e.lanes=r,e}function Ja(e,t,r,n){return e=vt(22,e,n,t),e.elementType=nd,e.lanes=r,e.stateNode={isHidden:!1},e}function Ei(e,t,r){return e=vt(6,e,null,t),e.lanes=r,e}function Ti(e,t,r){return t=vt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Zm(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ui(0),this.expirationTimes=ui(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ui(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Gl(e,t,r,n,s,a,o,c,l){return e=new Zm(e,t,r,c,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=vt(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Sl(a),e}function eg(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:tn,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function qh(e){if(!e)return vr;e=e._reactInternals;e:{if(Ur(e)!==e||e.tag!==1)throw Error(P(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Xe(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(P(171))}if(e.tag===1){var r=e.type;if(Xe(r))return qd(e,r,t)}return t}function Yh(e,t,r,n,s,a,o,c,l){return e=Gl(r,n,!0,e,s,a,o,c,l),e.context=qh(null),r=e.current,n=He(),s=mr(r),a=Ht(n,s),a.callback=t??null,fr(r,a,s),e.current.lanes=s,Ns(e,s,n),Ze(e,n),e}function Xa(e,t,r,n){var s=t.current,a=He(),o=mr(s);return r=qh(r),t.context===null?t.context=r:t.pendingContext=r,t=Ht(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=fr(s,t,o),e!==null&&(Lt(e,s,o,a),aa(e,s,o)),o}function Aa(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ru(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Kl(e,t){ru(e,t),(e=e.alternate)&&ru(e,t)}function tg(){return null}var Qh=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ul(e){this._internalRoot=e}Za.prototype.render=Ul.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(P(409));Xa(e,t,null,null)};Za.prototype.unmount=Ul.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Gr(function(){Xa(null,e,null,null)}),t[qt]=null}};function Za(e){this._internalRoot=e}Za.prototype.unstable_scheduleHydration=function(e){if(e){var t=Nd();e={blockedOn:null,target:e,priority:t};for(var r=0;r<sr.length&&t!==0&&t<sr[r].priority;r++);sr.splice(r,0,e),r===0&&Ed(e)}};function Fl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ei(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function nu(){}function rg(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=Aa(o);a.call(u)}}var o=Yh(t,n,e,0,null,!1,!1,"",nu);return e._reactRootContainer=o,e[qt]=o.current,ds(e.nodeType===8?e.parentNode:e),Gr(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var c=n;n=function(){var u=Aa(l);c.call(u)}}var l=Gl(e,0,!1,null,null,!1,!1,"",nu);return e._reactRootContainer=l,e[qt]=l.current,ds(e.nodeType===8?e.parentNode:e),Gr(function(){Xa(t,l,r,n)}),l}function ti(e,t,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var c=s;s=function(){var l=Aa(o);c.call(l)}}Xa(t,o,e,s)}else o=rg(r,t,e,s,n);return Aa(o)}jd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Fn(t.pendingLanes);r!==0&&(ll(t,r|1),Ze(t,be()),!(te&6)&&(En=be()+500,br()))}break;case 13:Gr(function(){var n=Yt(e,1);if(n!==null){var s=He();Lt(n,e,1,s)}}),Kl(e,1)}};cl=function(e){if(e.tag===13){var t=Yt(e,134217728);if(t!==null){var r=He();Lt(t,e,134217728,r)}Kl(e,134217728)}};Cd=function(e){if(e.tag===13){var t=mr(e),r=Yt(e,t);if(r!==null){var n=He();Lt(r,e,t,n)}Kl(e,t)}};Nd=function(){return se};Rd=function(e,t){var r=se;try{return se=e,t()}finally{se=r}};to=function(e,t,r){switch(t){case"input":if(qi(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=za(n);if(!s)throw Error(P(90));ad(n),qi(n,s)}}}break;case"textarea":od(e,r);break;case"select":t=r.value,t!=null&&gn(e,!!r.multiple,t,!1)}};pd=Il;md=Gr;var ng={usingClientEntryPoint:!1,Events:[Es,on,za,hd,fd,Il]},Gn={findFiberByHostInstance:Tr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sg={bundleType:Gn.bundleType,version:Gn.version,rendererPackageName:Gn.rendererPackageName,rendererConfig:Gn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jt.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=vd(e),e===null?null:e.stateNode},findFiberByHostInstance:Gn.findFiberByHostInstance||tg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ys=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ys.isDisabled&&Ys.supportsFiber)try{Ka=Ys.inject(sg),$t=Ys}catch{}}dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ng;dt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fl(t))throw Error(P(200));return eg(e,t,null,r)};dt.createRoot=function(e,t){if(!Fl(e))throw Error(P(299));var r=!1,n="",s=Qh;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Gl(e,1,!1,null,null,r,!1,n,s),e[qt]=t.current,ds(e.nodeType===8?e.parentNode:e),new Ul(t)};dt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(P(188)):(e=Object.keys(e).join(","),Error(P(268,e)));return e=vd(t),e=e===null?null:e.stateNode,e};dt.flushSync=function(e){return Gr(e)};dt.hydrate=function(e,t,r){if(!ei(t))throw Error(P(200));return ti(null,e,t,!0,r)};dt.hydrateRoot=function(e,t,r){if(!Fl(e))throw Error(P(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=Qh;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=Yh(t,null,e,1,r??null,s,!1,a,o),e[qt]=t.current,ds(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Za(t)};dt.render=function(e,t,r){if(!ei(t))throw Error(P(200));return ti(null,e,t,!1,r)};dt.unmountComponentAtNode=function(e){if(!ei(e))throw Error(P(40));return e._reactRootContainer?(Gr(function(){ti(null,null,e,!1,function(){e._reactRootContainer=null,e[qt]=null})}),!0):!1};dt.unstable_batchedUpdates=Il;dt.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ei(r))throw Error(P(200));if(e==null||e._reactInternals===void 0)throw Error(P(38));return ti(e,t,r,!1,n)};dt.version="18.3.1-next-f1338f8080-20240426";function Jh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Jh)}catch(e){console.error(e)}}Jh(),Ju.exports=dt;var ag=Ju.exports,su=ag;Ki.createRoot=su.createRoot,Ki.hydrateRoot=su.hydrateRoot;function gt(e,t){const r=e.trim(),n=r.startsWith("...");let s=r.replace(/\.\.\./g,"").trim();const a=/([A-Z]+)\/?([\d]+)/gi,o=[];let c;for(;(c=a.exec(s))!==null;){const h=c[0],v=c[1].toUpperCase(),y=parseInt(c[2],10),b=h.includes("/");o.push({color:v,count:y,isPivot:b})}if(o.length===0)throw new Error(`Invalid threadcount: ${e}`);const l=o.some(h=>h.isPivot),u=n?"asymmetric":"symmetric",g=o.reduce((h,v)=>h+v.count,0),m=[...new Set(o.map(h=>h.color))];return{name:t,threadcount:r,stripes:o,symmetry:u,totalThreads:g,colors:m}}function ut(e){const t=[];if(e.symmetry==="symmetric"){for(const n of e.stripes)for(let s=0;s<n.count;s++)t.push(n.color);for(let n=e.stripes.length-1;n>=0;n--){const s=e.stripes[n];if(!s.isPivot)for(let a=0;a<s.count;a++)t.push(s.color)}}else for(const n of e.stripes)for(let s=0;s<n.count;s++)t.push(n.color);const r={};for(const n of t)r[n]=(r[n]||0)+1;return{threads:t,length:t.length,distribution:r}}function au(e,t){const r=(t%e.length+e.length)%e.length;return e.threads[r]}function ig(e){ut(e);const t=e.stripes.map(c=>`${c.color}${c.count}`).join("-"),r=new Map;let n=65;const s=e.stripes.map(c=>(r.has(c.color)||r.set(c.color,String.fromCharCode(n++)),`${r.get(c.color)}${c.count}`)).join("-"),a=e.totalThreads,o=e.stripes.map(c=>{const l=c.count/a;return Math.round(l*100)/100}).join(":");return{signature:t,structureSignature:s,proportionSignature:o}}function og(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!t)throw new Error(`Invalid hex color: ${e}`);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function iu(e){return"#"+[e.r,e.g,e.b].map(t=>Math.round(t).toString(16).padStart(2,"0")).join("")}function lg(e){let t=e.r/255,r=e.g/255,n=e.b/255;return t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,t*=100,r*=100,n*=100,{x:t*.4124564+r*.3575761+n*.1804375,y:t*.2126729+r*.7151522+n*.072175,z:t*.0193339+r*.119192+n*.9503041}}function Ao(e){const t=lg(e),r=95.047,n=100,s=108.883;let a=t.x/r,o=t.y/n,c=t.z/s;const l=.008856,u=903.3;return a=a>l?Math.pow(a,1/3):(u*a+16)/116,o=o>l?Math.pow(o,1/3):(u*o+16)/116,c=c>l?Math.pow(c,1/3):(u*c+16)/116,{L:116*o-16,a:500*(a-o),b:200*(o-c)}}function cg(e,t){const r=Math.PI/180,n=180/Math.PI,s=e.L,a=e.a,o=e.b,c=t.L,l=t.a,u=t.b,g=Math.sqrt(a*a+o*o),m=Math.sqrt(l*l+u*u),h=(g+m)/2,v=.5*(1-Math.sqrt(Math.pow(h,7)/(Math.pow(h,7)+Math.pow(25,7)))),y=a*(1+v),b=l*(1+v),x=Math.sqrt(y*y+o*o),d=Math.sqrt(b*b+u*u);let p=Math.atan2(o,y)*n;p<0&&(p+=360);let f=Math.atan2(u,b)*n;f<0&&(f+=360);const w=c-s,j=d-x;let _;x*d===0?_=0:Math.abs(f-p)<=180?_=f-p:f-p>180?_=f-p-360:_=f-p+360;const k=2*Math.sqrt(x*d)*Math.sin(_*r/2),S=(s+c)/2,C=(x+d)/2;let R;x*d===0?R=p+f:Math.abs(p-f)<=180?R=(p+f)/2:p+f<360?R=(p+f+360)/2:R=(p+f-360)/2;const M=1-.17*Math.cos((R-30)*r)+.24*Math.cos(2*R*r)+.32*Math.cos((3*R+6)*r)-.2*Math.cos((4*R-63)*r),I=30*Math.exp(-Math.pow((R-275)/25,2)),E=2*Math.sqrt(Math.pow(C,7)/(Math.pow(C,7)+Math.pow(25,7))),T=1+.015*Math.pow(S-50,2)/Math.sqrt(20+Math.pow(S-50,2)),D=1+.045*C,z=1+.015*C*M,re=-Math.sin(2*I*r)*E,O=1,G=1,K=1;return Math.sqrt(Math.pow(w/(O*T),2)+Math.pow(j/(G*D),2)+Math.pow(k/(K*z),2)+re*(j/(G*D))*(k/(K*z)))}function ug(e,t,r=15){const n=e.lab||Ao(e.rgb),s=t.lab||Ao(t.rgb);return cg(n,s)>=r}function ou(e,t){return{r:Math.min(255,Math.max(0,Math.round(e.r*t))),g:Math.min(255,Math.max(0,Math.round(e.g*t))),b:Math.min(255,Math.max(0,Math.round(e.b*t)))}}function $(e,t,r,n){const s=og(r);return{code:e,name:t,hex:r,rgb:s,lab:Ao(s),category:n}}const yt={B:$("B","Blue","#0000CD","blue"),LB:$("LB","Light Blue","#87CEEB","blue"),DB:$("DB","Dark Blue","#00008B","blue"),AB:$("AB","Azure Blue","#1E90FF","blue"),RB:$("RB","Royal Blue","#4169E1","blue"),NB:$("NB","Navy Blue","#000080","blue"),R:$("R","Red","#DC143C","red"),LR:$("LR","Light Red","#FF6B6B","red"),DR:$("DR","Dark Red","#8B0000","red"),CR:$("CR","Crimson","#DC143C","red"),SC:$("SC","Scarlet","#FF2400","red"),MR:$("MR","Maroon","#800000","red"),G:$("G","Green","#228B22","green"),LG:$("LG","Light Green","#90EE90","green"),DG:$("DG","Dark Green","#006400","green"),HG:$("HG","Hunting Green","#355E3B","green"),OG:$("OG","Olive Green","#6B8E23","green"),FG:$("FG","Forest Green","#228B22","green"),TL:$("TL","Teal","#008080","teal"),Y:$("Y","Yellow","#FFD700","yellow"),LY:$("LY","Light Yellow","#FFFFE0","yellow"),GD:$("GD","Gold","#DAA520","yellow"),AM:$("AM","Amber","#FFBF00","yellow"),ST:$("ST","Straw","#E4D96F","yellow"),K:$("K","Black","#000000","black"),GY:$("GY","Grey","#808080","grey"),LGY:$("LGY","Light Grey","#C0C0C0","grey"),DGY:$("DGY","Dark Grey","#404040","grey"),CH:$("CH","Charcoal","#36454F","grey"),W:$("W","White","#FFFFFF","white"),CW:$("CW","Cream White","#FFFDD0","white"),IW:$("IW","Ivory White","#FFFFF0","white"),BR:$("BR","Brown","#8B4513","brown"),LBR:$("LBR","Light Brown","#C4A484","brown"),DBR:$("DBR","Dark Brown","#5C4033","brown"),TN:$("TN","Tan","#D2B48C","brown"),RU:$("RU","Rust","#B7410E","brown"),CB:$("CB","Camel Brown","#C19A6B","brown"),P:$("P","Purple","#800080","purple"),LP:$("LP","Light Purple","#DDA0DD","purple"),DP:$("DP","Dark Purple","#4B0082","purple"),VI:$("VI","Violet","#8B00FF","purple"),LV:$("LV","Lavender","#E6E6FA","purple"),O:$("O","Orange","#FF8C00","orange"),LO:$("LO","Light Orange","#FFDAB9","orange"),DO:$("DO","Dark Orange","#FF4500","orange"),PK:$("PK","Pink","#FF69B4","pink"),LP2:$("LP2","Light Pink","#FFB6C1","pink"),DP2:$("DP2","Deep Pink","#FF1493","pink"),NP:$("NP","Neon Pink","#FF6EC7","neon"),NY:$("NY","Neon Yellow","#FFFF33","neon"),NO:$("NO","Neon Orange","#FF5F1F","neon"),NG:$("NG","Neon Green","#39FF14","neon"),NE:$("NE","Neon Blue","#00AFEC","neon"),NC:$("NC","Neon Cyan","#00FFFF","neon"),NM:$("NM","Neon Magenta","#FF00FF","neon"),NV:$("NV","Neon Violet","#BF00FF","neon"),NR:$("NR","Neon Coral","#FF6F61","neon"),NL:$("NL","Neon Lime","#CCFF00","neon"),NT:$("NT","Neon Turquoise","#00FFD1","neon"),NS:$("NS","Neon Salmon","#FF6D88","neon"),NA:$("NA","Neon Aqua","#00FFC8","neon"),NW:$("NW","UV White","#F0F0FF","neon"),UV:$("UV","UV Reactive Blue","#1B03A3","neon")};function Te(e){return yt[e.toUpperCase()]}function dg(e){return function(){let t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}function hg(e){const t=dg(e);return{float:()=>t(),int:(r,n)=>Math.floor(t()*(n-r+1))+r,pick:r=>r[Math.floor(t()*r.length)],shuffle:r=>{for(let n=r.length-1;n>0;n--){const s=Math.floor(t()*(n+1));[r[n],r[s]]=[r[s],r[n]]}return r},weighted:(r,n)=>{const s=n.reduce((o,c)=>o+c,0);let a=t()*s;for(let o=0;o<r.length;o++)if(a-=n[o],a<=0)return r[o];return r[r.length-1]}}}const Cr={colorCount:{min:3,max:6},stripeCount:{min:4,max:12},threadCount:{min:4,max:48},totalThreads:{min:60,max:180},symmetry:"symmetric",minColorContrast:20};function Io(e={},t){const r={...Cr,...e},n=t??Math.floor(Math.random()*2147483647),s=hg(n),a=fg(r,s),o=pg(a,r,s),c=mg(o,r.symmetry==="symmetric"),l=gt(c),u=ig(l);return{sett:l,seed:n,constraints:r,signature:u}}function fg(e,t){const{colorCount:r,allowedColors:n,requiredColors:s,minColorContrast:a=15}=e;let o=n||Object.keys(yt);const c=t.int(r.min,r.max),l=[...s||[]];for(o=o.filter(u=>!l.includes(u));l.length<c&&o.length>0;){t.shuffle(o);let u=!1;for(const g of o){const m=Te(g);if(!m)continue;if(l.every(v=>{const y=Te(v);return!y||ug(m,y,a)})||l.length===0){l.push(g),o=o.filter(v=>v!==g),u=!0;break}}if(!u&&o.length>0){const g=o.shift();l.push(g)}}return l}function pg(e,t,r){const{stripeCount:n,threadCount:s,totalThreads:a}=t,o=r.int(n.min,n.max),c=[];let l=r.int(a.min,a.max);for(let u=0;u<o;u++){let g=[...e];u>0&&(g=g.filter(b=>b!==c[u-1].color));const m=r.pick(g),h=u===o-1;let v;if(h)v=Math.max(s.min,Math.min(s.max,l));else{const b=l/(o-u),x=Math.max(s.min,Math.floor(b*.3)),d=Math.min(s.max,Math.floor(b*1.7),l-(o-u-1)*s.min);v=r.int(Math.max(x,s.min),Math.max(d,s.min))}l-=v;const y=u===0||u===o-1;c.push({color:m,count:v,isPivot:y})}return c}function mg(e,t){return e.map(n=>{const s=t&&n.isPivot?"/":"";return`${n.color}${s}${n.count}`}).join(" ")}function gg(e,t={},r){const n=[],s=new Set,a=Math.floor(Math.random()*2147483647);let o=0;const c=e*10;for(;n.length<e&&o<c;){const l=Io(t,a+o);o++,s.has(l.signature.structureSignature)||(s.add(l.signature.structureSignature),n.push(l))}return n}const Gt={plain:{type:"plain",name:"Plain Weave",description:"Simple 1/1 over-under pattern. Creates a balanced, crisp appearance.",threading:[1,2],tieUp:[[!0,!1],[!1,!0]],treadling:[1,2],shafts:2,treadles:2},"twill-2-2":{type:"twill-2-2",name:"2/2 Twill",description:"Traditional tartan weave. Creates diagonal lines and good drape.",threading:[1,2,3,4],tieUp:[[!0,!0,!1,!1],[!1,!0,!0,!1],[!1,!1,!0,!0],[!0,!1,!1,!0]],treadling:[1,2,3,4],shafts:4,treadles:4},"twill-3-1":{type:"twill-3-1",name:"3/1 Twill",description:"Warp-dominant twill with steeper diagonal. Shows more warp color.",threading:[1,2,3,4],tieUp:[[!0,!0,!0,!1],[!1,!0,!0,!0],[!0,!1,!0,!0],[!0,!0,!1,!0]],treadling:[1,2,3,4],shafts:4,treadles:4},herringbone:{type:"herringbone",name:"Herringbone",description:"Reversing twill creating V-shaped pattern.",threading:[1,2,3,4,3,2],tieUp:[[!0,!0,!1,!1],[!1,!0,!0,!1],[!1,!1,!0,!0],[!0,!1,!1,!0]],treadling:[1,2,3,4,3,2],shafts:4,treadles:4},houndstooth:{type:"houndstooth",name:"Houndstooth",description:"Classic broken check pattern.",threading:[1,2,3,4],tieUp:[[!0,!0,!1,!1],[!0,!0,!1,!1],[!1,!1,!0,!0],[!1,!1,!0,!0]],treadling:[1,1,2,2,3,3,4,4],shafts:4,treadles:4},basketweave:{type:"basketweave",name:"Basket Weave",description:"2/2 plain variant with doubled threads. Creates textured surface.",threading:[1,1,2,2],tieUp:[[!0,!1],[!1,!0]],treadling:[1,1,2,2],shafts:2,treadles:2}};function yg(e,t,r){const n=e.threading.length,s=e.threading[t%n]-1,a=e.treadling.length,o=e.treadling[r%a]-1;return e.tieUp[o][s]}function Ia(e,t,r,n,s){const a=au(e,n),o=au(t,s),c=yg(r,n,s);return{color:c?a:o,warpOnTop:c,warpColor:a,weftColor:o}}function vg(e,t){const r=[];for(let n=0;n<t;n++)r.push(e.threading[n%e.threading.length]);return r}function xg(e,t){const r=[];for(let n=0;n<t;n++)r.push(e.treadling[n%e.treadling.length]);return r}const wg=()=>({brightness:1,hueShift:0,saturationMult:1}),bg=(e,t,r,n,s)=>{const{elementSize:a,depth:o,lightAngle:c,ambientLight:l}=s,u=a*2,g=a*Math.sqrt(3),h=Math.floor(t/g)%2*u/2,v=(e+h)%u/u,y=t%g/g,b=.5,x=.5,d=v-b,p=y-x;let f;p<-.15?f="top":d<0?f="left":f="right";const w=c*Math.PI/180,j=Math.cos(w),_=Math.sin(w);let k;switch(f){case"top":k=.3+.7*Math.max(0,-_);break;case"left":k=.3+.5*Math.max(0,-j-_*.5);break;case"right":k=.3+.5*Math.max(0,j-_*.5);break}const S=l+(1-l)*k*o;return{brightness:Math.max(.2,Math.min(1.2,S)),hueShift:0,saturationMult:.9+S*.2}},kg=(e,t,r,n,s)=>{const{elementSize:a,depth:o}=s,c=a*3,l=e%c/c,u=t%c/c,g=Math.floor((l+u*2)*3)%3;return{brightness:[.6,.9,1.1][g]*o+(1-o),hueShift:g*3,saturationMult:1}},Sg=(e,t,r,n,s)=>{const{elementSize:a,depth:o,lightAngle:c}=s,l=a,u=l*Math.sqrt(3),g=l*2,m=Math.floor(t/(u*.75)),h=m%2*g*.5,y=Math.floor((e+h)/g)*g-h+g/2,b=m*u*.75+u/2,x=e-y,d=t-b,p=Math.sqrt(x*x+d*d),f=l*.9,w=Math.min(1,p/f),j=Math.cos(w*Math.PI/2),_=c*Math.PI/180,k=Math.cos(_),S=Math.sin(_),C=x/f,R=d/f,M=C*k+R*S,I=.5+.5*(j+M*.3)*o;return{brightness:Math.max(.3,Math.min(1.2,I)),hueShift:0,saturationMult:1-w*.2}},_g=(e,t,r,n,s)=>{const{elementSize:a,depth:o,lightAngle:c,ambientLight:l}=s,u=a*2,g=Math.floor(e/u),m=Math.floor(t/u),h=(g+.5)*u,v=(m+.5)*u,y=(e-h)/(u/2),b=(t-v)/(u/2),x=y*y+b*b;if(x>1)return{brightness:l,hueShift:0,saturationMult:.8};const d=Math.sqrt(1-x),p=y,f=b,w=c*Math.PI/180,j=Math.cos(w)*.7,_=Math.sin(w)*.7,k=.7,S=Math.max(0,p*j+f*_+d*k),C=2*d*d-k,R=Math.pow(Math.max(0,C),20),M=l+(S*.7+R*.5)*o;return{brightness:Math.max(.2,Math.min(1.4,M)),hueShift:R*10,saturationMult:1-R*.5}},jg=(e,t,r,n,s)=>{const{elementSize:a,depth:o,lightAngle:c}=s,l=a*2,u=o*.5,g=Math.sin(e/l*Math.PI*2),m=Math.sin(t/l*Math.PI*2),h=Math.sin((e+t)/l*Math.PI*2),v=(g+m*.5+h*.3)/1.8,y=Math.cos(e/l*Math.PI*2),b=Math.cos(t/l*Math.PI*2),x=c*Math.PI/180,d=Math.cos(x),p=Math.sin(x),f=y*d+b*p,w=.6+v*u+f*.3*o;return{brightness:Math.max(.3,Math.min(1.3,w)),hueShift:v*5,saturationMult:1}},Cg=(e,t,r,n,s)=>{const{elementSize:a,depth:o,lightAngle:c}=s,l=a*2,u=(e+t)/Math.sqrt(2),g=(t-e)/Math.sqrt(2),m=(u%l+l)%l/l,v=(g%l+l)%l/l<.5&&m>.25&&m<.75,y=m<.5;let b;return v?b=1.1:y?b=.7:b=.9,{brightness:.4+b*.6*o,hueShift:0,saturationMult:1}},Ng=(e,t,r,n,s)=>{const{elementSize:a,depth:o}=s,c=a,l=4,u=Math.floor(e/c)%l,g=Math.floor(t/c)%l,m=(u+g)%l,v=[.6,.75,.9,1.05][m],y=e%c/c,b=t%c/c,x=y<.1||b<.1,d=v*o+(x?.1:0);return{brightness:Math.max(.3,Math.min(1.2,d)),hueShift:m*2,saturationMult:1}},Rg={none:wg,cube:bg,penrose:kg,hexagon:Sg,sphere:_g,wave:jg,diamond:Cg,escher:Ng};function Eg(e){return Rg[e]}function lu(e,t,r,n,s){return Eg(s.type)(e,t,r,n,s)}const Tg={"subtle-cubes":{type:"cube",elementSize:40,depth:.5,lightAngle:45,ambientLight:.4},"deep-cubes":{type:"cube",elementSize:60,depth:1,lightAngle:30,ambientLight:.2},honeycomb:{type:"hexagon",elementSize:30,depth:.7,lightAngle:60,ambientLight:.3},bubbles:{type:"sphere",elementSize:50,depth:.8,lightAngle:45,ambientLight:.3},"water-ripple":{type:"wave",elementSize:25,depth:.6,lightAngle:90,ambientLight:.4},"gem-facets":{type:"diamond",elementSize:35,depth:.9,lightAngle:45,ambientLight:.3},"impossible-stairs":{type:"escher",elementSize:45,depth:.8,lightAngle:45,ambientLight:.3},"penrose-tiles":{type:"penrose",elementSize:40,depth:.7,lightAngle:45,ambientLight:.4}};function Pg(){return{type:"none",elementSize:40,depth:.7,lightAngle:45,ambientLight:.3}}function Lg(e,t,r={}){const{title:n=e.name||"Untitled Tartan",author:s="Tartan System",notes:a=`Generated from threadcount: ${e.threadcount}`,units:o="centimeters",density:c=10,warpRepeats:l=2,weftRepeats:u=2}=r,g=ut(e),m=g.length*l,h=g.length*u,v=Og(e.colors),y=[];y.push("[WIF]"),y.push("Version=1.1"),y.push("Date="+new Date().toISOString().split("T")[0]),y.push("Developers=Tartan System"),y.push("Source Program=Tartan System"),y.push("Source Version=1.0"),y.push(""),y.push("[CONTENTS]"),y.push("COLOR PALETTE=yes"),y.push("WEAVING=yes"),y.push("WARP=yes"),y.push("WEFT=yes"),y.push("COLOR TABLE=yes"),y.push("THREADING=yes"),y.push("TIEUP=yes"),y.push("TREADLING=yes"),y.push("WARP COLORS=yes"),y.push("WEFT COLORS=yes"),y.push(""),y.push("[COLOR PALETTE]"),y.push("Entries="+v.length),y.push("Form=RGB"),y.push("Range=0,255"),y.push(""),y.push("[COLOR TABLE]"),v.forEach((f,w)=>{y.push(`${w+1}=${f.r},${f.g},${f.b}`)}),y.push(""),y.push("[WEAVING]"),y.push("Shafts="+t.shafts),y.push("Treadles="+t.treadles),y.push("Rising Shed=yes"),y.push(""),y.push("[WARP]"),y.push("Threads="+m),y.push("Units="+o),y.push("Spacing="+(1/c).toFixed(4)),y.push("Thickness="+(.8/c).toFixed(4)),y.push(""),y.push("[WEFT]"),y.push("Threads="+h),y.push("Units="+o),y.push("Spacing="+(1/c).toFixed(4)),y.push("Thickness="+(.8/c).toFixed(4)),y.push(""),y.push("[NOTES]"),y.push("1="+n),y.push("2="+a),s&&y.push("3=Author: "+s),y.push(""),y.push("[THREADING]"),vg(t,m).forEach((f,w)=>{y.push(`${w+1}=${f}`)}),y.push(""),y.push("[TIEUP]");for(let f=0;f<t.treadles;f++){const w=t.tieUp[f].map((j,_)=>j?_+1:null).filter(j=>j!==null).join(",");y.push(`${f+1}=${w}`)}y.push(""),y.push("[TREADLING]"),xg(t,h).forEach((f,w)=>{y.push(`${w+1}=${f}`)}),y.push(""),y.push("[WARP COLORS]");for(let f=0;f<m;f++){const w=g.threads[f%g.length],j=cu(v,w,e.colors);y.push(`${f+1}=${j}`)}y.push(""),y.push("[WEFT COLORS]");for(let f=0;f<h;f++){const w=g.threads[f%g.length],j=cu(v,w,e.colors);y.push(`${f+1}=${j}`)}const d=y.join(`
`),p=`${n.replace(/[^a-zA-Z0-9]/g,"_")}.wif`;return{content:d,filename:p}}function Og(e){return e.map(t=>{const r=Te(t);return r?{r:r.rgb.r,g:r.rgb.g,b:r.rgb.b}:{r:128,g:128,b:128}})}function cu(e,t,r){const n=r.indexOf(t);return n>=0?n+1:1}const Mg={lace:{weightClass:"lace",wpi:35,yardsPer100g:800,typicalGauge:32},fingering:{weightClass:"fingering",wpi:28,yardsPer100g:400,typicalGauge:28},sport:{weightClass:"sport",wpi:22,yardsPer100g:300,typicalGauge:24},dk:{weightClass:"dk",wpi:18,yardsPer100g:230,typicalGauge:22},worsted:{weightClass:"worsted",wpi:14,yardsPer100g:200,typicalGauge:18},aran:{weightClass:"aran",wpi:12,yardsPer100g:170,typicalGauge:16},bulky:{weightClass:"bulky",wpi:9,yardsPer100g:125,typicalGauge:12},"super-bulky":{weightClass:"super-bulky",wpi:6,yardsPer100g:85,typicalGauge:8}};function Ag(e){return Mg[e]}const Bo={"scarf-narrow":{name:"Narrow Scarf",description:"Lightweight accessory scarf",dimensions:{width:6,length:60,unit:"inch"},recommendedYarnWeight:"fingering",recommendedGauge:28},"scarf-wide":{name:"Wide Scarf",description:"Standard winter scarf",dimensions:{width:10,length:72,unit:"inch"},recommendedYarnWeight:"dk",recommendedGauge:20},"blanket-throw":{name:"Throw Blanket",description:"Lap blanket / throw",dimensions:{width:50,length:60,unit:"inch"},recommendedYarnWeight:"worsted",recommendedGauge:16},"blanket-full":{name:"Full Blanket",description:"Full-size bed blanket",dimensions:{width:60,length:80,unit:"inch"},recommendedYarnWeight:"aran",recommendedGauge:14},pillow:{name:"Throw Pillow",description:'18" square pillow cover',dimensions:{width:18,length:18,unit:"inch"},recommendedYarnWeight:"sport",recommendedGauge:18},"table-runner":{name:"Table Runner",description:"Dining table centerpiece",dimensions:{width:12,length:72,unit:"inch"},recommendedYarnWeight:"fingering",recommendedGauge:24},placemat:{name:"Placemat",description:"Standard placemat",dimensions:{width:12,length:18,unit:"inch"},recommendedYarnWeight:"dk",recommendedGauge:18},"kilt-yardage":{name:"Kilt Yardage",description:"8-yard kilt (traditional)",dimensions:{width:54,length:288,unit:"inch"},recommendedYarnWeight:"worsted",recommendedGauge:48},sash:{name:"Sash / Fly Plaid",description:"Shoulder sash",dimensions:{width:12,length:108,unit:"inch"},recommendedYarnWeight:"worsted",recommendedGauge:48},"fabric-yard":{name:"Fabric (per yard)",description:'54" wide fabric yardage',dimensions:{width:54,length:36,unit:"inch"},recommendedYarnWeight:"worsted",recommendedGauge:48}};function Ig(e){return Bo[e]}function Bg(e,t,r,n){const{gauge:s,wasteMultiplier:a=1.15,skeinYards:o=220}=n,c=Ag(r),l=t.unit==="cm"?t.width/2.54:t.width,u=t.unit==="cm"?t.length/2.54:t.length,g=Math.ceil(l*s),m=Math.ceil(u*s),h=ut(e),v=h.length,y=[];for(const p of e.colors){const f=Te(p),j=(h.distribution[p]||0)/v,k=(u+20)/36,C=Math.ceil(g*j)*k,R=(l+2)/36,I=Math.ceil(m*j)*R,E=Math.ceil((C+I)*a),T=Math.ceil(E/c.yardsPer100g*100),D=Math.ceil(E/o);y.push({color:p,colorName:(f==null?void 0:f.name)||p,hex:(f==null?void 0:f.hex)||"#888888",warpYards:Math.ceil(C),weftYards:Math.ceil(I),totalYards:E,weightGrams:T,skeins:D})}const b=y.reduce((p,f)=>p+f.totalYards,0),x=y.reduce((p,f)=>p+f.weightGrams,0),d=y.reduce((p,f)=>p+f.skeins,0);return{sett:e,dimensions:t,yarnProfile:c,gauge:s,wasteMultiplier:a,requirements:y,totalYards:b,totalWeight:x,totalSkeins:d}}function $g(e,t,r){const n=Ig(t);if(!n)throw new Error(`Unknown product template: ${t}`);const s=(r==null?void 0:r.gauge)||n.recommendedGauge;return Bg(e,n.dimensions,n.recommendedYarnWeight,{gauge:s,...r})}function Dg(e){return[`Yarn Requirements for ${e.dimensions.width}${e.dimensions.unit}  ${e.dimensions.length}${e.dimensions.unit}`,`Yarn Weight: ${e.yarnProfile.weightClass}`,`Gauge: ${e.gauge} threads per inch`,`Waste Allowance: ${Math.round((e.wasteMultiplier-1)*100)}%`,"","By Color:",...e.requirements.map(r=>`  ${r.colorName} (${r.color}): ${r.totalYards} yards (${r.skeins} skeins, ${r.weightGrams}g)`),"",`Total: ${e.totalYards} yards / ${e.totalSkeins} skeins / ${e.totalWeight}g`].join(`
`)}function Gg(e,t,r="USD"){const n=e.requirements.map(a=>({color:a.colorName,cost:a.skeins*t})),s=n.reduce((a,o)=>a+o.cost,0);return{skeinCost:t,currency:r,colorCosts:n,totalYarnCost:s}}function ri(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function Kg(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function c(g){try{u(n.next(g))}catch(m){o(m)}}function l(g){try{u(n.throw(g))}catch(m){o(m)}}function u(g){g.done?a(g.value):s(g.value).then(c,l)}u((n=n.apply(e,t||[])).next())})}const Ug=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Wl extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Fg extends Wl{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class uu extends Wl{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class du extends Wl{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var $o;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})($o||($o={}));class Wg{constructor(t,{headers:r={},customFetch:n,region:s=$o.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=Ug(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Kg(this,arguments,void 0,function*(r,n={}){var s;let a,o;try{const{headers:c,method:l,body:u,signal:g,timeout:m}=n;let h={},{region:v}=n;v||(v=this.region);const y=new URL(`${this.url}/${r}`);v&&v!=="any"&&(h["x-region"]=v,y.searchParams.set("forceFunctionRegion",v));let b;u&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",b=u):typeof u=="string"?(h["Content-Type"]="text/plain",b=u):typeof FormData<"u"&&u instanceof FormData?b=u:(h["Content-Type"]="application/json",b=JSON.stringify(u)):u&&typeof u!="string"&&!(typeof Blob<"u"&&u instanceof Blob)&&!(u instanceof ArrayBuffer)&&!(typeof FormData<"u"&&u instanceof FormData)?b=JSON.stringify(u):b=u;let x=g;m&&(o=new AbortController,a=setTimeout(()=>o.abort(),m),g?(x=o.signal,g.addEventListener("abort",()=>o.abort())):x=o.signal);const d=yield this.fetch(y.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),c),body:b,signal:x}).catch(j=>{throw new Fg(j)}),p=d.headers.get("x-relay-error");if(p&&p==="true")throw new uu(d);if(!d.ok)throw new du(d);let f=((s=d.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),w;return f==="application/json"?w=yield d.json():f==="application/octet-stream"||f==="application/pdf"?w=yield d.blob():f==="text/event-stream"?w=d:f==="multipart/form-data"?w=yield d.formData():w=yield d.text(),{data:w,error:null,response:d}}catch(c){return{data:null,error:c,response:c instanceof du||c instanceof uu?c.context:void 0}}finally{a&&clearTimeout(a)}})}}var zg=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},Hg=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let o=null,c=null,l=null,u=a.status,g=a.statusText;if(a.ok){var m,h;if(r.method!=="HEAD"){var v;const d=await a.text();d===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((v=r.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?c=d:c=JSON.parse(d))}const b=(m=r.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),x=(h=a.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");b&&x&&x.length>1&&(l=parseInt(x[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(c)&&(c.length>1?(o={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,l=null,u=406,g="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var y;const b=await a.text();try{o=JSON.parse(b),Array.isArray(o)&&a.status===404&&(c=[],o=null,u=200,g="OK")}catch{a.status===404&&b===""?(u=204,g="No Content"):o={message:b}}if(o&&r.isMaybeSingle&&(!(o==null||(y=o.details)===null||y===void 0)&&y.includes("0 rows"))&&(o=null,u=200,g="OK"),o&&r.shouldThrowOnError)throw new zg(o)}return{error:o,data:c,count:l,status:u,statusText:g}});return this.shouldThrowOnError||(s=s.catch(a=>{var o;let c="";const l=a==null?void 0:a.cause;if(l){var u,g,m,h;const y=(u=l==null?void 0:l.message)!==null&&u!==void 0?u:"",b=(g=l==null?void 0:l.code)!==null&&g!==void 0?g:"";c=`${(m=a==null?void 0:a.name)!==null&&m!==void 0?m:"FetchError"}: ${a==null?void 0:a.message}`,c+=`

Caused by: ${(h=l==null?void 0:l.name)!==null&&h!==void 0?h:"Error"}: ${y}`,b&&(c+=` (${b})`),l!=null&&l.stack&&(c+=`
${l.stack}`)}else{var v;c=(v=a==null?void 0:a.stack)!==null&&v!==void 0?v:""}return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},Vg=class extends Hg{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:s=n}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:s=!1,format:a="text"}={}){var o;const c=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${l}"; options=${c};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const hu=new RegExp("[,()]");var Xr=class extends Vg{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&hu.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&hu.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let s="";n==="plain"?s="pl":n==="phrase"?s="ph":n==="websearch"&&(s="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},qg=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},s=r?"HEAD":"GET";let a=!1;const o=(e??"*").split("").map(u=>/\s/.test(u)&&!a?"":(u==='"'&&(a=!a),u)).join(""),{url:c,headers:l}=this.cloneRequestState();return c.searchParams.set("select",o),n&&l.append("Prefer",`count=${n}`),new Xr({method:s,url:c,headers:l,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const s="POST",{url:a,headers:o}=this.cloneRequestState();if(t&&o.append("Prefer",`count=${t}`),r||o.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(c.length>0){const l=[...new Set(c)].map(u=>`"${u}"`);a.searchParams.set("columns",l.join(","))}}return new Xr({method:s,url:a,headers:o,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){var a;const o="POST",{url:c,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&c.searchParams.set("on_conflict",t),n&&l.append("Prefer",`count=${n}`),s||l.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((g,m)=>g.concat(Object.keys(m)),[]);if(u.length>0){const g=[...new Set(u)].map(m=>`"${m}"`);c.searchParams.set("columns",g.join(","))}}return new Xr({method:o,url:c,headers:l,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:s,headers:a}=this.cloneRequestState();return t&&a.append("Prefer",`count=${t}`),new Xr({method:n,url:s,headers:a,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:s}=this.cloneRequestState();return e&&s.append("Prefer",`count=${e}`),new Xr({method:r,url:n,headers:s,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},Yg=class Xh{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new qg(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Xh(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:a}={}){var o;let c;const l=new URL(`${this.url}/rpc/${t}`);let u;const g=v=>v!==null&&typeof v=="object"&&(!Array.isArray(v)||v.some(g)),m=n&&Object.values(r).some(g);m?(c="POST",u=r):n||s?(c=n?"HEAD":"GET",Object.entries(r).filter(([v,y])=>y!==void 0).map(([v,y])=>[v,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([v,y])=>{l.searchParams.append(v,y)})):(c="POST",u=r);const h=new Headers(this.headers);return m?h.set("Prefer",a?`count=${a},return=minimal`:"return=minimal"):a&&h.set("Prefer",`count=${a}`),new Xr({method:c,url:l,headers:h,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class Qg{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const s=n.node,a=parseInt(s.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Jg="2.90.1",Xg=`realtime-js/${Jg}`,Zh="1.0.0",Zg="2.0.0",fu=Zh,Do=1e4,e0=1e3,t0=100;var nr;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(nr||(nr={}));var je;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(je||(je={}));var Et;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Et||(Et={}));var Go;(function(e){e.websocket="websocket"})(Go||(Go={}));var Rr;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Rr||(Rr={}));class r0{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const s=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var r,n;const s=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,n){var s,a;const o=t.topic,c=(s=t.ref)!==null&&s!==void 0?s:"",l=(a=t.join_ref)!==null&&a!==void 0?a:"",u=t.payload.event,g=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},m=Object.keys(g).length===0?"":JSON.stringify(g);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+c.length+o.length+u.length+m.length,v=new ArrayBuffer(this.HEADER_LENGTH+h);let y=new DataView(v),b=0;y.setUint8(b++,this.KINDS.userBroadcastPush),y.setUint8(b++,l.length),y.setUint8(b++,c.length),y.setUint8(b++,o.length),y.setUint8(b++,u.length),y.setUint8(b++,m.length),y.setUint8(b++,r),Array.from(l,d=>y.setUint8(b++,d.charCodeAt(0))),Array.from(c,d=>y.setUint8(b++,d.charCodeAt(0))),Array.from(o,d=>y.setUint8(b++,d.charCodeAt(0))),Array.from(u,d=>y.setUint8(b++,d.charCodeAt(0))),Array.from(m,d=>y.setUint8(b++,d.charCodeAt(0)));var x=new Uint8Array(v.byteLength+n.byteLength);return x.set(new Uint8Array(v),0),x.set(new Uint8Array(n),v.byteLength),x.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[s,a,o,c,l]=n;return r({join_ref:s,ref:a,topic:o,event:c,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),s=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,s)}}_decodeUserBroadcast(t,r,n){const s=r.getUint8(1),a=r.getUint8(2),o=r.getUint8(3),c=r.getUint8(4);let l=this.HEADER_LENGTH+4;const u=n.decode(t.slice(l,l+s));l=l+s;const g=n.decode(t.slice(l,l+a));l=l+a;const m=n.decode(t.slice(l,l+o));l=l+o;const h=t.slice(l,t.byteLength),v=c===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,y={type:this.BROADCAST_EVENT,event:g,payload:v};return o>0&&(y.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:y}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class ef{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var le;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(le||(le={}));const pu=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((a,o)=>(a[o]=n0(o,e,t,s),a),{}):{}},n0=(e,t,r,n)=>{const s=t.find(c=>c.name===e),a=s==null?void 0:s.type,o=r[e];return a&&!n.includes(a)?tf(a,o):Ko(o)},tf=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return o0(t,r)}switch(e){case le.bool:return s0(t);case le.float4:case le.float8:case le.int2:case le.int4:case le.int8:case le.numeric:case le.oid:return a0(t);case le.json:case le.jsonb:return i0(t);case le.timestamp:return l0(t);case le.abstime:case le.date:case le.daterange:case le.int4range:case le.int8range:case le.money:case le.reltime:case le.text:case le.time:case le.timestamptz:case le.timetz:case le.tsrange:case le.tstzrange:return Ko(t);default:return Ko(t)}},Ko=e=>e,s0=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},a0=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},i0=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},o0=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const o=e.slice(1,r);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(c=>tf(t,c))}return e},l0=e=>typeof e=="string"?e.replace(" ","T"):e,rf=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Pi{constructor(t,r,n={},s=Do){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var mu;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(mu||(mu={}));class ts{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ts.syncState(this.state,s,a,o),this.pendingDiffs.forEach(l=>{this.state=ts.syncDiff(this.state,l,a,o)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ts.syncDiff(this.state,s,a,o),c())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const a=this.cloneDeep(t),o=this.transformState(r),c={},l={};return this.map(a,(u,g)=>{o[u]||(l[u]=g)}),this.map(o,(u,g)=>{const m=a[u];if(m){const h=g.map(x=>x.presence_ref),v=m.map(x=>x.presence_ref),y=g.filter(x=>v.indexOf(x.presence_ref)<0),b=m.filter(x=>h.indexOf(x.presence_ref)<0);y.length>0&&(c[u]=y),b.length>0&&(l[u]=b)}else c[u]=g}),this.syncDiff(a,{joins:c,leaves:l},n,s)}static syncDiff(t,r,n,s){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(c,l)=>{var u;const g=(u=t[c])!==null&&u!==void 0?u:[];if(t[c]=this.cloneDeep(l),g.length>0){const m=t[c].map(v=>v.presence_ref),h=g.filter(v=>m.indexOf(v.presence_ref)<0);t[c].unshift(...h)}n(c,g,l)}),this.map(o,(c,l)=>{let u=t[c];if(!u)return;const g=l.map(m=>m.presence_ref);u=u.filter(m=>g.indexOf(m.presence_ref)<0),t[c]=u,s(c,u,l),u.length===0&&delete t[c]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var gu;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(gu||(gu={}));var rs;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(rs||(rs={}));var Ut;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ut||(Ut={}));class pn{constructor(t,r={config:{}},n){var s,a;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=je.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Pi(this,Et.join,this.params,this.timeout),this.rejoinTimer=new ef(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=je.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=je.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=je.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=je.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=je.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Et.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new ts(this),this.broadcastEndpointURL=rf(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==je.closed){const{config:{broadcast:o,presence:c,private:l}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(v=>v.filter))!==null&&s!==void 0?s:[],g=!!this.bindings[rs.PRESENCE]&&this.bindings[rs.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,m={},h={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:g}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(v=>t==null?void 0:t(Ut.CHANNEL_ERROR,v)),this._onClose(()=>t==null?void 0:t(Ut.CLOSED)),this.updateJoinPayload(Object.assign({config:h},m)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:v})=>{var y;if(this.socket._isManualToken()||this.socket.setAuth(),v===void 0){t==null||t(Ut.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,x=(y=b==null?void 0:b.length)!==null&&y!==void 0?y:0,d=[];for(let p=0;p<x;p++){const f=b[p],{filter:{event:w,schema:j,table:_,filter:k}}=f,S=v&&v[p];if(S&&S.event===w&&pn.isFilterValueEqual(S.schema,j)&&pn.isFilterValueEqual(S.table,_)&&pn.isFilterValueEqual(S.filter,k))d.push(Object.assign(Object.assign({},f),{id:S.id}));else{this.unsubscribe(),this.state=je.errored,t==null||t(Ut.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=d,t&&t(Ut.SUBSCRIBED);return}}).receive("error",v=>{this.state=je.errored,t==null||t(Ut.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Ut.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===je.joined&&t===rs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var s;if(r==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(c.status===202)return{success:!0};let l=c.statusText;try{const u=await c.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=t,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,c,l;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||l===void 0)&&l.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=je.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Et.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Pi(this,Et.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=je.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Pi(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>t0){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,a;const o=t.toLocaleLowerCase(),{close:c,error:l,leave:u,join:g}=Et;if(n&&[c,l,u,g].indexOf(o)>=0&&n!==this._joinRef())return;let h=this._onMessage(o,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var y,b,x;return((y=v.filter)===null||y===void 0?void 0:y.event)==="*"||((x=(b=v.filter)===null||b===void 0?void 0:b.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(v=>v.callback(h,n)):(a=this.bindings[o])===null||a===void 0||a.filter(v=>{var y,b,x,d,p,f,w,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const _=v.id,k=(y=v.filter)===null||y===void 0?void 0:y.event;return _&&((b=r.ids)===null||b===void 0?void 0:b.includes(_))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))&&(!(!((d=v.filter)===null||d===void 0)&&d.table)||v.filter.table===((p=r.data)===null||p===void 0?void 0:p.table))}else{const _=(w=(f=v==null?void 0:v.filter)===null||f===void 0?void 0:f.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return _==="*"||_===((j=r==null?void 0:r.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof h=="object"&&"ids"in h){const y=h.data,{schema:b,table:x,commit_timestamp:d,type:p,errors:f}=y;h=Object.assign(Object.assign({},{schema:b,table:x,commit_timestamp:d,eventType:p,new:{},old:{},errors:f}),this._getPayloadRecords(y))}v.callback(h,n)})}_isClosed(){return this.state===je.closed}_isJoined(){return this.state===je.joined}_isJoining(){return this.state===je.joining}_isLeaving(){return this.state===je.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&pn.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Et.close,{},t)}_onError(t){this._on(Et.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=je.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=pu(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=pu(t.columns,t.old_record)),r}}const Li=()=>{},Qs={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},c0=[1e3,2e3,5e3,1e4],u0=1e4,d0=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class h0{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Do,this.transport=null,this.heartbeatIntervalMs=Qs.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Li,this.ref=0,this.reconnectTimer=null,this.vsn=fu,this.logger=Li,this.conn=null,this.sendBuffer=[],this.serializer=new r0,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Go.websocket}`,this.httpEndpoint=rf(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Qg.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case nr.connecting:return Rr.Connecting;case nr.open:return Rr.Open;case nr.closing:return Rr.Closing;default:return Rr.Closed}}isConnected(){return this.connectionState()===Rr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new pn(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:s,ref:a}=t,o=()=>{this.encode(t,c=>{var l;(l=this.conn)===null||l===void 0||l.send(c)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(e0,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Qs.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const u=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",u)}catch(g){this.log("error","error in heartbeat callback",g)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:s,payload:a,ref:o}=r,c=o?`(${o})`:"",l=a.status||"";this.log("receive",`${l} ${n} ${s} ${c}`.trim(),a),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,a,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===nr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===nr.open||this.conn.readyState===nr.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Et.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([d0],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const a={access_token:r,version:Xg};r&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(Et.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new ef(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Qs.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,a,o,c,l,u,g,m,h,v;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Do,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:Qs.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=t==null?void 0:t.heartbeatCallback)!==null&&c!==void 0?c:Li,this.vsn=(l=t==null?void 0:t.vsn)!==null&&l!==void 0?l:fu,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:y=>c0[y-1]||u0,this.vsn){case Zh:this.encode=(g=t==null?void 0:t.encode)!==null&&g!==void 0?g:(y,b)=>b(JSON.stringify(y)),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:(y,b)=>b(JSON.parse(y));break;case Zg:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(v=t==null?void 0:t.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var ws=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function f0(e,t,r){const n=new URL(t,e);if(r)for(const[s,a]of Object.entries(r))a!==void 0&&n.searchParams.set(s,a);return n.toString()}async function p0(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function m0(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:s,body:a,headers:o}){const c=f0(e.baseUrl,n,s),l=await p0(e.auth),u=await t(c,{method:r,headers:{...a?{"Content-Type":"application/json"}:{},...l,...o},body:a?JSON.stringify(a):void 0}),g=await u.text(),m=(u.headers.get("content-type")||"").includes("application/json"),h=m&&g?JSON.parse(g):g;if(!u.ok){const v=m?h:void 0,y=v==null?void 0:v.error;throw new ws((y==null?void 0:y.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:y==null?void 0:y.type,icebergCode:y==null?void 0:y.code,details:v})}return{status:u.status,headers:u.headers,data:h}}}}function Js(e){return e.join("")}var g0=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Js(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Js(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Js(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Js(e.namespace)}`}),!0}catch(t){if(t instanceof ws&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof ws&&r.status===409)return;throw r}}};function zr(e){return e.join("")}var y0=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${zr(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${zr(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${zr(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${zr(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${zr(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${zr(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof ws&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof ws&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},v0=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=m0({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new g0(this.client,t),this.tableOps=new y0(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},ni=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function pe(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var x0=class extends ni{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Uo=class extends ni{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const zl=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),w0=()=>Response,Fo=e=>{if(Array.isArray(e))return e.map(r=>Fo(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=Fo(n)}),t},b0=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},k0=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function bs(e){"@babel/helpers - typeof";return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}function S0(e,t){if(bs(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _0(e){var t=S0(e,"string");return bs(t)=="symbol"?t:t+""}function j0(e,t,r){return(t=_0(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yu(Object(r),!0).forEach(function(n){j0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yu(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Oi=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},C0=async(e,t,r)=>{e instanceof await w0()&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const s=e.status||500,a=(n==null?void 0:n.statusCode)||s+"";t(new x0(Oi(n),s,a))}).catch(n=>{t(new Uo(Oi(n),n))}):t(new Uo(Oi(e),e))},N0=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(b0(n)?(s.headers=V({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),V(V({},s),r))};async function Ps(e,t,r,n,s,a){return new Promise((o,c)=>{e(r,N0(t,n,s,a)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>C0(l,c,n))})}async function ks(e,t,r,n){return Ps(e,"GET",t,r,n)}async function Nt(e,t,r,n,s){return Ps(e,"POST",t,n,s,r)}async function Wo(e,t,r,n,s){return Ps(e,"PUT",t,n,s,r)}async function R0(e,t,r,n){return Ps(e,"HEAD",t,V(V({},r),{},{noResolveJson:!0}),n)}async function Hl(e,t,r,n,s){return Ps(e,"DELETE",t,n,s,r)}var E0=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pe(t))return{data:null,error:t};throw t}}};let nf;nf=Symbol.toStringTag;var T0=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[nf]="BlobDownloadBuilder",this.promise=null}asStream(){return new E0(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pe(t))return{data:null,error:t};throw t}}};const P0={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},vu={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var L0=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=zl(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var s=this;try{let a;const o=V(V({},vu),n);let c=V(V({},s.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),l&&a.append("metadata",s.encodeMetadata(l)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),l&&!a.has("metadata")&&a.append("metadata",s.encodeMetadata(l))):(a=r,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,l&&(c["x-metadata"]=s.toBase64(s.encodeMetadata(l))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),n!=null&&n.headers&&(c=V(V({},c),n.headers));const u=s._removeEmptyFolders(t),g=s._getFinalPath(u),m=await(e=="PUT"?Wo:Nt)(s.fetch,`${s.url}/object/${g}`,a,V({headers:c},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:m.Id,fullPath:m.Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(pe(a))return{data:null,error:a};throw a}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var s=this;const a=s._removeEmptyFolders(e),o=s._getFinalPath(a),c=new URL(s.url+`/object/upload/sign/${o}`);c.searchParams.set("token",t);try{let l;const u=V({upsert:vu.upsert},n),g=V(V({},s.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,g["cache-control"]=`max-age=${u.cacheControl}`,g["content-type"]=u.contentType),{data:{path:a,fullPath:(await Wo(s.fetch,c.toString(),l,{headers:g})).Key},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(pe(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const s=V({},r.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const a=await Nt(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(r.url+a.url),c=o.searchParams.get("token");if(!c)throw new ni("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:c},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await Nt(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}}async copy(e,t,r){var n=this;try{return{data:{path:(await Nt(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}}async createSignedUrl(e,t,r){var n=this;try{let s=n._getFinalPath(e),a=await Nt(n.fetch,`${n.url}/object/sign/${s}`,V({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${n.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}}async createSignedUrls(e,t,r){var n=this;try{const s=await Nt(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>V(V({},o),{},{signedUrl:o.signedURL?encodeURI(`${n.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),s=n?`?${n}`:"",a=this._getFinalPath(e),o=()=>ks(this.fetch,`${this.url}/${r}/${a}${s}`,{headers:this.headers,noResolveJson:!0});return new T0(o,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:Fo(await ks(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await R0(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(pe(n)&&n instanceof Uo){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&n.push(s);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});o!==""&&n.push(o);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}async remove(e){var t=this;try{return{data:await Hl(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const s=V(V(V({},P0),t),{},{prefix:e||""});return{data:await Nt(n.fetch,`${n.url}/object/list/${n.bucketId}`,s,{headers:n.headers},r),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}}async listV2(e,t){var r=this;try{const n=V({},e);return{data:await Nt(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const sf="2.90.1",af={"X-Client-Info":`storage-js/${sf}`};var O0=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const s=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=V(V({},af),t),this.fetch=zl(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await ks(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await ks(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Nt(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await Wo(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await Nt(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Hl(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},M0=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=V(V({},af),t),this.fetch=zl(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Nt(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),s=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await ks(t.fetch,s,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Hl(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!k0(e))throw new ni("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new v0({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(s,a){const o=s[a];return typeof o!="function"?o:async(...c)=>{try{return{data:await o.apply(s,c),error:null}}catch(l){if(n)throw l;return{data:null,error:l}}}}})}};const Vl={"X-Client-Info":`storage-js/${sf}`,"Content-Type":"application/json"};var of=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function at(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Mi=class extends of{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},A0=class extends of{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const ql=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),I0=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},xu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),B0=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,s=e;if(typeof s.json=="function")s.json().then(a=>{const o=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||n+"";t(new Mi(xu(a),n,o))}).catch(()=>{const a=n+"";t(new Mi(s.statusText||`HTTP ${n} error`,n,a))});else{const a=n+"";t(new Mi(s.statusText||`HTTP ${n} error`,n,a))}}else t(new A0(xu(e),e))},$0=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(I0(n)?(s.headers=V({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,V(V({},s),r)):s};async function D0(e,t,r,n,s,a){return new Promise((o,c)=>{e(r,$0(t,n,s,a)).then(l=>{if(!l.ok)throw l;if(n!=null&&n.noResolveJson)return l;const u=l.headers.get("content-type");return!u||!u.includes("application/json")?{}:l.json()}).then(l=>o(l)).catch(l=>B0(l,c,n))})}async function it(e,t,r,n,s){return D0(e,"POST",t,n,s,r)}var G0=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=V(V({},Vl),t),this.fetch=ql(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await it(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(at(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await it(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(at(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await it(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(at(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await it(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(at(n))return{data:null,error:n};throw n}}},K0=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=V(V({},Vl),t),this.fetch=ql(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await it(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(at(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await it(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(at(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await it(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(at(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await it(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(at(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await it(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(at(r))return{data:null,error:r};throw r}}},U0=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=V(V({},Vl),t),this.fetch=ql(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await it(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(at(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await it(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(at(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await it(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(at(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await it(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(at(r))return{data:null,error:r};throw r}}},F0=class extends U0{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new W0(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},W0=class extends G0{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,V(V({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,V(V({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new z0(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},z0=class extends K0{constructor(e,t,r,n,s){super(e,t,s),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,V(V({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,V(V({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,V(V({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,V(V({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,V(V({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},H0=class extends O0{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new L0(this.url,this.headers,e,this.fetch)}get vectors(){return new F0(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new M0(this.url+"/iceberg",this.headers,this.fetch)}};const lf="2.90.1",Zr=30*1e3,zo=3,Ai=zo*Zr,V0="http://localhost:9999",q0="supabase.auth.token",Y0={"X-Client-Info":`gotrue-js/${lf}`},Ho="X-Supabase-Api-Version",cf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Q0=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,J0=10*60*1e3;class Ss extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function F(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class X0 extends Ss{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Z0(e){return F(e)&&e.name==="AuthApiError"}class Er extends Ss{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Xt extends Ss{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class rt extends Xt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ey(e){return F(e)&&e.name==="AuthSessionMissingError"}class Hr extends Xt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Xs extends Xt{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Zs extends Xt{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ty(e){return F(e)&&e.name==="AuthImplicitGrantRedirectError"}class wu extends Xt{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ry extends Xt{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Vo extends Xt{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Ii(e){return F(e)&&e.name==="AuthRetryableFetchError"}class bu extends Xt{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class qo extends Xt{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ba="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ku=` 	
\r=`.split(""),ny=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ku.length;t+=1)e[ku[t].charCodeAt(0)]=-2;for(let t=0;t<Ba.length;t+=1)e[Ba[t].charCodeAt(0)]=t;return e})();function Su(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ba[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ba[n]),t.queuedBits-=6}}function uf(e,t,r){const n=ny[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function _u(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{iy(o,n,r)};for(let o=0;o<e.length;o+=1)uf(e.charCodeAt(o),s,a);return t.join("")}function sy(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function ay(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}sy(n,t)}}function iy(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function kn(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)uf(e.charCodeAt(s),r,n);return new Uint8Array(t)}function oy(e){const t=[];return ay(e,r=>t.push(r)),new Uint8Array(t)}function Or(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>Su(s,r,n)),Su(null,r,n),t.join("")}function ly(e){return Math.round(Date.now()/1e3)+e}function cy(){return Symbol("auth-callback")}const Me=()=>typeof window<"u"&&typeof document<"u",kr={tested:!1,writable:!1},df=()=>{if(!Me())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(kr.tested)return kr.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),kr.tested=!0,kr.writable=!0}catch{kr.tested=!0,kr.writable=!1}return kr.writable};function uy(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const hf=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),dy=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",en=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Sr=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Oe=async(e,t)=>{await e.removeItem(t)};class si{constructor(){this.promise=new si.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}si.promiseConstructor=Promise;function Bi(e){const t=e.split(".");if(t.length!==3)throw new qo("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Q0.test(t[n]))throw new qo("JWT not in base64url format");return{header:JSON.parse(_u(t[0])),payload:JSON.parse(_u(t[1])),signature:kn(t[2]),raw:{header:t[0],payload:t[1]}}}async function hy(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function fy(e,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await e(a);if(!t(a,null,o)){n(o);return}}catch(o){if(!t(a,o)){s(o);return}}})()})}function py(e){return("0"+e.toString(16)).substr(-2)}function my(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,py).join("")}async function gy(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function yy(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await gy(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Vr(e,t,r=!1){const n=my();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await en(e,`${t}-code-verifier`,s);const a=await yy(n);return[a,n===a?"plain":"s256"]}const vy=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function xy(e){const t=e.headers.get(Ho);if(!t||!t.match(vy))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function wy(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function by(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ky=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function qr(e){if(!ky.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function $i(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Sy(e,t){return new Proxy(e,{get:(r,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,s)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,s)}})}function ju(e){return JSON.parse(JSON.stringify(e))}const Nr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),_y=[502,503,504];async function Cu(e){var t;if(!dy(e))throw new Vo(Nr(e),0);if(_y.includes(e.status))throw new Vo(Nr(e),e.status);let r;try{r=await e.json()}catch(a){throw new Er(Nr(a),a)}let n;const s=xy(e);if(s&&s.getTime()>=cf["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new bu(Nr(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new rt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new bu(Nr(r),e.status,r.weak_password.reasons);throw new X0(Nr(r),e.status||500,n)}const jy=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function H(e,t,r,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[Ho]||(a[Ho]=cf["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Cy(e,t,r+c,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function Cy(e,t,r,n,s,a){const o=jy(t,n,s,a);let c;try{c=await e(r,Object.assign({},o))}catch(l){throw console.error(l),new Vo(Nr(l),0)}if(c.ok||await Cu(c),n!=null&&n.noResolveJson)return c;try{return await c.json()}catch(l){await Cu(l)}}function jt(e){var t;let r=null;Ey(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=ly(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Nu(e){const t=jt(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ir(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Ny(e){return{data:e,error:null}}function Ry(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e,o=ri(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},l=Object.assign({},o);return{data:{properties:c,user:l},error:null}}function Ru(e){return e}function Ey(e){return e.access_token&&e.refresh_token&&e.expires_in}const Di=["global","local","others"];class Ty{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=hf(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Di[0]){if(Di.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Di.join(", ")}`);try{return await H(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(F(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await H(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ir})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=ri(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await H(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Ry,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(F(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await H(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ir})}catch(r){if(F(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,a,o,c,l;try{const u={nextPage:null,lastPage:0,total:0},g=await H(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:Ru});if(g.error)throw g.error;const m=await g.json(),h=(o=g.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(l=(c=g.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&l!==void 0?l:[];return v.length>0&&(v.forEach(y=>{const b=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(y.split(";")[1].split("=")[1]);u[`${x}Page`]=b}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(F(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){qr(t);try{return await H(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ir})}catch(r){if(F(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){qr(t);try{return await H(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ir})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){qr(t);try{return await H(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ir})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){qr(t.userId);try{const{data:r,error:n}=await H(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(F(r))return{data:null,error:r};throw r}}async _deleteFactor(t){qr(t.userId),qr(t.id);try{return{data:await H(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(F(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,s,a,o,c,l;try{const u={nextPage:null,lastPage:0,total:0},g=await H(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:Ru});if(g.error)throw g.error;const m=await g.json(),h=(o=g.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(l=(c=g.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&l!==void 0?l:[];return v.length>0&&(v.forEach(y=>{const b=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(y.split(";")[1].split("=")[1]);u[`${x}Page`]=b}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(F(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await H(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(F(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await H(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(F(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await H(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await H(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(F(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await H(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(F(r))return{data:null,error:r};throw r}}}function Eu(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Yr={debug:!!(globalThis&&df()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ff extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Py extends ff{}async function Ly(e,t,r){Yr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Yr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Yr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Yr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Yr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Py(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Yr.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Oy(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function pf(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function My(e){return parseInt(e,16)}function Ay(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function Iy(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:a=new Date,nonce:o,notBefore:c,requestId:l,resources:u,scheme:g,uri:m,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const v=pf(e.address),y=g?`${g}://${n}`:n,b=e.statement?`${e.statement}
`:"",x=`${y} wants you to sign in with your Ethereum account:
${v}

${b}`;let d=`URI: ${m}
Version: ${h}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(s&&(d+=`
Expiration Time: ${s.toISOString()}`),c&&(d+=`
Not Before: ${c.toISOString()}`),l&&(d+=`
Request ID: ${l}`),u){let p=`
Resources:`;for(const f of u){if(!f||typeof f!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${f}`);p+=`
- ${f}`}d+=p}return`${x}
${d}`}class Se extends Error{constructor({message:t,code:r,cause:n,name:s}){var a;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=s??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class $a extends Se{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function By({error:e,options:t}){var r,n,s;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Se({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Se({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Se({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Se({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Se({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Se({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Se({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Se({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(mf(o)){if(a.rp.id!==o)return new Se({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Se({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Se({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Se({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Se({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function $y({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Se({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Se({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(mf(n)){if(r.rpId!==n)return new Se({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Se({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Se({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Se({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class Dy{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const Gy=new Dy;function Ky(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=ri(e,["challenge","user","excludeCredentials"]),a=kn(t).buffer,o=Object.assign(Object.assign({},r),{id:kn(r.id).buffer}),c=Object.assign(Object.assign({},s),{challenge:a,user:o});if(n&&n.length>0){c.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const u=n[l];c.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:kn(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return c}function Uy(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=ri(e,["challenge","allowCredentials"]),s=kn(t).buffer,a=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const c=r[o];a.allowCredentials[o]=Object.assign(Object.assign({},c),{id:kn(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function Fy(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Or(new Uint8Array(e.response.attestationObject)),clientDataJSON:Or(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Wy(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Or(new Uint8Array(s.authenticatorData)),clientDataJSON:Or(new Uint8Array(s.clientDataJSON)),signature:Or(new Uint8Array(s.signature)),userHandle:s.userHandle?Or(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function mf(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Tu(){var e,t;return!!(Me()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function zy(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new $a("Browser returned unexpected credential type",t)}:{data:null,error:new $a("Empty credential response",t)}}catch(t){return{data:null,error:By({error:t,options:e})}}}async function Hy(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new $a("Browser returned unexpected credential type",t)}:{data:null,error:new $a("Empty credential response",t)}}catch(t){return{data:null,error:$y({error:t,options:e})}}}const Vy={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},qy={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Da(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of e)if(s)for(const a in s){const o=s[a];if(o!==void 0)if(Array.isArray(o))n[a]=o;else if(r(o))n[a]=o;else if(t(o)){const c=n[a];t(c)?n[a]=Da(c,o):n[a]=Da(o)}else n[a]=o}return n}function Yy(e,t){return Da(Vy,e,t||{})}function Qy(e,t){return Da(qy,e,t||{})}class Jy{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:s},a){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:c};const l=s??Gy.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=Yy(o.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:g,error:m}=await zy({publicKey:u,signal:l});return g?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:g}},error:null}:{data:null,error:m}}case"request":{const u=Qy(o.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:g,error:m}=await Hy(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:l}));return g?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:g}},error:null}:{data:null,error:m}}}}catch(o){return F(o)?{data:null,error:o}:{data:null,error:new Er("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!r)return{data:null,error:new Ss("rpId is required for WebAuthn authentication")};try{if(!Tu())return{data:null,error:new Er("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:a});if(!o)return{data:null,error:c};const{webauthn:l}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(o){return F(o)?{data:null,error:o}:{data:null,error:new Er("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!r)return{data:null,error:new Ss("rpId is required for WebAuthn registration")};try{if(!Tu())return{data:null,error:new Er("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(g=>{var m;return(m=g.data)===null||m===void 0?void 0:m.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g==null?void 0:g.id}):void 0),{data:null,error:c};const{data:l,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:a});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(o){return F(o)?{data:null,error:o}:{data:null,error:new Er("Unexpected error in register",o)}}}}Oy();const Xy={url:V0,storageKey:q0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Y0,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Pu(e,t,r){return await r()}const Qr={};class _s{get jwks(){var t,r;return(r=(t=Qr[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Qr[this.storageKey]=Object.assign(Object.assign({},Qr[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Qr[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Qr[this.storageKey]=Object.assign(Object.assign({},Qr[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},Xy),t);if(this.storageKey=a.storageKey,this.instanceID=(r=_s.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,_s.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&Me()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Ty({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=hf(a.fetch),this.lock=a.lock||Pu,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&Me()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Ly:this.lock=Pu,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Jy(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:df()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Eu(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Eu(this.memoryStorage)),Me()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${lf}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(Me()&&(r=uy(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),Me()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),ty(a)){const l=(t=a.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:a}}return{error:a}}const{session:o,redirectType:c}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return F(r)?this._returnResult({error:r}):this._returnResult({error:new Er("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const a=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:jt}),{data:o,error:c}=a;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(a){if(F(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,n,s;try{let a;if("email"in t){const{email:g,password:m,options:h}=t;let v=null,y=null;this.flowType==="pkce"&&([v,y]=await Vr(this.storage,this.storageKey)),a=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:g,password:m,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:v,code_challenge_method:y},xform:jt})}else if("phone"in t){const{phone:g,password:m,options:h}=t;a=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:m,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:jt})}else throw new Xs("You must provide either an email or phone number and a password");const{data:o,error:c}=a;if(c||!o)return await Oe(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(a){if(await Oe(this.storage,`${this.storageKey}-code-verifier`),F(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:o,options:c}=t;r=await H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:Nu})}else if("phone"in t){const{phone:a,password:o,options:c}=t;r=await H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:Nu})}else throw new Xs("You must provide either an email or phone number and a password");const{data:n,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const a=new Hr;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(F(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,a,o,c,l,u,g,m,h;let v,y;if("message"in t)v=t.message,y=t.signature;else{const{chain:b,wallet:x,statement:d,options:p}=t;let f;if(Me())if(typeof x=="object")f=x;else{const C=window;if("ethereum"in C&&typeof C.ethereum=="object"&&"request"in C.ethereum&&typeof C.ethereum.request=="function")f=C.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");f=x}const w=new URL((r=p==null?void 0:p.url)!==null&&r!==void 0?r:window.location.href),j=await f.request({method:"eth_requestAccounts"}).then(C=>C).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!j||j.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=pf(j[0]);let k=(n=p==null?void 0:p.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!k){const C=await f.request({method:"eth_chainId"});k=My(C)}const S={domain:w.host,address:_,statement:d,uri:w.href,version:"1",chainId:k,nonce:(s=p==null?void 0:p.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(a=p==null?void 0:p.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=p==null?void 0:p.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(l=p==null?void 0:p.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=p==null?void 0:p.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(g=p==null?void 0:p.signInWithEthereum)===null||g===void 0?void 0:g.resources};v=Iy(S),y=await f.request({method:"personal_sign",params:[Ay(v),_]})}try{const{data:b,error:x}=await H(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:y},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:jt});if(x)throw x;if(!b||!b.session||!b.user){const d=new Hr;return this._returnResult({data:{user:null,session:null},error:d})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:x})}catch(b){if(F(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async signInWithSolana(t){var r,n,s,a,o,c,l,u,g,m,h,v;let y,b;if("message"in t)y=t.message,b=t.signature;else{const{chain:x,wallet:d,statement:p,options:f}=t;let w;if(Me())if(typeof d=="object")w=d;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))w=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof d!="object"||!(f!=null&&f.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=d}const j=new URL((r=f==null?void 0:f.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const _=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},f==null?void 0:f.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),p?{statement:p}:null));let k;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")k=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)k=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)y=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),b=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${j.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(s=(n=f==null?void 0:f.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=f==null?void 0:f.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${f.signInWithSolana.notBefore}`]:[],...!((o=f==null?void 0:f.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${f.signInWithSolana.expirationTime}`]:[],...!((c=f==null?void 0:f.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${f.signInWithSolana.chainId}`]:[],...!((l=f==null?void 0:f.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${f.signInWithSolana.nonce}`]:[],...!((u=f==null?void 0:f.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${f.signInWithSolana.requestId}`]:[],...!((m=(g=f==null?void 0:f.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||m===void 0)&&m.length?["Resources",...f.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const _=await w.signMessage(new TextEncoder().encode(y),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=_}}try{const{data:x,error:d}=await H(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:Or(b)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:jt});if(d)throw d;if(!x||!x.session||!x.user){const p=new Hr;return this._returnResult({data:{user:null,session:null},error:p})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:d})}catch(x){if(F(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(t){const r=await Sr(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new ry;const{data:a,error:o}=await H(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:jt});if(await Oe(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const c=new Hr;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(await Oe(this.storage,`${this.storageKey}-code-verifier`),F(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:a,nonce:o}=t,c=await H(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:jt}),{data:l,error:u}=c;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const g=new Hr;return this._returnResult({data:{user:null,session:null},error:g})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(r){if(F(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,s,a,o;try{if("email"in t){const{email:c,options:l}=t;let u=null,g=null;this.flowType==="pkce"&&([u,g]=await Vr(this.storage,this.storageKey));const{error:m}=await H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:g},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in t){const{phone:c,options:l}=t,{data:u,error:g}=await H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(a=l==null?void 0:l.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:g})}throw new Xs("You must provide either an email or phone number.")}catch(c){if(await Oe(this.storage,`${this.storageKey}-code-verifier`),F(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(t){var r,n;try{let s,a;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:c}=await H(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:jt});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(s){if(F(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,n,s,a,o;try{let c=null,l=null;this.flowType==="pkce"&&([c,l]=await Vr(this.storage,this.storageKey));const u=await H(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:l}),headers:this.headers,xform:Ny});return!((a=u.data)===null||a===void 0)&&a.url&&Me()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(c){if(await Oe(this.storage,`${this.storageKey}-code-verifier`),F(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new rt;const{error:s}=await H(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(F(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:o}=await H(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:o,error:c}=await H(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:c})}throw new Xs("You must provide either an email or phone number and a type")}catch(r){if(F(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Sr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Ai:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await Sr(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=$i()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=Sy(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ir}):await this._useSession(async r=>{var n,s,a;const{data:o,error:c}=r;if(c)throw c;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new rt}:await H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:ir})})}catch(r){if(F(r))return ey(r)&&(await this._removeSession(),await Oe(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new rt;const o=s.session;let c=null,l=null;this.flowType==="pkce"&&t.email!=null&&([c,l]=await Vr(this.storage,this.storageKey));const{data:u,error:g}=await H(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:l}),jwt:o.access_token,xform:ir});if(g)throw g;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await Oe(this.storage,`${this.storageKey}-code-verifier`),F(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new rt;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:o}=Bi(t.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{data:c,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!c)return{data:{user:null,session:null},error:null};a=c}else{const{data:c,error:l}=await this._getUser(t.access_token);if(l)throw l;a={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(F(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:c}=r;if(c)throw c;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new rt;const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(F(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!Me())throw new Zs("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Zs(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new wu("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Zs("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new wu("No code detected.");const{data:p,error:f}=await this._exchangeCodeForSession(t.code);if(f)throw f;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:p.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:c,expires_at:l,token_type:u}=t;if(!a||!c||!o||!u)throw new Zs("No session defined in URL");const g=Math.round(Date.now()/1e3),m=parseInt(c);let h=g+m;l&&(h=parseInt(l));const v=h-g;v*1e3<=Zr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${m}s`);const y=h-m;g-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,h,g):g-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,h,g);const{data:b,error:x}=await this._getUser(a);if(x)throw x;const d={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:m,expires_at:h,refresh_token:o,token_type:u,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:d,redirectType:t.type},error:null})}catch(n){if(F(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Sr(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({error:a});const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:c}=await this.admin.signOut(o,t);if(c&&!(Z0(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return t!=="others"&&(await this._removeSession(),await Oe(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=cy(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Vr(this.storage,this.storageKey,!0));try{return await H(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(await Oe(this.storage,`${this.storageKey}-code-verifier`),F(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(F(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var o,c,l,u,g;const{data:m,error:h}=a;if(h)throw h;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await H(this.fetch,"GET",v,{headers:this.headers,jwt:(g=(u=m.session)===null||u===void 0?void 0:u.access_token)!==null&&g!==void 0?g:void 0})});if(s)throw s;return Me()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(F(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:a}}=r;if(s)throw s;const{options:o,provider:c,token:l,access_token:u,nonce:g}=t,m=await H(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:c,id_token:l,access_token:u,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:jt}),{data:h,error:v}=m;return v?this._returnResult({data:{user:null,session:null},error:v}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Hr}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:v}))}catch(s){if(await Oe(this.storage,`${this.storageKey}-code-verifier`),F(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)throw o;return await H(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(F(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await fy(async s=>(s>0&&await hy(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await H(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:jt})),(s,a)=>{const o=200*Math.pow(2,s);return a&&Ii(a)&&Date.now()+o-n<Zr})}catch(n){if(this._debug(r,"error",n),F(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Me()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Sr(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Sr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await en(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:$i()}else if(s&&!s.user&&!s.user){const o=await Sr(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await Oe(this.storage,this.storageKey+"-user"),await en(this.storage,this.storageKey,s)):s.user=$i()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ai;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${Ai}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Ii(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(s.access_token);!c&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new rt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new si;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new rt;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const c={data:a.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(a){if(this._debug(s,"error",a),F(a)){const o={data:null,error:a};return Ii(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,r)}catch(l){a.push(l)}});if(await Promise.all(o),a.length>0){for(let c=0;c<a.length;c+=1)console.error(a[c]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Oe(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await en(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=ju(s);await en(this.storage,this.storageKey,a)}else{const s=ju(r);await en(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Oe(this.storage,this.storageKey),await Oe(this.storage,this.storageKey+"-code-verifier"),await Oe(this.storage,this.storageKey+"-user"),this.userStorage&&await Oe(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Me()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Zr);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Zr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Zr}ms, refresh threshold is ${zo} ticks`),s<=zo&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof ff)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Me()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await Vr(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(c.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?this._returnResult({data:null,error:a}):await H(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(F(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:u}=await H(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&l.type==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(F(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Fy(t.webauthn.credential_response):Wy(t.webauthn.credential_response)})}:{code:t.code}),{data:c,error:l}=await H(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:l}))})}catch(r){if(F(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=await H(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:Ky(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:Uy(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(F(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Bi(n.access_token);let o=null;a.aal&&(o=a.aal);let c=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await H(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new rt})})}catch(r){if(F(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new rt});const o=await H(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&Me()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(F(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new rt});const o=await H(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&Me()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(F(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await H(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new rt})})}catch(t){if(F(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?(await H(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new rt})})}catch(r){if(F(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(c=>c.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(c=>c.kid===t),n&&this.jwks_cached_at+J0>s)return n;const{data:a,error:o}=await H(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(c=>c.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:v,error:y}=await this.getSession();if(y||!v.session)return this._returnResult({data:null,error:y});n=v.session.access_token}const{header:s,payload:a,signature:o,raw:{header:c,payload:l}}=Bi(n);r!=null&&r.allowExpired||wy(a.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:a,header:s,signature:o},error:null}}const g=by(s.alg),m=await crypto.subtle.importKey("jwk",u,g,!0,["verify"]);if(!await crypto.subtle.verify(g,m,o,oy(`${c}.${l}`)))throw new qo("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(n){if(F(n))return this._returnResult({data:null,error:n});throw n}}}_s.nextInstanceID={};const Zy=_s,ev="2.90.1";let zn="";typeof Deno<"u"?zn="deno":typeof document<"u"?zn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?zn="react-native":zn="node";const tv={"X-Client-Info":`supabase-js-${zn}/${ev}`},rv={headers:tv},nv={schema:"public"},sv={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},av={};function js(e){"@babel/helpers - typeof";return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(e)}function iv(e,t){if(js(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(js(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ov(e){var t=iv(e,"string");return js(t)=="symbol"?t:t+""}function lv(e,t,r){return(t=ov(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function xe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lu(Object(r),!0).forEach(function(n){lv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lu(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const cv=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),uv=()=>Headers,dv=(e,t,r)=>{const n=cv(r),s=uv();return async(a,o)=>{var c;const l=(c=await t())!==null&&c!==void 0?c:e;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(a,xe(xe({},o),{},{headers:u}))}};function hv(e){return e.endsWith("/")?e:e+"/"}function fv(e,t){var r,n;const{db:s,auth:a,realtime:o,global:c}=e,{db:l,auth:u,realtime:g,global:m}=t,h={db:xe(xe({},l),s),auth:xe(xe({},u),a),realtime:xe(xe({},g),o),storage:{},global:xe(xe(xe({},m),c),{},{headers:xe(xe({},(r=m==null?void 0:m.headers)!==null&&r!==void 0?r:{}),(n=c==null?void 0:c.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function pv(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(hv(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var mv=class extends Zy{constructor(e){super(e)}},gv=class{constructor(e,t,r){var n,s;this.supabaseUrl=e,this.supabaseKey=t;const a=pv(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const o=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:nv,realtime:av,auth:xe(xe({},sv),{},{storageKey:o}),global:rv},l=fv(r??{},c);if(this.storageKey=(n=l.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=l.global.headers)!==null&&s!==void 0?s:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(g,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=l.auth)!==null&&u!==void 0?u:{},this.headers,l.global.fetch)}this.fetch=dv(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(xe({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new Yg(new URL("rest/v1",a).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new H0(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new Wg(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,storageKey:a,flowType:o,lock:c,debug:l,throwOnError:u},g,m){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new mv({url:this.authUrl.href,headers:xe(xe({},h),g),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,flowType:o,lock:c,debug:l,throwOnError:u,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new h0(this.realtimeUrl.href,xe(xe({},e),{},{params:xe(xe({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const yv=(e,t,r)=>new gv(e,t,r);function vv(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}vv()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const xv="https://psugfpgljtmwbngqwcze.supabase.co",wv="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBzdWdmcGdsanRtd2JuZ3F3Y3plIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3NjUyNDcsImV4cCI6MjA4NDM0MTI0N30.AkjIBzgPOFOogBnBvv7kShi25QWLCVqVICFvNOxRgi8",er=yv(xv,wv),bv=()=>!!er,gf=N.createContext({user:null,session:null,loading:!0,isConfigured:!1,signInWithGoogle:async()=>{},signOut:async()=>{}});function kv({children:e}){const[t,r]=N.useState(null),[n,s]=N.useState(null),[a,o]=N.useState(!0),c=bv();N.useEffect(()=>{if(!er){o(!1);return}er.auth.getSession().then(({data:{session:m}})=>{s(m),r((m==null?void 0:m.user)??null),o(!1)});const{data:{subscription:g}}=er.auth.onAuthStateChange((m,h)=>{s(h),r((h==null?void 0:h.user)??null)});return()=>g.unsubscribe()},[]);const l=async()=>{if(!er){console.error("Supabase not configured");return}const{error:g}=await er.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});if(g)throw console.error("Sign in error:",g),g},u=async()=>{if(!er)return;const{error:g}=await er.auth.signOut();if(g)throw console.error("Sign out error:",g),g};return i.jsx(gf.Provider,{value:{user:t,session:n,loading:a,isConfigured:c,signInWithGoogle:l,signOut:u},children:e})}const Sv=()=>{const e=N.useContext(gf);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},Jr={maxColors:6,weaveType:"twill-2-2",fabrics:[{code:"CTRV",name:"Reiver",weight:"10oz",width:'59"',use:"Jackets, ties, dresses"},{code:"CTBR",name:"Braeriach",weight:"13oz",width:'54"',use:"Kilts, trews, bags"},{code:"CTST",name:"Strome",weight:"16oz",width:'54"',use:"Heavy kilts, upholstery"}]},nt={swatch:{repeats:1,name:"Swatch",inches:'~6"'},pocket:{repeats:2,name:"Pocket Square",inches:'~10"'},tie:{repeats:3,name:"Tie",inches:'~3.5"'},scarf:{repeats:4,name:"Scarf",inches:'~12"'},kilt:{repeats:6,name:"Kilt Panel",inches:'~24"'},blanket:{repeats:8,name:"Blanket",inches:'~48"'}},Ou={jacquard:{name:"Jacquard Woven",description:"Woven directly into fabric - most authentic",minTPI:60,maxTPI:120,minDetail:1.5,warning:"Jacquard weaving creates a pixelated look. Best for simple, bold designs.",isTraditional:!0},embroidery:{name:"Embroidery",description:"Stitched on top of woven tartan - high detail",minTPI:200,maxTPI:1200,minDetail:.5,warning:"Embroidery is added after weaving. Not part of the tartan pattern itself.",isTraditional:!1},print:{name:"Digital Print",description:"Printed on fabric - photographic quality",minTPI:150,maxTPI:600,minDetail:.25,warning:"Digital printing is not woven. Produces printed fabric, not tartan.",isTraditional:!1}},Mu={circle:{name:"Circle",svg:e=>`M ${e/2} 0 A ${e/2} ${e/2} 0 1 0 ${e/2} ${e} A ${e/2} ${e/2} 0 1 0 ${e/2} 0`},diamond:{name:"Diamond",svg:e=>`M ${e/2} 0 L ${e} ${e/2} L ${e/2} ${e} L 0 ${e/2} Z`},shield:{name:"Shield",svg:e=>`M ${e*.1} ${e*.1} L ${e*.9} ${e*.1} L ${e*.9} ${e*.5} Q ${e*.9} ${e*.9} ${e*.5} ${e} Q ${e*.1} ${e*.9} ${e*.1} ${e*.5} Z`},square:{name:"Square",svg:e=>`M 0 0 L ${e} 0 L ${e} ${e} L 0 ${e} Z`}},Au={all:{name:"All Colors",colors:Object.keys(yt),description:"Full 48-color palette",category:"Full"},royalStewart:{name:"Royal Stewart",colors:["R","CR","B","Y","K","W","G"],description:"The official tartan of the Royal House of Stewart",category:"Clan"},blackWatch:{name:"Black Watch",colors:["DB","NB","DG","HG","K","B","G"],description:"Military regiment tartan (42nd Highland)",category:"Clan"},campbell:{name:"Campbell",colors:["DG","B","K","Y","W","G","NB"],description:"Clan Campbell of Argyll",category:"Clan"},macleod:{name:"MacLeod",colors:["Y","K","R","GD","DR"],description:"Clan MacLeod - distinctive yellow",category:"Clan"},macdonald:{name:"MacDonald",colors:["R","DG","B","K","G","NB"],description:"Clan Donald - Lords of the Isles",category:"Clan"},gordon:{name:"Gordon",colors:["DG","NB","Y","K","W","G","B"],description:"Clan Gordon of Aberdeenshire",category:"Clan"},fraser:{name:"Fraser",colors:["R","DG","W","NB","G","K"],description:"Clan Fraser of Lovat",category:"Clan"},buchanan:{name:"Buchanan",colors:["Y","R","DG","W","K","GD"],description:"Clan Buchanan - yellow and green",category:"Clan"},cameron:{name:"Cameron",colors:["R","DG","Y","K","G"],description:"Clan Cameron of Lochiel",category:"Clan"},douglas:{name:"Douglas",colors:["DG","B","GY","K","W"],description:"Clan Douglas - Grey Douglas",category:"Clan"},burberry:{name:"Burberry Style",colors:["TN","K","R","W","CB"],description:"Classic British check inspired",category:"Fashion"},gingham:{name:"Gingham",colors:["W","B","R","K"],description:"Simple two-tone checks",category:"Fashion"},madras:{name:"Madras",colors:["Y","O","PK","TL","LG","LB","LR"],description:"Bright Indian-style plaids",category:"Fashion"},preppy:{name:"Preppy",colors:["NB","R","GD","W","DG","K"],description:"Classic Ivy League style",category:"Fashion"},punk:{name:"Punk Tartan",colors:["R","K","W","Y","PK","P"],description:"Vivienne Westwood inspired",category:"Fashion"},nordic:{name:"Nordic",colors:["W","NB","R","GY","CW"],description:"Scandinavian minimalism",category:"Fashion"},edinburgh:{name:"Edinburgh",colors:["RB","GD","K","W","R"],description:"Scottish capital colors",category:"Regional"},highland:{name:"Highland",colors:["B","DB","NB","R","DR","G","DG","HG","K","W","Y","GD"],description:"Classic Scottish tartan colors",category:"Regional"},irish:{name:"Irish",colors:["G","DG","HG","W","GD","O"],description:"Irish green palettes",category:"Regional"},welsh:{name:"Welsh",colors:["R","DG","W","K","G"],description:"Welsh national colors",category:"Regional"},earthTones:{name:"Earth Tones",colors:["BR","LBR","DBR","TN","RU","CB","OG","HG","CW","ST","GD"],description:"Natural, warm colors",category:"Theme"},jewels:{name:"Jewel Tones",colors:["DP","VI","DB","RB","DR","DG","GD","AM"],description:"Rich, saturated colors",category:"Theme"},muted:{name:"Muted/Ancient",colors:["LB","LG","LR","LY","GY","LGY","TN","CW","LV","LO"],description:"Soft, faded weathered tones",category:"Theme"},modern:{name:"Modern Bright",colors:["B","R","G","Y","O","P","PK","TL","W","K"],description:"Vivid contemporary colors",category:"Theme"},monochrome:{name:"Monochrome",colors:["K","DGY","GY","LGY","CH","W","CW"],description:"Black, white, and grays",category:"Theme"},warmth:{name:"Warm Sunset",colors:["R","LR","CR","O","LO","DO","Y","GD","AM","PK","RU"],description:"Reds, oranges, yellows",category:"Theme"},cool:{name:"Cool Ocean",colors:["B","LB","DB","AB","RB","NB","TL","G","LG","P","LV"],description:"Blues, greens, purples",category:"Theme"},forest:{name:"Forest",colors:["DG","HG","FG","OG","BR","DBR","K","TN"],description:"Deep woodland colors",category:"Theme"},autumn:{name:"Autumn",colors:["RU","O","GD","BR","DR","OG","AM","TN"],description:"Fall foliage colors",category:"Theme"},winter:{name:"Winter",colors:["W","LB","NB","GY","LGY","CW","DB"],description:"Cold, icy tones",category:"Theme"},spring:{name:"Spring",colors:["LG","PK","LY","LV","LB","W","LP"],description:"Fresh pastel colors",category:"Theme"},summer:{name:"Summer",colors:["Y","O","TL","LB","PK","G","W"],description:"Bright sunny colors",category:"Theme"},midnight:{name:"Midnight",colors:["NB","DP","K","DGY","DB","VI"],description:"Deep night colors",category:"Theme"},vintage:{name:"Vintage",colors:["TN","CW","RU","OG","GY","LBR","MR"],description:"Nostalgic faded colors",category:"Theme"},neonFull:{name:"Full Neon",colors:["NP","NY","NO","NG","NE","NC","NM","NV","NR","NL","NT","NS","NA","NW","UV"],description:"All 15 fluorescent colors",category:"Neon"},rave:{name:"Rave",colors:["NP","NC","NM","NG","NV","UV","K"],description:"UV-reactive blacklight glow",category:"Neon"},neonPop:{name:"Neon Pop",colors:["NP","NY","NC","NG","W","K"],description:"80s pop art vibes",category:"Neon"},electricDream:{name:"Electric Dream",colors:["NE","NM","NC","NV","K","W"],description:"Synthwave/cyberpunk aesthetic",category:"Neon"},acidTrip:{name:"Acid Trip",colors:["NL","NG","NY","NP","NM","K"],description:"Psychedelic lime/green focus",category:"Neon"},tropicalNeon:{name:"Tropical Neon",colors:["NP","NO","NY","NT","NA","W"],description:"Miami Vice sunset vibes",category:"Neon"},blacklightGlow:{name:"Blacklight Glow",colors:["UV","NW","NC","NM","NG","K"],description:"Maximum UV reactivity",category:"Neon"},neonNoir:{name:"Neon Noir",colors:["NP","NE","K","DGY","CH"],description:"Dark cyberpunk with neon accents",category:"Neon"}};function _v(e,t,r,n=2,s=1,a,o,c){const l=e.getContext("2d");if(!l)return;const u=y=>{const b=Te(y);if(b)return{hex:b.hex,rgb:b.rgb};const x=o==null?void 0:o.find(d=>d.code.toUpperCase()===y.toUpperCase());if(x){const d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(x.hex);if(d)return{hex:x.hex,rgb:{r:parseInt(d[1],16),g:parseInt(d[2],16),b:parseInt(d[3],16)}}}return null},g=ut(t),m=Gt[r],h=g.length,v=h*s*n;if(e.width=v,e.height=v,c){for(let y=0;y<v;y++){const b=Math.floor(y/n)%h,x=g.threads[b],d=u(x);if(!d)continue;let p={...d.rgb};if(a&&a.type!=="none")for(let f=0;f<v;f++){const w=lu(f,y,v,v,a),j=ou(p,w.brightness);l.fillStyle=iu(j),l.fillRect(f,y,1,1)}else l.fillStyle=d.hex,l.fillRect(0,y,v,1)}return}for(let y=0;y<v;y++)for(let b=0;b<v;b++){const x=Math.floor(b/n)%h,d=Math.floor(y/n)%h,p=Ia(g,g,m,x,d),f=u(p.color);if(!f)continue;let w={...f.rgb};if(a&&a.type!=="none"){const j=lu(b,y,v,v,a);w=ou(w,j.brightness)}l.fillStyle=iu(w),l.fillRect(b,y,1,1)}}function mn({sett:e,weaveType:t,scale:r=2,repeats:n=1,shapeMask:s,customColors:a,isBlanket:o,onClick:c,className:l=""}){const u=N.useRef(null);return N.useEffect(()=>{u.current&&_v(u.current,e,t,r,n,s,a,o)},[e,t,r,n,s,a,o]),i.jsx("canvas",{ref:u,className:`${l} ${c?"cursor-pointer hover:ring-2 hover:ring-indigo-500 transition-all":""}`,onClick:c})}function jv({code:e,small:t=!1}){const r=Te(e);return r?i.jsx("div",{className:`${t?"w-4 h-4":"w-6 h-6"} rounded border border-gray-600 flex-shrink-0`,style:{backgroundColor:r.hex},title:`${r.name} (${e})`}):null}function Iu({data:e,config:t}){const r=N.useRef(null),{result:n,imagePattern:s}=e,{sett:a}=n;return N.useEffect(()=>{const o=r.current;if(!o)return;const c=o.getContext("2d");if(!c)return;const l=64;if(o.width=l,o.height=l,s){const h=new Image;h.onload=()=>{c.imageSmoothingEnabled=!1,c.drawImage(h,0,0,l,l)},h.src=s.imageData;return}const u=ut(a),g=l/u.length,m=Gt[t.weaveType];for(let h=0;h<u.length;h++)for(let v=0;v<u.length;v++){const y=u.threads[v%u.length],b=u.threads[h%u.length],d=m.tieUp[h%m.treadling.length][v%m.threading.length]?y:b,p=Te(d);c.fillStyle=(p==null?void 0:p.hex)||"#808080",c.fillRect(v*g,h*g,g+.5,g+.5)}},[a,t.weaveType,s]),i.jsx("canvas",{ref:r,width:64,height:64,className:"w-full h-full",style:{imageRendering:"pixelated"}})}function Cv({data:e,config:t,customColors:r,breedingMode:n,isSelectedForBreeding:s,onSelectForBreeding:a,onMutate:o,onEdit:c,onTiledPreview:l,onCopySeed:u,onDownloadSVG:g,onDownloadWIF:m,onDownloadPNG:h,onShowYarnCalc:v,onShowMockups:y}){const{result:b,isOptical:x,isBlanket:d,parentId:p,imagePattern:f}=e,{sett:w,seed:j}=b,_=ut(w),k=(_.length/t.threadGauge).toFixed(2),S=()=>{n&&a&&a(e)},C=N.useRef(null);return N.useEffect(()=>{if(!f)return;const R=C.current;if(!R)return;const M=R.getContext("2d");if(!M)return;const I=new Image;I.onload=()=>{R.width=200,R.height=200,M.imageSmoothingEnabled=!1;const T=I.width*f.pixelSize,D=I.height*f.pixelSize,z=Math.ceil(200/T)+1,re=Math.ceil(200/D)+1;for(let O=0;O<re;O++)for(let G=0;G<z;G++){let K=G*T,J=O*D;f.repeatMode==="brick"&&O%2===1&&(K+=T/2),f.repeatMode==="half-drop"&&G%2===1&&(J+=D/2),M.drawImage(I,K,J,T,D)}},I.src=f.imageData},[f]),i.jsxs("div",{className:`card p-3 space-y-2 animate-fadeIn ${n?"cursor-pointer hover:ring-2 hover:ring-pink-500":""} ${s?"ring-2 ring-pink-500 bg-pink-950/20":""}`,onClick:S,children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex flex-wrap gap-0.5",children:[!f&&w.colors.map(R=>i.jsx(jv,{code:R},R)),f&&(e.id.startsWith("motif-")||e.id.startsWith("geo-"))&&i.jsx("span",{className:"text-xs text-gray-400",children:e.result.signature.signature}),f&&e.id.startsWith("img-")&&i.jsx("span",{className:"text-xs text-gray-400",children:"Image Pattern"})]}),i.jsxs("div",{className:"flex gap-1",children:[f&&e.id.startsWith("motif-")&&i.jsx("span",{className:"text-xs px-2 py-0.5 bg-amber-900/50 text-amber-300 rounded-full",children:"Motif"}),f&&e.id.startsWith("geo-")&&i.jsx("span",{className:"text-xs px-2 py-0.5 bg-teal-900/50 text-teal-300 rounded-full",children:"Geometric"}),f&&e.id.startsWith("img-")&&i.jsx("span",{className:"text-xs px-2 py-0.5 bg-cyan-900/50 text-cyan-300 rounded-full",children:"Image"}),d&&i.jsx("span",{className:"text-xs px-2 py-0.5 bg-orange-900/50 text-orange-300 rounded-full",children:"Blanket"}),x&&i.jsx("span",{className:"text-xs px-2 py-0.5 bg-purple-900/50 text-purple-300 rounded-full",children:"Optical"}),p&&i.jsx("span",{className:"text-xs px-2 py-0.5 bg-green-900/50 text-green-300 rounded-full",children:"Mutant"})]})]}),f?i.jsx("canvas",{ref:C,className:"w-full aspect-square rounded-lg cursor-pointer hover:ring-2 hover:ring-indigo-500 transition-all",style:{imageRendering:"pixelated"},onClick:n?void 0:()=>l(e)}):i.jsx(mn,{sett:w,weaveType:t.weaveType,scale:2,repeats:1,shapeMask:x?t.shapeMask:void 0,customColors:r,isBlanket:d,onClick:n?void 0:()=>l(e),className:"w-full aspect-square rounded-lg"}),f?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"font-mono text-xs text-gray-400 truncate",children:[f.repeatMode," repeat  ",f.pixelSize,"x scale"]}),i.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[i.jsx("span",{children:"Image tile"}),i.jsx("span",{children:f.repeatMode})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"font-mono text-xs text-gray-400 truncate cursor-pointer hover:text-gray-200 transition-colors",onClick:()=>navigator.clipboard.writeText(w.threadcount),title:"Click to copy threadcount",children:w.threadcount}),i.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[i.jsxs("span",{children:[_.length," threads"]}),i.jsxs("span",{children:[k,'" sett']}),i.jsxs("span",{children:[w.colors.length," colors"]})]})]}),i.jsxs("div",{className:"flex gap-1.5 flex-wrap",children:[i.jsx("button",{onClick:()=>o(e),className:"btn-secondary text-xs flex-1 min-w-[60px]",title:"Generate variations",children:"Mutate"}),i.jsx("button",{onClick:()=>c(e),className:"btn-secondary text-xs flex-1 min-w-[60px]",title:"Edit pattern",children:"Edit"}),i.jsx("button",{onClick:()=>v(e),className:"btn-secondary text-xs px-2",title:"Yarn Calculator",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),i.jsx("button",{onClick:()=>y(e),className:"btn-secondary text-xs px-2",title:"Product Mockups",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})})}),i.jsx("button",{onClick:()=>g(e),className:"btn-secondary text-xs px-2",title:"Download SVG",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),i.jsx("button",{onClick:()=>h(e,300),className:"btn-secondary text-xs px-2",title:"Download PNG (300 DPI - Print Ready)",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),i.jsx("button",{onClick:()=>m(e),className:"btn-secondary text-xs px-2",title:"Download WIF (Loom Draft)",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),i.jsx("button",{onClick:()=>u(j),className:"btn-secondary text-xs px-2",title:"Copy seed",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),i.jsx("button",{onClick:()=>{const R=`https://thedavidmurray.github.io/tartanism/?seed=${j}`,M=`Check out this tartan I made with Tartanism! ${w.threadcount}`;window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(M)}&url=${encodeURIComponent(R)}`,"_blank")},className:"btn-secondary text-xs px-2",title:"Share on X/Twitter",children:i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})})})]})]})}function Nv({config:e,onChange:t,onGenerate:r,onOpenColorBuilder:n,customColors:s}){const a=[{name:"Blues",codes:["B","LB","DB","AB","RB","NB"]},{name:"Reds",codes:["R","LR","DR","CR","SC","MR"]},{name:"Greens",codes:["G","LG","DG","HG","OG","FG","TL"]},{name:"Yellows",codes:["Y","LY","GD","AM","ST"]},{name:"Neutrals",codes:["K","W","GY","LGY","DGY","CH","CW","IW"]},{name:"Browns",codes:["BR","LBR","DBR","TN","RU","CB"]},{name:"Purples",codes:["P","LP","DP","VI","LV"]},{name:"Oranges",codes:["O","LO","DO"]},{name:"Pinks",codes:["PK","LP2","DP2"]},{name:"Neons",codes:["NP","NY","NO","NG","NE","NC","NM","NV","NR","NL","NT","NS","NA","NW","UV"]}],o=l=>{const u=e.allowedColors.includes(l)?e.allowedColors.filter(g=>g!==l):[...e.allowedColors,l];t({...e,allowedColors:u})},c=l=>{const g=l.every(m=>e.allowedColors.includes(m))?e.allowedColors.filter(m=>!l.includes(m)):[...new Set([...e.allowedColors,...l])];t({...e,allowedColors:g})};return i.jsxs("div",{className:"card p-4 space-y-4",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-base font-semibold text-gray-100 mb-3",children:"Generator Settings"}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Batch Size"}),i.jsx("input",{type:"number",min:"1",max:"50",value:e.batchSize,onChange:l=>t({...e,batchSize:Math.min(50,Math.max(1,parseInt(l.target.value)||1))}),className:"input"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Thread Gauge (TPI)"}),i.jsx("input",{type:"number",min:"12",max:"96",value:e.threadGauge,onChange:l=>t({...e,threadGauge:parseInt(l.target.value)||24}),className:"input"})]})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"label",children:["Colors (",e.colorMin," - ",e.colorMax,")",e.loomCompatible&&i.jsx("span",{className:"text-amber-400 text-xs ml-2",children:"(max 6 for loom)"})]}),i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsx("input",{type:"range",min:"2",max:e.loomCompatible?Jr.maxColors:12,value:e.colorMin,onChange:l=>t({...e,colorMin:parseInt(l.target.value)}),className:"slider flex-1"}),i.jsx("span",{className:"text-gray-400 w-8 text-center",children:e.colorMin}),i.jsx("span",{className:"text-gray-500",children:"to"}),i.jsx("input",{type:"range",min:"2",max:e.loomCompatible?Jr.maxColors:12,value:e.colorMax,onChange:l=>t({...e,colorMax:parseInt(l.target.value)}),className:"slider flex-1"}),i.jsx("span",{className:"text-gray-400 w-8 text-center",children:e.colorMax})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"label",children:["Stripes (",e.stripeMin," - ",e.stripeMax,")"]}),i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsx("input",{type:"range",min:"2",max:"24",value:e.stripeMin,onChange:l=>t({...e,stripeMin:parseInt(l.target.value)}),className:"slider flex-1"}),i.jsx("span",{className:"text-gray-400 w-8 text-center",children:e.stripeMin}),i.jsx("span",{className:"text-gray-500",children:"to"}),i.jsx("input",{type:"range",min:"2",max:"24",value:e.stripeMax,onChange:l=>t({...e,stripeMax:parseInt(l.target.value)}),className:"slider flex-1"}),i.jsx("span",{className:"text-gray-400 w-8 text-center",children:e.stripeMax})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"label",children:["Thread Width (",e.threadMin," - ",e.threadMax,")"]}),i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsx("input",{type:"range",min:"2",max:"96",step:"2",value:e.threadMin,onChange:l=>t({...e,threadMin:parseInt(l.target.value)}),className:"slider flex-1"}),i.jsx("span",{className:"text-gray-400 w-8 text-center",children:e.threadMin}),i.jsx("span",{className:"text-gray-500",children:"to"}),i.jsx("input",{type:"range",min:"2",max:"96",step:"2",value:e.threadMax,onChange:l=>t({...e,threadMax:parseInt(l.target.value)}),className:"slider flex-1"}),i.jsx("span",{className:"text-gray-400 w-8 text-center",children:e.threadMax})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"label",children:["Total Threads (",e.totalMin," - ",e.totalMax,")"]}),i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsx("input",{type:"range",min:"20",max:"600",step:"10",value:e.totalMin,onChange:l=>t({...e,totalMin:parseInt(l.target.value)}),className:"slider flex-1"}),i.jsx("span",{className:"text-gray-400 w-12 text-center",children:e.totalMin}),i.jsx("span",{className:"text-gray-500",children:"to"}),i.jsx("input",{type:"range",min:"20",max:"600",step:"10",value:e.totalMax,onChange:l=>t({...e,totalMax:parseInt(l.target.value)}),className:"slider flex-1"}),i.jsx("span",{className:"text-gray-400 w-12 text-center",children:e.totalMax})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"label",children:["Weave Pattern",e.loomCompatible&&i.jsx("span",{className:"text-amber-400 text-xs ml-2",children:"(locked to 2/2 Twill)"})]}),i.jsx("select",{value:e.weaveType,onChange:l=>t({...e,weaveType:l.target.value}),className:`input ${e.loomCompatible?"opacity-50 cursor-not-allowed":""}`,disabled:e.loomCompatible,children:Object.entries(Gt).map(([l,u])=>i.jsx("option",{value:l,children:u.name},l))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Symmetry"}),i.jsx("div",{className:"flex gap-2",children:["symmetric","asymmetric","either"].map(l=>i.jsx("button",{onClick:()=>t({...e,symmetry:l}),className:`flex-1 py-2 px-3 rounded-lg text-sm transition-all ${e.symmetry===l?"bg-indigo-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:l.charAt(0).toUpperCase()+l.slice(1)},l))})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("label",{className:"label mb-0",children:"Optical Illusion Mode"}),i.jsx("button",{onClick:()=>t({...e,opticalMode:!e.opticalMode}),className:`w-12 h-6 rounded-full transition-colors ${e.opticalMode?"bg-purple-600":"bg-gray-700"}`,children:i.jsx("div",{className:`w-5 h-5 rounded-full bg-white transition-transform ${e.opticalMode?"translate-x-6":"translate-x-0.5"}`})})]}),e.opticalMode&&i.jsxs("div",{className:"mt-3 space-y-3 p-3 bg-purple-900/20 rounded-lg border border-purple-800/30",children:[i.jsxs("div",{children:[i.jsx("label",{className:"label text-purple-300",children:"Shape Preset"}),i.jsxs("select",{value:e.shapeMask.type,onChange:l=>{const u=Tg[l.target.value];t(u?{...e,shapeMask:u}:{...e,shapeMask:{...e.shapeMask,type:l.target.value}})},className:"input bg-purple-900/30 border-purple-700",children:[i.jsx("option",{value:"none",children:"None"}),i.jsx("option",{value:"cube",children:"Cubes"}),i.jsx("option",{value:"hexagon",children:"Hexagons"}),i.jsx("option",{value:"sphere",children:"Spheres"}),i.jsx("option",{value:"wave",children:"Waves"}),i.jsx("option",{value:"diamond",children:"Diamonds"}),i.jsx("option",{value:"penrose",children:"Penrose"}),i.jsx("option",{value:"escher",children:"Escher Stairs"})]})]}),e.shapeMask.type!=="none"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsxs("label",{className:"label text-purple-300",children:["Element Size (",e.shapeMask.elementSize,")"]}),i.jsx("input",{type:"range",min:"20",max:"100",value:e.shapeMask.elementSize,onChange:l=>t({...e,shapeMask:{...e.shapeMask,elementSize:parseInt(l.target.value)}}),className:"slider"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"label text-purple-300",children:["Depth (",(e.shapeMask.depth*100).toFixed(0),"%)"]}),i.jsx("input",{type:"range",min:"0",max:"100",value:e.shapeMask.depth*100,onChange:l=>t({...e,shapeMask:{...e.shapeMask,depth:parseInt(l.target.value)/100}}),className:"slider"})]})]})]})]}),i.jsxs("div",{className:"border border-amber-700/30 rounded-lg p-4 bg-amber-900/10",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-amber-400 text-lg",children:""}),i.jsx("label",{className:"label mb-0 text-amber-200",children:"Loom Compatible Mode"})]}),i.jsx("button",{onClick:()=>{const l=!e.loomCompatible,u={loomCompatible:l};l&&(u.weaveType=Jr.weaveType,u.colorMax=Math.min(e.colorMax,Jr.maxColors),u.colorMin=Math.min(e.colorMin,Jr.maxColors)),t({...e,...u})},className:`w-12 h-6 rounded-full transition-colors ${e.loomCompatible?"bg-amber-500":"bg-gray-700"}`,children:i.jsx("div",{className:`w-5 h-5 rounded-full bg-white transition-transform ${e.loomCompatible?"translate-x-6":"translate-x-0.5"}`})})]}),i.jsx("p",{className:"text-xs text-amber-300/70 mb-3",children:"Constrains patterns for production at Scottish mills (Lochcarron, House of Edgar)"}),e.loomCompatible&&i.jsxs("div",{className:"space-y-3 text-xs",children:[i.jsxs("div",{className:"flex items-center gap-2 text-amber-200",children:[i.jsx("span",{className:"text-green-400",children:""}),i.jsx("span",{children:"Max 6 colors (mill standard)"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-amber-200",children:[i.jsx("span",{className:"text-green-400",children:""}),i.jsx("span",{children:"2/2 Twill weave (traditional tartan)"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-amber-200",children:[i.jsx("span",{className:"text-green-400",children:""}),i.jsx("span",{children:"Symmetric sett (warp = weft)"})]}),i.jsxs("div",{className:"mt-3 pt-3 border-t border-amber-700/30",children:[i.jsx("p",{className:"text-amber-300 font-medium mb-2",children:"Lochcarron Fabric Options:"}),i.jsx("div",{className:"space-y-1",children:Jr.fabrics.map(l=>i.jsxs("div",{className:"text-amber-200/70",children:[i.jsx("span",{className:"font-mono text-amber-400",children:l.code})," ",l.name," (",l.weight,") - ",l.use]},l.code))})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Color Palette"}),i.jsxs("div",{className:"flex gap-2 mb-3",children:[i.jsxs("select",{onChange:l=>{const u=Au[l.target.value];u&&t({...e,allowedColors:[...u.colors]})},className:"input flex-1 text-sm",defaultValue:"",children:[i.jsx("option",{value:"",disabled:!0,children:"Load Preset..."}),Object.entries(Au).map(([l,u])=>i.jsx("option",{value:l,children:u.name},l))]}),i.jsx("button",{onClick:()=>{const l=Object.keys(yt),u=5+Math.floor(Math.random()*4),g=[...l].sort(()=>Math.random()-.5);t({...e,allowedColors:g.slice(0,u)})},className:"btn-secondary text-sm px-3",title:"Generate random palette",children:""})]}),i.jsxs("div",{className:"flex gap-2 mb-3",children:[i.jsx("button",{onClick:()=>{const l=prompt("Name your palette:");if(l){const u=JSON.parse(localStorage.getItem("tartanism-palettes")||"{}");u[l]=e.allowedColors,localStorage.setItem("tartanism-palettes",JSON.stringify(u)),alert(`Palette "${l}" saved!`)}},className:"btn-secondary text-xs flex-1",children:" Save Custom"}),i.jsx("button",{onClick:()=>{const l=JSON.parse(localStorage.getItem("tartanism-palettes")||"{}"),u=Object.keys(l);if(u.length===0){alert("No saved palettes yet!");return}const g=prompt(`Load palette:
${u.map((m,h)=>`${h+1}. ${m}`).join(`
`)}

Enter name:`);g&&l[g]&&t({...e,allowedColors:l[g]})},className:"btn-secondary text-xs flex-1",children:" Load Custom"})]}),i.jsxs("button",{onClick:n,className:"w-full btn-secondary text-sm mb-3 flex items-center justify-center gap-2",children:[i.jsx("span",{children:""}),i.jsx("span",{children:"Yarn Color Builder"}),s.length>0&&i.jsx("span",{className:"bg-indigo-600 text-white text-xs px-2 py-0.5 rounded-full",children:s.length})]}),i.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-2",children:[a.map(l=>i.jsxs("div",{children:[i.jsx("button",{onClick:()=>c(l.codes),className:"text-xs text-gray-400 hover:text-gray-200 mb-1",children:l.name}),i.jsx("div",{className:"flex flex-wrap gap-1",children:l.codes.map(u=>{const g=Te(u);return g?i.jsx("button",{onClick:()=>o(u),className:`w-6 h-6 rounded border-2 transition-all ${e.allowedColors.includes(u)?"border-white scale-110":"border-transparent opacity-40"}`,style:{backgroundColor:g.hex},title:g.name},u):null})})]},l.name)),s.length>0&&i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-indigo-400",children:"Custom"}),i.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.map(l=>i.jsx("div",{className:"w-6 h-6 rounded border-2 border-indigo-400 opacity-60 cursor-help",style:{backgroundColor:l.hex},title:`${l.name} (${l.code}) - Use in Pattern Builder`},l.code))}),i.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Use in Pattern Builder"})]})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[e.allowedColors.length," colors selected"]})]}),i.jsxs("button",{onClick:r,className:"btn-primary w-full text-lg",children:["Roll ",e.batchSize," Tartan",e.batchSize>1?"s":""]})]})}function Rv({initialSett:e,config:t,customColors:r,onSave:n,onClose:s}){const[a,o]=N.useState("stripe"),[c,l]=N.useState((e==null?void 0:e.stripes)||[{color:"B",count:24,isPivot:!0},{color:"W",count:4},{color:"B",count:24},{color:"R",count:4},{color:"G",count:24,isPivot:!0}]),[u,g]=N.useState(null),[m,h]=N.useState((e==null?void 0:e.name)||""),[v,y]=N.useState((e==null?void 0:e.stripes)||[{color:"B",count:8},{color:"W",count:2},{color:"G",count:8}]),[b,x]=N.useState((e==null?void 0:e.stripes)||[{color:"B",count:8},{color:"W",count:2},{color:"G",count:8}]),[d,p]=N.useState(!0),[f,w]=N.useState(4),[j,_]=N.useState("warp"),[k,S]=N.useState(!1),[C,R]=N.useState("scarf"),M=gt(c.map(L=>`${L.color}${L.isPivot?"/":""}${L.count}`).join(" ")),I=()=>{var ee;const L=Object.keys(yt),W=(ee=c[c.length-1])==null?void 0:ee.color,A=L.find(ve=>ve!==W)||"B";l([...c,{color:A,count:8}])},E=L=>{c.length<=2||(l(c.filter((W,A)=>A!==L)),g(null))},T=(L,W)=>{l(c.map((A,ee)=>ee===L?{...A,...W}:A))},D=(L,W)=>{const A=L+W;if(A<0||A>=c.length)return;const ee=[...c];[ee[L],ee[A]]=[ee[A],ee[L]],l(ee),g(A)},z=L=>{const W=[...c];W.splice(L+1,0,{...c[L],isPivot:!1}),l(W)},re=L=>{const W=Te(L);if(W)return W.hex;const A=r.find(ee=>ee.code.toUpperCase()===L.toUpperCase());return(A==null?void 0:A.hex)||"#808080"},O=L=>{const W=[];return L.forEach(A=>{for(let ee=0;ee<A.count;ee++)W.push(A.color)}),W},G=O(v),K=O(b),J=a==="grid"?gt(v.map(L=>`${L.color}${L.count}`).join(" ")):M,ne=L=>{var Pe;const W=L==="warp"?v:b,A=L==="warp"?y:x,ee=((Pe=W[W.length-1])==null?void 0:Pe.color)||"B",Fe=[...Object.keys(yt),...r.map(Fr=>Fr.code)].find(Fr=>Fr!==ee)||"B",ft=[...W,{color:Fe,count:4}];A(ft),d&&(L==="warp"?x(ft):y(ft))},et=(L,W)=>{const A=L==="warp"?v:b,ee=L==="warp"?y:x;if(A.length<=1)return;const ve=A.filter((Fe,ft)=>ft!==W);ee(ve),d&&(L==="warp"?x(ve):y(ve))},ke=(L,W,A)=>{const ee=L==="warp"?v:b,ve=L==="warp"?y:x,Fe=ee.map((ft,Pe)=>Pe===W?{...ft,...A}:ft);ve(Fe),d&&(L==="warp"?x(Fe):y(Fe))},kt=L=>{L==="grid"&&a==="stripe"?(y([...c]),x([...c])):L==="stripe"&&a==="grid"&&l([...v]),o(L)};return i.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"card max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b border-gray-800",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-xl font-semibold",children:"Pattern Builder"}),i.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex bg-gray-800 rounded-lg p-1",children:[i.jsx("button",{onClick:()=>kt("stripe"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors ${a==="stripe"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"Stripe Mode"}),i.jsx("button",{onClick:()=>kt("grid"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors ${a==="grid"?"bg-indigo-600 text-white":"text-gray-400 hover:text-white"}`,children:"Grid Mode"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:a==="stripe"?"Simple sequential stripe editor":"Advanced warp/weft control"})]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"label",children:"Pattern Name"}),i.jsx("input",{type:"text",value:m,onChange:L=>h(L.target.value),placeholder:"My Custom Tartan",className:"input"})]}),a==="stripe"?i.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("label",{className:"label mb-0",children:"Stripes"}),i.jsx("button",{onClick:I,className:"btn-secondary text-xs",children:"+ Add Stripe"})]}),i.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto pr-2",children:c.map((L,W)=>i.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg transition-colors ${u===W?"bg-indigo-900/30 ring-1 ring-indigo-500":"bg-gray-800/50"}`,onClick:()=>g(W),children:[i.jsx("div",{className:"w-8 h-8 rounded border border-gray-600 flex-shrink-0",style:{backgroundColor:re(L.color)}}),i.jsxs("select",{value:L.color,onChange:A=>T(W,{color:A.target.value}),className:"input flex-1 py-1 text-sm",onClick:A=>A.stopPropagation(),children:[i.jsx("optgroup",{label:"Standard Colors",children:Object.entries(yt).map(([A,ee])=>i.jsxs("option",{value:A,children:[ee.name," (",A,")"]},A))}),r.length>0&&i.jsx("optgroup",{label:"Custom Colors",children:r.map(A=>i.jsxs("option",{value:A.code,children:[A.name," (",A.code,")"]},A.code))})]}),i.jsx("input",{type:"number",min:"2",max:"48",step:"2",value:L.count,onChange:A=>T(W,{count:Math.max(2,parseInt(A.target.value)||2)}),className:"input w-16 py-1 text-sm text-center",onClick:A=>A.stopPropagation()}),i.jsx("button",{onClick:A=>{A.stopPropagation(),D(W,-1)},disabled:W===0,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30",children:""}),i.jsx("button",{onClick:A=>{A.stopPropagation(),D(W,1)},disabled:W===c.length-1,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30",children:""}),i.jsx("button",{onClick:A=>{A.stopPropagation(),z(W)},className:"p-1 text-gray-400 hover:text-white",children:""}),i.jsx("button",{onClick:A=>{A.stopPropagation(),E(W)},disabled:c.length<=2,className:"p-1 text-red-400 hover:text-red-300 disabled:opacity-30",children:""})]},W))})]}),i.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[i.jsxs("div",{children:["Total: ",M.totalThreads," threads"]}),i.jsxs("div",{children:["Sett size: ",(ut(M).length/t.threadGauge).toFixed(2),'"']}),i.jsxs("div",{children:["Colors: ",M.colors.length]})]}),i.jsx("div",{className:"font-mono text-xs text-gray-500 p-2 bg-gray-900 rounded",children:M.threadcount})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("label",{className:"label",children:"Preview"}),i.jsx(mn,{sett:M,weaveType:t.weaveType,scale:3,repeats:2,customColors:r,className:"w-full aspect-square rounded-lg"}),i.jsxs("div",{className:"border-t border-gray-800 pt-4",children:[i.jsxs("button",{onClick:()=>S(!k),className:"flex items-center justify-between w-full text-left",children:[i.jsx("label",{className:"label mb-0 cursor-pointer",children:"Product Previews"}),i.jsx("span",{className:"text-gray-400",children:k?"":"+"})]}),k&&i.jsxs("div",{className:"mt-3 space-y-3",children:[i.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(nt).map(L=>i.jsx("button",{onClick:()=>R(L),className:`px-2 py-1 rounded text-xs transition-colors ${C===L?"bg-indigo-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:nt[L].name},L))}),i.jsxs("div",{className:"text-xs text-gray-500",children:[nt[C].repeats,"x repeats = ",nt[C].inches]}),i.jsx("div",{className:"bg-gray-900 p-2 rounded-lg overflow-auto max-h-64",children:i.jsx(mn,{sett:M,weaveType:t.weaveType,scale:2,repeats:nt[C].repeats,customColors:r,className:"mx-auto rounded"})})]})]})]})]}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-800/50 rounded-lg",children:[i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:d,onChange:L=>p(L.target.checked),className:"rounded border-gray-600 bg-gray-700 text-indigo-500 focus:ring-indigo-500"}),i.jsx("span",{className:"text-sm text-gray-300",children:"Sync Warp & Weft (Traditional Tartan)"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:d?"Same pattern on both axes":"Independent warp/weft control"})]}),i.jsxs("div",{className:"grid lg:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("label",{className:"label mb-0 flex items-center gap-2",children:[i.jsx("span",{className:"w-3 h-3 bg-blue-500 rounded-full"}),"Warp (Vertical)"]}),i.jsx("button",{onClick:()=>ne("warp"),className:"btn-secondary text-xs",children:"+"})]}),i.jsx("div",{className:"space-y-1 max-h-60 overflow-y-auto pr-1",children:v.map((L,W)=>i.jsxs("div",{className:"flex items-center gap-1 p-1.5 bg-gray-800/50 rounded",children:[i.jsx("div",{className:"w-6 h-6 rounded border border-gray-600 flex-shrink-0",style:{backgroundColor:re(L.color)}}),i.jsxs("select",{value:L.color,onChange:A=>ke("warp",W,{color:A.target.value}),className:"input flex-1 py-0.5 text-xs",children:[i.jsx("optgroup",{label:"Standard",children:Object.entries(yt).map(([A,ee])=>i.jsx("option",{value:A,children:A},A))}),r.length>0&&i.jsx("optgroup",{label:"Custom",children:r.map(A=>i.jsx("option",{value:A.code,children:A.code},A.code))})]}),i.jsx("input",{type:"number",min:"1",max:"32",value:L.count,onChange:A=>ke("warp",W,{count:Math.max(1,parseInt(A.target.value)||1)}),className:"input w-12 py-0.5 text-xs text-center"}),i.jsx("button",{onClick:()=>et("warp",W),disabled:v.length<=1,className:"p-0.5 text-red-400 hover:text-red-300 disabled:opacity-30 text-xs",children:""})]},W))}),i.jsxs("div",{className:"text-xs text-gray-500",children:[G.length," threads"]})]}),i.jsxs("div",{className:`space-y-2 ${d?"opacity-50 pointer-events-none":""}`,children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("label",{className:"label mb-0 flex items-center gap-2",children:[i.jsx("span",{className:"w-3 h-3 bg-orange-500 rounded-full"}),"Weft (Horizontal)"]}),i.jsx("button",{onClick:()=>ne("weft"),className:"btn-secondary text-xs",children:"+"})]}),i.jsx("div",{className:"space-y-1 max-h-60 overflow-y-auto pr-1",children:b.map((L,W)=>i.jsxs("div",{className:"flex items-center gap-1 p-1.5 bg-gray-800/50 rounded",children:[i.jsx("div",{className:"w-6 h-6 rounded border border-gray-600 flex-shrink-0",style:{backgroundColor:re(L.color)}}),i.jsxs("select",{value:L.color,onChange:A=>ke("weft",W,{color:A.target.value}),className:"input flex-1 py-0.5 text-xs",children:[i.jsx("optgroup",{label:"Standard",children:Object.entries(yt).map(([A,ee])=>i.jsx("option",{value:A,children:A},A))}),r.length>0&&i.jsx("optgroup",{label:"Custom",children:r.map(A=>i.jsx("option",{value:A.code,children:A.code},A.code))})]}),i.jsx("input",{type:"number",min:"1",max:"32",value:L.count,onChange:A=>ke("weft",W,{count:Math.max(1,parseInt(A.target.value)||1)}),className:"input w-12 py-0.5 text-xs text-center"}),i.jsx("button",{onClick:()=>et("weft",W),disabled:b.length<=1,className:"p-0.5 text-red-400 hover:text-red-300 disabled:opacity-30 text-xs",children:""})]},W))}),i.jsxs("div",{className:"text-xs text-gray-500",children:[K.length," threads"]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("label",{className:"label mb-0",children:"Weave Grid"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Scale:"}),i.jsx("input",{type:"range",min:"2",max:"8",value:f,onChange:L=>w(parseInt(L.target.value)),className:"w-16"})]})]}),i.jsx("div",{className:"bg-gray-900 rounded-lg p-2 overflow-auto max-h-64",children:i.jsx("div",{className:"grid gap-0",style:{gridTemplateColumns:`repeat(${Math.min(K.length,40)}, ${f}px)`,width:"fit-content"},children:Array.from({length:Math.min(G.length,40)}).map((L,W)=>Array.from({length:Math.min(K.length,40)}).map((A,ee)=>{const ve=G[W],Fe=K[ee],Pe=(ee+W)%2===0?ve:Fe;return i.jsx("div",{className:"border border-gray-800/50",style:{width:f,height:f,backgroundColor:re(Pe)},title:`Warp: ${ve}, Weft: ${Fe}`},`${ee}-${W}`)}))})}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Math.min(G.length,40),"",Math.min(K.length,40)," threads shown",(G.length>40||K.length>40)&&" (truncated)"]})]})]}),i.jsxs("div",{className:"grid lg:grid-cols-2 gap-4 mt-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Threadcount"}),i.jsxs("div",{className:"font-mono text-xs text-gray-500 p-2 bg-gray-900 rounded",children:["Warp: ",v.map(L=>`${L.color}${L.count}`).join(" ")]}),!d&&i.jsxs("div",{className:"font-mono text-xs text-gray-500 p-2 bg-gray-900 rounded mt-1",children:["Weft: ",b.map(L=>`${L.color}${L.count}`).join(" ")]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Full Preview"}),i.jsx(mn,{sett:J,weaveType:t.weaveType,scale:3,repeats:2,customColors:r,className:"w-full aspect-square rounded-lg max-w-[200px]"})]})]}),i.jsxs("div",{className:"border-t border-gray-800 pt-4 mt-4",children:[i.jsxs("button",{onClick:()=>S(!k),className:"flex items-center justify-between w-full text-left",children:[i.jsx("label",{className:"label mb-0 cursor-pointer",children:"Product Previews"}),i.jsx("span",{className:"text-gray-400",children:k?"":"+"})]}),k&&i.jsxs("div",{className:"mt-3 space-y-3",children:[i.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(nt).map(L=>i.jsx("button",{onClick:()=>R(L),className:`px-2 py-1 rounded text-xs transition-colors ${C===L?"bg-indigo-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:nt[L].name},L))}),i.jsxs("div",{className:"text-xs text-gray-500",children:[nt[C].repeats,"x repeats = ",nt[C].inches]}),i.jsx("div",{className:"bg-gray-900 p-2 rounded-lg overflow-auto max-h-80",children:i.jsx(mn,{sett:J,weaveType:t.weaveType,scale:2,repeats:nt[C].repeats,customColors:r,className:"mx-auto rounded"})})]})]})]})]}),i.jsxs("div",{className:"p-4 border-t border-gray-800 flex gap-3 justify-end",children:[i.jsx("button",{onClick:s,className:"btn-secondary",children:"Cancel"}),i.jsx("button",{onClick:()=>{const L=a==="stripe"?{...M,name:m||void 0}:{...J,name:m||void 0};n(L)},className:"btn-primary",children:"Save to Collection"})]})]})})}function Ev({data:e,config:t,customColors:r,onClose:n}){const[s,a]=N.useState("scarf"),o=N.useRef(null),[c,l]=N.useState(2),{sett:u,seed:g}=e.result,m=ut(u),h=m.length/t.threadGauge,v=nt[s],y=(h*v.repeats).toFixed(1);N.useEffect(()=>{const x=()=>{if(!o.current)return;const d=o.current.clientWidth,p=o.current.clientHeight-80,f=m.length*v.repeats,w=d/f,j=p/f,_=Math.max(1,Math.min(w,j));l(_)};return x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[m.length,v.repeats]);const b=()=>{const x=Gt[t.weaveType],d=4,p=m.length*v.repeats,f=document.createElement("canvas");f.width=p*d,f.height=p*d;const w=f.getContext("2d");if(!w)return;const j=_=>{const k=r==null?void 0:r.find(S=>S.code===_);return k?{code:k.code,name:k.name,hex:k.hex}:Te(_)};for(let _=0;_<v.repeats;_++)for(let k=0;k<v.repeats;k++)for(let S=0;S<m.length;S++)if(e.isBlanket){const C=m.threads[S],R=j(C);R&&(w.fillStyle=R.hex,w.fillRect(k*m.length*d,(_*m.length+S)*d,m.length*d,d))}else for(let C=0;C<m.length;C++){const R=Ia(m,m,x,C,S),M=j(R.color);M&&(w.fillStyle=M.hex,w.fillRect((k*m.length+C)*d,(_*m.length+S)*d,d,d))}f.toBlob(_=>{if(!_)return;const k=URL.createObjectURL(_),S=document.createElement("a");S.href=k,S.download=`tartan-${g}-${s}-${v.repeats}x${v.repeats}.png`,S.click(),URL.revokeObjectURL(k)},"image/png")};return i.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-2",children:i.jsxs("div",{className:"card w-full h-full max-w-[98vw] max-h-[98vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"p-3 border-b border-gray-800 flex items-center justify-between flex-shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[i.jsx("h2",{className:"text-lg font-semibold",children:"Tiled Preview"}),i.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(nt).map(x=>i.jsx("button",{onClick:()=>a(x),className:`px-3 py-1 text-sm rounded-lg transition-colors ${s===x?"bg-indigo-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:nt[x].name},x))}),i.jsxs("span",{className:"text-xs text-gray-500",children:[v.repeats,"x",v.repeats," = ~",y,'"']})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:b,className:"btn-primary text-sm px-4 py-1 flex items-center gap-2",title:"Save this preview as PNG",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Save Image"]}),i.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white text-2xl px-2",children:""})]})]}),i.jsx("div",{ref:o,className:"flex-1 overflow-hidden flex items-center justify-center p-2",children:i.jsx(mn,{sett:u,weaveType:t.weaveType,scale:c,repeats:v.repeats,shapeMask:e.isOptical?t.shapeMask:void 0,customColors:r,isBlanket:e.isBlanket,className:"rounded-lg"})})]})})}function Tv({data:e,config:t,customColors:r,onClose:n}){const[s,a]=N.useState("tie"),o=N.useRef(null),{sett:c}=e.result,l=[{id:"tie",name:"Necktie",icon:"",aspectRatio:.15,repeats:8,description:"Classic business tie"},{id:"bowtie",name:"Bow Tie",icon:"",aspectRatio:2,repeats:2,description:"Formal bow tie"},{id:"scarf",name:"Scarf",icon:"",aspectRatio:.2,repeats:6,description:"Winter scarf"},{id:"pocket",name:"Pocket Square",icon:"",aspectRatio:1,repeats:2,description:"Suit pocket square"},{id:"blanket",name:"Blanket",icon:"",aspectRatio:1.3,repeats:8,description:"Throw blanket"},{id:"pillow",name:"Pillow",icon:"",aspectRatio:1,repeats:3,description:"Accent pillow"},{id:"kilt",name:"Kilt",icon:"",aspectRatio:2.5,repeats:6,description:"Traditional kilt"},{id:"bag",name:"Tote Bag",icon:"",aspectRatio:.9,repeats:4,description:"Shopping tote"},{id:"flag",name:"Flag",icon:"",aspectRatio:1.5,repeats:5,description:"Banner flag"}],u=l.find(g=>g.id===s)||l[0];return N.useEffect(()=>{const g=o.current;if(!g)return;const m=g.getContext("2d");if(!m)return;const h=ut(c),v=Gt[t.weaveType],y=j=>{const _=Te(j);if(_)return _.hex;const k=r==null?void 0:r.find(S=>S.code.toUpperCase()===j.toUpperCase());return k?k.hex:"#808080"},b=300,x=u.aspectRatio>=1?b:b*u.aspectRatio,d=u.aspectRatio>=1?b/u.aspectRatio:b;g.width=x,g.height=d;const p=Math.max(x,d)/(h.length*u.repeats),f=Math.ceil(x/(h.length*p)),w=Math.ceil(d/(h.length*p));for(let j=0;j<w+1;j++)for(let _=0;_<f+1;_++)for(let k=0;k<h.length;k++)if(e.isBlanket){const S=h.threads[k%h.length];m.fillStyle=y(S);const C=_*h.length*p,R=(j*h.length+k)*p;R<d&&m.fillRect(C,R,h.length*p+.5,p+.5)}else for(let S=0;S<h.length;S++){const C=h.threads[S%h.length],R=h.threads[k%h.length],I=v.tieUp[k%v.treadling.length][S%v.threading.length]?C:R;m.fillStyle=y(I);const E=(_*h.length+S)*p,T=(j*h.length+k)*p;E<x&&T<d&&m.fillRect(E,T,p+.5,p+.5)}m.globalCompositeOperation="destination-in",m.fillStyle="#000",s==="tie"?(m.beginPath(),m.moveTo(x*.3,0),m.lineTo(x*.7,0),m.lineTo(x*.6,d*.15),m.lineTo(x*.55,d*.85),m.lineTo(x*.65,d),m.lineTo(x*.35,d),m.lineTo(x*.45,d*.85),m.lineTo(x*.4,d*.15),m.closePath(),m.fill()):s==="bowtie"?(m.beginPath(),m.moveTo(0,d*.3),m.quadraticCurveTo(x*.25,d*.5,0,d*.7),m.lineTo(0,d*.3),m.moveTo(x,d*.3),m.quadraticCurveTo(x*.75,d*.5,x,d*.7),m.lineTo(x,d*.3),m.rect(x*.4,d*.35,x*.2,d*.3),m.fill(),m.beginPath(),m.moveTo(0,d*.2),m.quadraticCurveTo(x*.2,d*.5,0,d*.8),m.quadraticCurveTo(x*.35,d*.5,0,d*.2),m.fill(),m.beginPath(),m.moveTo(x,d*.2),m.quadraticCurveTo(x*.8,d*.5,x,d*.8),m.quadraticCurveTo(x*.65,d*.5,x,d*.2),m.fill()):(m.beginPath(),m.roundRect(0,0,x,d,15),m.fill()),m.globalCompositeOperation="source-over",m.shadowColor="rgba(0,0,0,0.3)",m.shadowBlur=10,m.shadowOffsetX=5,m.shadowOffsetY=5},[c,t.weaveType,s,u,r,e.isBlanket]),i.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-gray-900 rounded-2xl w-full max-w-4xl max-h-[90vh] flex flex-col border border-gray-800",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:"Product Mockups"}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"See your tartan on real products"})]}),i.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsxs("div",{className:"grid md:grid-cols-[1fr_300px] gap-6",children:[i.jsx("div",{className:"flex items-center justify-center bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl p-8 min-h-[400px]",children:i.jsxs("div",{className:"relative",children:[i.jsx("canvas",{ref:o,className:"max-w-full max-h-[350px] rounded-lg shadow-2xl",style:{imageRendering:"auto"}}),i.jsx("div",{className:"absolute -bottom-6 left-1/2 -translate-x-1/2 text-center",children:i.jsx("span",{className:"text-4xl",children:u.icon})})]})}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-400 uppercase tracking-wide",children:"Select Product"}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:l.map(g=>i.jsxs("button",{onClick:()=>a(g.id),className:`p-3 rounded-lg text-left transition-all ${s===g.id?"bg-indigo-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white"}`,children:[i.jsx("span",{className:"text-xl mr-2",children:g.icon}),i.jsx("span",{className:"text-sm font-medium",children:g.name})]},g.id))}),i.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700 mt-4",children:[i.jsx("h4",{className:"font-medium text-white",children:u.name}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:u.description}),i.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Pattern repeats: ",u.repeats,""]})]}),i.jsx("button",{onClick:()=>{const g=o.current;g&&g.toBlob(m=>{if(!m)return;const h=URL.createObjectURL(m),v=document.createElement("a");v.href=h,v.download=`tartan-${u.id}-mockup.png`,v.click(),URL.revokeObjectURL(h)},"image/png")},className:"w-full btn-primary",children:"Download Mockup"})]})]})})]})})}function Pv({onClose:e,onColorsExtracted:t,onSaveAsYarn:r}){const[n,s]=N.useState(null),[a,o]=N.useState([]),[c,l]=N.useState(6),[u,g]=N.useState(null),[m,h]=N.useState(""),v=N.useRef(null),y=N.useRef(null),b=f=>{if(!m.trim())return;const w=a[f];r(w.hex,m.trim()),g(null),h("")},x=f=>{var _;const w=(_=f.target.files)==null?void 0:_[0];if(!w)return;const j=new FileReader;j.onload=k=>{var C;const S=(C=k.target)==null?void 0:C.result;s(S),d(S)},j.readAsDataURL(w)},d=f=>{const w=new Image;w.onload=()=>{const j=v.current;if(!j)return;const _=j.getContext("2d");if(!_)return;const k=100;j.width=k,j.height=k,_.drawImage(w,0,0,k,k);const C=_.getImageData(0,0,k,k).data,R=new Map,M=32;for(let T=0;T<C.length;T+=4){const D=Math.round(C[T]/M)*M,z=Math.round(C[T+1]/M)*M,re=Math.round(C[T+2]/M)*M,O=`#${D.toString(16).padStart(2,"0")}${z.toString(16).padStart(2,"0")}${re.toString(16).padStart(2,"0")}`;R.set(O,(R.get(O)||0)+1)}const I=Array.from(R.entries()).sort((T,D)=>D[1]-T[1]).slice(0,c*2).map(([T,D])=>({hex:T,count:D})),E=[];for(const T of I)if(E.every(z=>{const re=parseInt(T.hex.slice(1,3),16),O=parseInt(T.hex.slice(3,5),16),G=parseInt(T.hex.slice(5,7),16),K=parseInt(z.hex.slice(1,3),16),J=parseInt(z.hex.slice(3,5),16),ne=parseInt(z.hex.slice(5,7),16);return Math.abs(re-K)+Math.abs(O-J)+Math.abs(G-ne)>80})&&(E.push(T),E.length>=c))break;o(E)},w.src=f};N.useEffect(()=>{n&&d(n)},[c]),N.useEffect(()=>{if(a.length<2)return;const f=y.current;if(!f)return;const w=f.getContext("2d");if(!w)return;const j=150;f.width=j,f.height=j;const _=j/(a.length*2);for(let k=0;k<a.length*2;k++){const S=k%a.length;w.fillStyle=a[S].hex,w.fillRect(0,k*_,j,_),w.globalAlpha=.5,w.fillRect(k*_,0,_,j),w.globalAlpha=1}},[a]);const p=()=>{const f=a.map(w=>{let j="K",_=1/0;for(const[k,S]of Object.entries(yt)){const C=parseInt(w.hex.slice(1,3),16),R=parseInt(w.hex.slice(3,5),16),M=parseInt(w.hex.slice(5,7),16),I=Math.abs(C-S.rgb.r)+Math.abs(R-S.rgb.g)+Math.abs(M-S.rgb.b);I<_&&(_=I,j=k)}return j});t([...new Set(f)]),e()};return i.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-gray-900 rounded-2xl w-full max-w-2xl max-h-[90vh] flex flex-col border border-gray-800",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:"Extract Colors from Photo"}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Upload an image to create a tartan palette"})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[i.jsxs("div",{className:"border-2 border-dashed border-gray-700 rounded-xl p-8 text-center",children:[i.jsx("input",{type:"file",accept:"image/*",onChange:x,className:"hidden",id:"color-extract-upload"}),i.jsx("label",{htmlFor:"color-extract-upload",className:"cursor-pointer block",children:n?i.jsx("img",{src:n,alt:"Uploaded",className:"max-h-48 mx-auto rounded-lg"}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"text-4xl mb-3",children:""}),i.jsx("p",{className:"text-gray-400",children:"Click to upload a photo"}),i.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Nature, art, fashion - anything!"})]})})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Colors to Extract: ",c]}),i.jsx("input",{type:"range",min:"3",max:"8",value:c,onChange:f=>l(parseInt(f.target.value)),className:"slider w-full"})]}),a.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Extracted Palette - Click to save as yarn"}),i.jsx("div",{className:"flex gap-3 flex-wrap",children:a.map((f,w)=>i.jsxs("div",{className:"relative group",children:[i.jsx("div",{className:"w-14 h-14 rounded-lg shadow-lg border-2 border-gray-700 cursor-pointer hover:border-indigo-500 transition-all hover:scale-105",style:{backgroundColor:f.hex},title:`${f.hex} - Click to save as yarn`,onClick:()=>{g(w),h("")}}),u===w&&i.jsxs("div",{className:"absolute top-16 left-0 z-10 bg-gray-800 rounded-lg p-3 shadow-xl border border-gray-700 w-48",children:[i.jsx("input",{type:"text",placeholder:"Yarn name...",value:m,onChange:j=>h(j.target.value),className:"w-full px-2 py-1 bg-gray-900 border border-gray-600 rounded text-sm text-white mb-2",autoFocus:!0,onKeyDown:j=>{j.key==="Enter"&&b(w),j.key==="Escape"&&g(null)}}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>b(w),className:"flex-1 btn-primary text-xs py-1",disabled:!m.trim(),children:"Save"}),i.jsx("button",{onClick:()=>g(null),className:"flex-1 btn-secondary text-xs py-1",children:"Cancel"})]})]}),i.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity",children:i.jsx("span",{className:"text-[10px] bg-gray-800 px-1 rounded",children:"+yarn"})})]},w))})]}),a.length>=2&&i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Tartan Preview"}),i.jsx("canvas",{ref:y,className:"w-full aspect-square rounded-lg border border-gray-700",style:{imageRendering:"pixelated"}})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{onClick:p,className:"w-full btn-primary",children:"Apply to Generator"})})]}),i.jsx("canvas",{ref:v,className:"hidden"})]})]})})}const Lv=[{id:"normal",name:"Grid",icon:"",description:"Standard grid repeat"},{id:"brick",name:"Brick",icon:"",description:"Offset rows like bricks"},{id:"half-drop",name:"Half-Drop",icon:"",description:"Offset columns"},{id:"mirror",name:"Mirror",icon:"",description:"Reflect horizontally and vertically"},{id:"random",name:"Scatter",icon:"",description:"Random placement"}];function Ov({onClose:e,onCreatePattern:t}){const[r,n]=N.useState(null),[s,a]=N.useState({pixelSize:4,colorCount:8,repeatMode:"normal",tileScale:3}),[o,c]=N.useState(null),l=N.useRef(null),u=N.useRef(null),g=h=>{var b;const v=(b=h.target.files)==null?void 0:b[0];if(!v)return;const y=new FileReader;y.onload=x=>{var d;n((d=x.target)==null?void 0:d.result)},y.readAsDataURL(v)};N.useEffect(()=>{if(!r)return;const h=new Image;h.onload=()=>{const v=l.current;if(!v)return;const y=v.getContext("2d");if(!y)return;const b=48,x=h.width/h.height,d=x>=1?b:Math.round(b*x),p=x>=1?Math.round(b/x):b;v.width=d,v.height=p,y.drawImage(h,0,0,d,p);const f=y.getImageData(0,0,d,p),w=f.data,j=new Map,_=Math.round(256/Math.pow(s.colorCount,1/3)*2);for(let S=0;S<w.length;S+=4){const C=Math.round(w[S]/_)*_,R=Math.round(w[S+1]/_)*_,M=Math.round(w[S+2]/_)*_,I=`${C},${R},${M}`;j.set(I,(j.get(I)||0)+1)}const k=Array.from(j.entries()).sort((S,C)=>C[1]-S[1]).slice(0,s.colorCount).map(([S])=>S.split(",").map(Number));for(let S=0;S<w.length;S+=4){let C=1/0,R=k[0];for(const[M,I,E]of k){const T=Math.abs(w[S]-M)+Math.abs(w[S+1]-I)+Math.abs(w[S+2]-E);T<C&&(C=T,R=[M,I,E])}w[S]=R[0],w[S+1]=R[1],w[S+2]=R[2]}y.putImageData(f,0,0),c(v.toDataURL())},h.src=r},[r,s.colorCount]),N.useEffect(()=>{if(!o)return;const h=u.current;if(!h)return;const v=h.getContext("2d");if(!v)return;const y=new Image;y.onload=()=>{const b=y.width*s.pixelSize,x=y.height*s.pixelSize,d=300;h.width=d,h.height=d,v.imageSmoothingEnabled=!1;const p=Math.ceil(d/b)+1,f=Math.ceil(d/x)+1;for(let w=0;w<f;w++)for(let j=0;j<p;j++){let _=j*b,k=w*x,S=1,C=1;switch(s.repeatMode){case"brick":w%2===1&&(_+=b/2);break;case"half-drop":j%2===1&&(k+=x/2);break;case"mirror":j%2===1&&(S=-1),w%2===1&&(C=-1);break;case"random":_+=(Math.random()-.5)*20,k+=(Math.random()-.5)*20;break}v.save(),S===-1||C===-1?(v.translate(_+b/2,k+x/2),v.scale(S,C),v.drawImage(y,-b/2,-x/2,b,x)):v.drawImage(y,_,k,b,x),v.restore()}},y.src=o},[o,s.pixelSize,s.repeatMode]);const m=()=>{o&&(t(o,s),e())};return i.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-gray-900 rounded-2xl w-full max-w-3xl max-h-[90vh] flex flex-col border border-gray-800",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:" Image Pattern Builder"}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Convert any image to a tileable swatch pattern"})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[i.jsxs("div",{className:"border-2 border-dashed border-gray-700 rounded-xl p-6 text-center",children:[i.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"hidden",id:"pattern-image-upload"}),i.jsx("label",{htmlFor:"pattern-image-upload",className:"cursor-pointer block",children:r?i.jsxs("div",{className:"flex items-center justify-center gap-6",children:[i.jsx("img",{src:r,alt:"Original",className:"max-h-32 rounded-lg"}),i.jsx("div",{className:"text-2xl",children:""}),o&&i.jsx("img",{src:o,alt:"Processed",className:"h-32 rounded-lg border-2 border-indigo-500",style:{imageRendering:"pixelated"}})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"text-5xl mb-3",children:""}),i.jsx("p",{className:"text-gray-400",children:"Click to upload an image"}),i.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Photos, artwork, textures - anything!"})]})})]}),r&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Pixel Scale: ",s.pixelSize,"x"]}),i.jsx("input",{type:"range",min:"2",max:"8",value:s.pixelSize,onChange:h=>a(v=>({...v,pixelSize:parseInt(h.target.value)})),className:"slider w-full"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Colors: ",s.colorCount]}),i.jsx("input",{type:"range",min:"2",max:"16",value:s.colorCount,onChange:h=>a(v=>({...v,colorCount:parseInt(h.target.value)})),className:"slider w-full"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Tile Repeat Mode"}),i.jsx("div",{className:"grid grid-cols-5 gap-2",children:Lv.map(h=>i.jsxs("button",{onClick:()=>a(v=>({...v,repeatMode:h.id})),className:`p-3 rounded-lg border-2 transition-all ${s.repeatMode===h.id?"border-indigo-500 bg-indigo-900/30 text-white":"border-gray-700 text-gray-400 hover:border-gray-500"}`,title:h.description,children:[i.jsx("div",{className:"text-2xl mb-1",children:h.icon}),i.jsx("div",{className:"text-xs",children:h.name})]},h.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Pattern Preview"}),i.jsx("div",{className:"flex gap-4 items-start",children:i.jsx("canvas",{ref:u,className:"flex-1 rounded-lg border border-gray-700",style:{imageRendering:"pixelated"}})})]})]}),i.jsx("canvas",{ref:l,className:"hidden"})]}),i.jsx("div",{className:"p-6 border-t border-gray-800",children:i.jsx("button",{onClick:m,disabled:!o,className:`w-full py-3 rounded-lg font-medium transition-colors ${o?"bg-indigo-600 text-white hover:bg-indigo-500":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:"Add Pattern to Collection"})})]})})}const Bu=[{id:"deer",name:"Deer",category:"animals",pathData:"M50 15 L45 25 L40 20 L42 30 L35 35 L40 40 L35 55 L38 70 L35 85 L40 85 L43 75 L47 85 L50 85 L50 55 L50 85 L53 85 L57 75 L60 85 L65 85 L62 70 L65 55 L60 40 L65 35 L58 30 L60 20 L55 25 Z M42 28 Q40 26 42 24 M58 28 Q60 26 58 24"},{id:"eagle",name:"Eagle",category:"animals",pathData:"M50 20 L45 25 L40 22 L48 30 L35 40 L15 45 L20 48 L10 55 L25 52 L35 50 L45 48 L50 50 L55 48 L65 50 L75 52 L90 55 L80 48 L85 45 L65 40 L52 30 L60 22 L55 25 Z M50 50 L45 65 L48 80 L50 75 L52 80 L55 65 Z"},{id:"wolf",name:"Wolf",category:"animals",pathData:"M30 35 L25 25 L30 30 L35 20 L40 30 L45 28 L50 25 L55 28 L60 30 L65 20 L70 30 L75 25 L70 35 L75 50 L70 65 L65 80 L50 85 L35 80 L30 65 L25 50 Z M38 40 Q36 38 38 36 M62 40 Q64 38 62 36 M45 55 L50 60 L55 55"},{id:"bear",name:"Bear",category:"animals",pathData:"M35 30 Q30 25 30 30 Q28 28 32 32 L30 40 L25 55 L30 70 L40 82 L50 85 L60 82 L70 70 L75 55 L70 40 L68 32 Q72 28 70 30 Q70 25 65 30 L60 28 L50 25 L40 28 Z M40 45 Q38 43 40 41 M60 45 Q62 43 60 41 M50 55 Q48 58 50 60 Q52 58 50 55"},{id:"buffalo",name:"Buffalo",category:"animals",pathData:"M25 35 Q20 30 22 35 L20 45 Q15 40 18 48 L25 50 L20 65 L25 80 L35 85 L50 87 L65 85 L75 80 L80 65 L75 50 L82 48 Q85 40 80 45 L78 35 Q80 30 75 35 L70 30 L50 25 L30 30 Z M35 45 Q33 43 35 41 M65 45 Q67 43 65 41"},{id:"tree",name:"Pine Tree",category:"nature",pathData:"M50 10 L35 35 L42 35 L30 55 L40 55 L25 75 L45 75 L45 90 L55 90 L55 75 L75 75 L60 55 L70 55 L58 35 L65 35 Z"},{id:"mountain",name:"Mountain",category:"nature",pathData:"M10 80 L30 40 L40 55 L50 25 L60 55 L70 40 L90 80 Z M50 25 L55 35 L45 35 Z"},{id:"sun",name:"Sun",category:"nature",pathData:"M50 35 Q35 35 35 50 Q35 65 50 65 Q65 65 65 50 Q65 35 50 35 M50 15 L50 25 M50 75 L50 85 M15 50 L25 50 M75 50 L85 50 M25 25 L32 32 M68 68 L75 75 M75 25 L68 32 M32 68 L25 75"},{id:"moon",name:"Moon",category:"nature",pathData:"M55 20 Q35 25 35 50 Q35 75 55 80 Q40 70 40 50 Q40 30 55 20"},{id:"feather",name:"Feather",category:"nature",pathData:"M50 10 L48 90 M50 10 Q35 30 40 35 Q48 32 48 40 Q35 45 38 52 Q48 48 48 55 Q32 60 36 68 Q48 62 48 72 Q30 78 35 85 Q48 78 48 90 M50 10 Q65 30 60 35 Q52 32 52 40 Q65 45 62 52 Q52 48 52 55 Q68 60 64 68 Q52 62 52 72 Q70 78 65 85 Q52 78 52 90"},{id:"arrow-up",name:"Arrow Up",category:"geometric",pathData:"M50 15 L25 50 L40 50 L40 85 L60 85 L60 50 L75 50 Z"},{id:"arrow-right",name:"Arrow Right",category:"geometric",pathData:"M15 50 L50 25 L50 40 L85 40 L85 60 L50 60 L50 75 Z"},{id:"diamond",name:"Diamond",category:"geometric",pathData:"M50 10 L90 50 L50 90 L10 50 Z M50 25 L75 50 L50 75 L25 50 Z"},{id:"cross",name:"Cross",category:"geometric",pathData:"M40 10 L60 10 L60 40 L90 40 L90 60 L60 60 L60 90 L40 90 L40 60 L10 60 L10 40 L40 40 Z"},{id:"star",name:"Star",category:"geometric",pathData:"M50 10 L58 38 L90 38 L64 56 L74 85 L50 68 L26 85 L36 56 L10 38 L42 38 Z"},{id:"hexagon",name:"Hexagon",category:"geometric",pathData:"M50 10 L85 30 L85 70 L50 90 L15 70 L15 30 Z"},{id:"thunderbird",name:"Thunderbird",category:"native",pathData:"M50 15 L40 25 L30 22 L35 30 L20 35 L10 40 L20 45 L10 55 L25 50 L35 55 L40 50 L50 52 L60 50 L65 55 L75 50 L90 55 L80 45 L90 40 L80 35 L65 30 L70 22 L60 25 Z M50 52 L45 70 L48 80 L50 75 L52 80 L55 70 Z M40 65 L35 75 L40 70 M60 65 L65 75 L60 70"},{id:"step-pattern",name:"Steps",category:"native",pathData:"M10 90 L10 70 L25 70 L25 55 L40 55 L40 40 L60 40 L60 55 L75 55 L75 70 L90 70 L90 90 Z"},{id:"wave",name:"Wave",category:"native",pathData:"M5 50 Q20 30 35 50 Q50 70 65 50 Q80 30 95 50 Q80 30 65 50 Q50 70 35 50 Q20 30 5 50 M5 65 Q20 45 35 65 Q50 85 65 65 Q80 45 95 65"},{id:"zigzag",name:"Zigzag",category:"native",pathData:"M5 70 L20 30 L35 70 L50 30 L65 70 L80 30 L95 70 M5 85 L20 45 L35 85 L50 45 L65 85 L80 45 L95 85"}];function Mv({onClose:e,onCreatePattern:t}){const[r,n]=N.useState(Bu[0]),[s,a]=N.useState("#FFFFFF"),[o,c]=N.useState("#1a1a2e"),[l,u]=N.useState("#4a4a6e"),[g,m]=N.useState(.6),[h,v]=N.useState("animals"),[y,b]=N.useState(!1),[x,d]=N.useState(!0),p=N.useRef(null),f=[{id:"animals",name:"Animals",icon:""},{id:"nature",name:"Nature",icon:""},{id:"geometric",name:"Geometric",icon:""},{id:"native",name:"Native",icon:""}],w=[{name:"Classic Red",bg:"#8B0000",secondary:"#D2691E",motif:"#FFFAF0"},{name:"Forest",bg:"#1B4332",secondary:"#2D6A4F",motif:"#D8F3DC"},{name:"Desert",bg:"#BC6C25",secondary:"#DDA15E",motif:"#FEFAE0"},{name:"Ocean",bg:"#023E8A",secondary:"#0077B6",motif:"#CAF0F8"},{name:"Night",bg:"#1a1a2e",secondary:"#4a4a6e",motif:"#FFFFFF"},{name:"Earth",bg:"#5C4033",secondary:"#8B4513",motif:"#F5DEB3"}];N.useEffect(()=>{const k=p.current;if(!k)return;const S=k.getContext("2d");if(!S)return;const C=300;if(k.width=C,k.height=C,x){const I=C/10;for(let E=0;E<10;E++)S.fillStyle=E%2===0?o:l,S.fillRect(0,E*I,C,I);S.fillStyle=s+"40",S.fillRect(0,I*2,C,I/2),S.fillRect(0,I*7,C,I/2)}else S.fillStyle=o,S.fillRect(0,0,C,C);const R=(I,E,T,D=!1)=>{S.save(),S.translate(I,E),D&&S.scale(-1,1),S.scale(T,T),S.translate(-50,-50);const z=new Path2D(r.pathData);S.fillStyle=s,S.fill(z),S.strokeStyle=s,S.lineWidth=1/T,S.stroke(z),S.restore()},M=C*g;if(y){const I=M*1.2,E=Math.ceil(C/I)+1,T=Math.ceil(C/I)+1;for(let D=0;D<T;D++)for(let z=0;z<E;z++){const re=z*I+(D%2?I/2:0),O=D*I;R(re,O,g*.5,z%2===1)}}else R(C/2,C/2,g)},[r,s,o,l,g,y,x]);const j=()=>{const k=p.current;k&&t(k.toDataURL(),`${r.name} Pattern`)},_=k=>{c(k.bg),u(k.secondary),a(k.motif)};return i.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-gray-900 rounded-2xl w-full max-w-4xl max-h-[90vh] flex flex-col border border-gray-800",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:" Illustrated Motifs"}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Add Pendleton-style illustrations to your patterns"})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"space-y-5",children:[i.jsx("div",{className:"flex gap-2",children:f.map(k=>i.jsxs("button",{onClick:()=>v(k.id),className:`px-3 py-2 rounded-lg transition-colors ${h===k.id?"bg-indigo-600 text-white":"bg-gray-800 text-gray-400 hover:text-white"}`,children:[k.icon," ",k.name]},k.id))}),i.jsx("div",{className:"grid grid-cols-4 gap-2",children:Bu.filter(k=>k.category===h).map(k=>i.jsxs("button",{onClick:()=>n(k),className:`p-3 rounded-lg border-2 transition-all ${r.id===k.id?"border-indigo-500 bg-indigo-950":"border-gray-700 bg-gray-800 hover:border-gray-600"}`,children:[i.jsx("svg",{viewBox:"0 0 100 100",className:"w-full h-12",children:i.jsx("path",{d:k.pathData,fill:"currentColor",className:"text-gray-300"})}),i.jsx("span",{className:"text-xs text-gray-400 block mt-1",children:k.name})]},k.id))}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Color Presets"}),i.jsx("div",{className:"flex gap-2 flex-wrap",children:w.map(k=>i.jsxs("button",{onClick:()=>_(k),className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-800 hover:bg-gray-700 transition-colors",children:[i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"w-4 h-4 rounded-l",style:{backgroundColor:k.bg}}),i.jsx("div",{className:"w-4 h-4",style:{backgroundColor:k.secondary}}),i.jsx("div",{className:"w-4 h-4 rounded-r",style:{backgroundColor:k.motif}})]}),i.jsx("span",{className:"text-xs text-gray-400",children:k.name})]},k.name))})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Background"}),i.jsx("input",{type:"color",value:o,onChange:k=>c(k.target.value),className:"w-full h-10 rounded cursor-pointer"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Stripe"}),i.jsx("input",{type:"color",value:l,onChange:k=>u(k.target.value),className:"w-full h-10 rounded cursor-pointer"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Motif"}),i.jsx("input",{type:"color",value:s,onChange:k=>a(k.target.value),className:"w-full h-10 rounded cursor-pointer"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Motif Scale: ",Math.round(g*100),"%"]}),i.jsx("input",{type:"range",min:"0.2",max:"1",step:"0.05",value:g,onChange:k=>m(parseFloat(k.target.value)),className:"slider w-full"})]}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:x,onChange:k=>d(k.target.checked),className:"w-4 h-4 rounded"}),i.jsx("span",{className:"text-sm text-gray-300",children:"Striped Background"})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:y,onChange:k=>b(k.target.checked),className:"w-4 h-4 rounded"}),i.jsx("span",{className:"text-sm text-gray-300",children:"Repeat Pattern"})]})]})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("canvas",{ref:p,className:"rounded-xl border border-gray-700 shadow-lg",style:{width:300,height:300}}),i.jsxs("p",{className:"text-sm text-gray-500 mt-3 text-center",children:[r.name," on ",x?"striped":"solid"," background"]})]})]})}),i.jsx("div",{className:"p-6 border-t border-gray-800",children:i.jsx("button",{onClick:j,className:"w-full btn-primary",children:"Add to Collection"})})]})})}const Av=[{id:"stripes",name:"Blanket Stripes",icon:"",description:"Classic horizontal banding"},{id:"diamonds",name:"Diamonds",icon:"",description:"Centered diamond motifs"},{id:"chevron",name:"Chevron",icon:"",description:"Arrow/chevron bands"},{id:"steps",name:"Steps",icon:"",description:"Stair-step pattern"},{id:"arrows",name:"Arrows",icon:"",description:"Directional arrow motifs"},{id:"zigzag",name:"ZigZag",icon:"",description:"Dynamic zigzag lines"},{id:"bands",name:"Wide Bands",icon:"",description:"Bold color blocks"}],Gi={"Chief Joseph":["R","Y","K","W","DB"],"Glacier Park":["R","K","Y","G"],"San Miguel":["T","R","K","Y","W"],"Sante Fe":["T","K","R","O","Y"],Sunset:["R","O","Y","K","W"],Earth:["BR","K","W","R","G"],Ocean:["DB","T","W","K","B"],Desert:["BR","O","Y","R","K"]};function Iv({onClose:e,onCreatePattern:t}){const[r,n]=N.useState("stripes"),[s,a]=N.useState("Chief Joseph"),[o,c]=N.useState(3),[l,u]=N.useState(!0),g=N.useRef(null),[m,h]=N.useState(""),v=Gi[s]||Gi["Chief Joseph"],y=N.useCallback(()=>{const x=[],d=8+o*4;switch(r){case"stripes":for(let w=0;w<o*2+3;w++){const j=v[w%v.length],_=w%3===0?d*2:d/2;x.push({color:j,count:Math.round(_)})}break;case"diamonds":const f=Math.ceil(o*1.5);for(let w=0;w<f;w++){const j=v[w%v.length],_=d-w*2;x.push({color:j,count:Math.max(4,_)})}if(l)for(let w=f-2;w>=0;w--)x.push({...x[w]});break;case"chevron":for(let w=0;w<o+2;w++)x.push({color:v[0],count:4}),x.push({color:v[w%v.length],count:d}),x.push({color:v[0],count:4});break;case"steps":for(let w=0;w<o+2;w++){const j=4+w*4;x.push({color:v[w%v.length],count:j}),x.push({color:"K",count:2})}break;case"arrows":x.push({color:v[0],count:d*2});for(let w=0;w<o+1;w++)x.push({color:v[1],count:4}),x.push({color:v[2],count:d-w*2}),x.push({color:v[1],count:4});x.push({color:v[0],count:d*2});break;case"zigzag":for(let w=0;w<(o+2)*2;w++){const _=w%2===0?4+w%4*4:16-w%4*4;x.push({color:v[w%v.length],count:Math.max(4,_)})}break;case"bands":for(let w=0;w<o+2;w++)x.push({color:v[w%v.length],count:d*2}),x.push({color:"K",count:4});break}x.map((f,w)=>{const j=w===0,_=w===x.length-1,k=j&&l?`${f.color}/`:f.color,S=_&&l?`/${f.count}`:f.count.toString();return j&&l?`${k}${S}`:_&&l?`${f.color}/${S}`:`${f.color}${f.count}`}).join(" ");let p=x.map(f=>`${f.color}${f.count}`).join(" ");if(l&&x.length>0){const f=x[0],w=x[x.length-1];p=`${f.color}/${f.count} ${x.slice(1,-1).map(j=>`${j.color}${j.count}`).join(" ")} ${w.color}/${w.count}`}return h(p),p},[r,v,o,l]);N.useEffect(()=>{y();const x=g.current;if(!x)return;const d=x.getContext("2d");if(!d)return;const p=200;x.width=p,x.height=p;const f=w=>{const j=Te(w);return(j==null?void 0:j.hex)||"#808080"};switch(d.fillStyle=f(v[0]),d.fillRect(0,0,p,p),r){case"stripes":const w=p/(o*2+4);for(let E=0;E<o*2+4;E++){d.fillStyle=f(v[E%v.length]);const T=E%3===0?w*2:w*.5;d.fillRect(0,E*w,p,T+1)}break;case"diamonds":const j=o+2;for(let E=j;E>=0;E--){const T=p/2*(E/j);d.fillStyle=f(v[E%v.length]),d.beginPath(),d.moveTo(p/2,p/2-T),d.lineTo(p/2+T,p/2),d.lineTo(p/2,p/2+T),d.lineTo(p/2-T,p/2),d.closePath(),d.fill()}break;case"chevron":const _=p/(o+3);for(let E=0;E<o+3;E++){d.fillStyle=f(v[E%v.length]),d.beginPath();const T=E*_,D=(E+1)*_;d.moveTo(0,T),d.lineTo(p/2,T+_/2),d.lineTo(p,T),d.lineTo(p,D),d.lineTo(p/2,D+_/2),d.lineTo(0,D),d.closePath(),d.fill()}break;case"steps":const k=p/(o+3);for(let E=0;E<o+3;E++){d.fillStyle=f(v[E%v.length]);for(let T=0;T<=E;T++)d.fillRect(T*k,E*k,k+1,k+1),d.fillRect(p-(T+1)*k,E*k,k+1,k+1)}break;case"arrows":const S=o+2,C=p/S;for(let E=0;E<S;E++){d.fillStyle=f(v[E%v.length]);const T=E*C,D=p*(.3+E%3*.2);d.beginPath(),d.moveTo(p/2,T),d.lineTo(p/2+D/2,T+C),d.lineTo(p/2-D/2,T+C),d.closePath(),d.fill()}break;case"zigzag":const R=p/(o+2),M=p/4;for(let E=0;E<4;E++)for(let T=0;T<o+2;T++){d.fillStyle=f(v[(E+T)%v.length]),d.beginPath();const D=T*R,z=E*M,re=E%2===0?0:R/2;d.moveTo(D+re,z),d.lineTo(D+R/2+re,z+M),d.lineTo(D+re,z+M),d.closePath(),d.fill()}break;case"bands":const I=p/(o+2);for(let E=0;E<o+2;E++)d.fillStyle=f(v[E%v.length]),d.fillRect(0,E*I,p,I-4),d.fillStyle=f("K"),d.fillRect(0,(E+1)*I-4,p,4);break}d.strokeStyle="#333",d.lineWidth=2,d.strokeRect(0,0,p,p)},[r,s,o,l,v,y]);const b=()=>{const x=g.current;if(!x)return;const d={stripes:"Blanket Stripes",diamonds:"Diamond Pattern",chevron:"Chevron Pattern",steps:"Step Pattern",arrows:"Arrow Pattern",zigzag:"Zigzag Pattern",bands:"Band Pattern"};t(x.toDataURL(),`${d[r]} (${s})`),e()};return i.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-gray-900 rounded-2xl w-full max-w-3xl max-h-[90vh] flex flex-col border border-gray-800",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:"Geometric Pattern Builder"}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create Pendleton-style blanket patterns"})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-3 block",children:"Pattern Style"}),i.jsx("div",{className:"grid grid-cols-4 gap-2",children:Av.map(x=>i.jsxs("button",{onClick:()=>n(x.id),className:`p-3 rounded-lg text-center transition-all ${r===x.id?"bg-indigo-600 text-white ring-2 ring-indigo-400":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:[i.jsx("div",{className:"text-2xl mb-1",children:x.icon}),i.jsx("div",{className:"text-xs",children:x.name})]},x.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-3 block",children:"Color Palette"}),i.jsx("div",{className:"grid grid-cols-4 gap-2",children:Object.entries(Gi).map(([x,d])=>i.jsxs("button",{onClick:()=>a(x),className:`p-2 rounded-lg transition-all ${s===x?"ring-2 ring-indigo-400":"hover:ring-1 hover:ring-gray-600"}`,children:[i.jsx("div",{className:"flex gap-0.5 mb-1 justify-center",children:d.slice(0,4).map((p,f)=>{const w=Te(p);return i.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:(w==null?void 0:w.hex)||"#808080"}},f)})}),i.jsx("div",{className:"text-xs text-gray-400",children:x})]},x))})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Complexity: ",o]}),i.jsx("input",{type:"range",min:"1",max:"5",value:o,onChange:x=>c(parseInt(x.target.value)),className:"slider w-full"}),i.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[i.jsx("span",{children:"Simple"}),i.jsx("span",{children:"Complex"})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:()=>u(!l),className:`px-4 py-2 rounded-lg transition-all ${l?"bg-indigo-600 text-white":"bg-gray-800 text-gray-400"}`,children:"Symmetric (Mirror)"}),i.jsx("span",{className:"text-sm text-gray-500",children:l?"Pattern reflects at center":"Pattern repeats directly"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Preview"}),i.jsx("canvas",{ref:g,className:"w-full aspect-square rounded-lg border border-gray-700",style:{imageRendering:"auto"}})]}),i.jsxs("div",{className:"flex flex-col justify-between",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Threadcount"}),i.jsx("div",{className:"bg-gray-800 p-3 rounded-lg font-mono text-xs text-gray-300 break-all",children:m||"Generating..."})]}),i.jsx("button",{onClick:b,className:"btn-primary w-full",disabled:!m,children:"Add to Collection"})]})]})]})]})})}const $u=[{id:"cable4",name:"4-Stitch Cable",symbol:"",description:"Classic rope cable",width:6,height:8,chart:[["purl","cable4f","cable4f","cable4f","cable4f","purl"],["purl","knit","knit","knit","knit","purl"],["purl","knit","knit","knit","knit","purl"],["purl","knit","knit","knit","knit","purl"],["purl","cable4b","cable4b","cable4b","cable4b","purl"],["purl","knit","knit","knit","knit","purl"],["purl","knit","knit","knit","knit","purl"],["purl","knit","knit","knit","knit","purl"]]},{id:"honeycomb",name:"Honeycomb",symbol:"",description:"Interlocking diamond texture",width:8,height:8,chart:[["cable4f","cable4f","cable4f","cable4f","cable4b","cable4b","cable4b","cable4b"],["knit","knit","knit","knit","knit","knit","knit","knit"],["knit","knit","knit","knit","knit","knit","knit","knit"],["knit","knit","knit","knit","knit","knit","knit","knit"],["cable4b","cable4b","cable4b","cable4b","cable4f","cable4f","cable4f","cable4f"],["knit","knit","knit","knit","knit","knit","knit","knit"],["knit","knit","knit","knit","knit","knit","knit","knit"],["knit","knit","knit","knit","knit","knit","knit","knit"]]},{id:"moss",name:"Moss Stitch",symbol:"",description:"Textured seed pattern",width:4,height:4,chart:[["knit","purl","knit","purl"],["purl","knit","purl","knit"],["purl","knit","purl","knit"],["knit","purl","knit","purl"]]},{id:"trinity",name:"Trinity/Blackberry",symbol:"",description:"Bobble texture stitch",width:4,height:4,chart:[["trinity","purl","trinity","purl"],["purl","purl","purl","purl"],["purl","trinity","purl","trinity"],["purl","purl","purl","purl"]]},{id:"basket",name:"Basket Weave",symbol:"",description:"Woven texture pattern",width:8,height:8,chart:[["knit","knit","knit","knit","purl","purl","purl","purl"],["knit","knit","knit","knit","purl","purl","purl","purl"],["knit","knit","knit","knit","purl","purl","purl","purl"],["knit","knit","knit","knit","purl","purl","purl","purl"],["purl","purl","purl","purl","knit","knit","knit","knit"],["purl","purl","purl","purl","knit","knit","knit","knit"],["purl","purl","purl","purl","knit","knit","knit","knit"],["purl","purl","purl","purl","knit","knit","knit","knit"]]},{id:"diamond",name:"Diamond Cable",symbol:"",description:"Diamond lattice pattern",width:12,height:12,chart:[["purl","purl","purl","purl","purl","cable4f","cable4f","purl","purl","purl","purl","purl"],["purl","purl","purl","purl","cable4b","purl","purl","cable4f","purl","purl","purl","purl"],["purl","purl","purl","cable4b","purl","purl","purl","purl","cable4f","purl","purl","purl"],["purl","purl","cable4b","purl","purl","purl","purl","purl","purl","cable4f","purl","purl"],["purl","cable4b","purl","purl","purl","purl","purl","purl","purl","purl","cable4f","purl"],["cable4b","purl","purl","purl","purl","purl","purl","purl","purl","purl","purl","cable4f"],["cable4f","purl","purl","purl","purl","purl","purl","purl","purl","purl","purl","cable4b"],["purl","cable4f","purl","purl","purl","purl","purl","purl","purl","purl","cable4b","purl"],["purl","purl","cable4f","purl","purl","purl","purl","purl","purl","cable4b","purl","purl"],["purl","purl","purl","cable4f","purl","purl","purl","purl","cable4b","purl","purl","purl"],["purl","purl","purl","purl","cable4f","purl","purl","cable4b","purl","purl","purl","purl"],["purl","purl","purl","purl","purl","cable4f","cable4b","purl","purl","purl","purl","purl"]]}],Du={knit:{symbol:"",color:"#f5f5f5",name:"Knit"},purl:{symbol:"",color:"#d4d4d4",name:"Purl"},cable4f:{symbol:"",color:"#818cf8",name:"Cable 4 Front"},cable4b:{symbol:"",color:"#a78bfa",name:"Cable 4 Back"},cable6f:{symbol:"",color:"#6366f1",name:"Cable 6 Front"},cable6b:{symbol:"",color:"#8b5cf6",name:"Cable 6 Back"},moss:{symbol:"",color:"#86efac",name:"Moss"},seed:{symbol:"",color:"#a7f3d0",name:"Seed"},honeycomb:{symbol:"",color:"#fcd34d",name:"Honeycomb"},trinity:{symbol:"",color:"#f9a8d4",name:"Trinity"},basket:{symbol:"",color:"#c4b5fd",name:"Basket"}};function Bv({onClose:e}){const[t,r]=N.useState(["cable4"]),[n,s]=N.useState(3),[a,o]=N.useState(!0),c=N.useRef(null),l=N.useRef(null),u=N.useCallback(()=>{const m=t.map(b=>$u.find(x=>x.id===b)).filter(Boolean);if(m.length===0)return{chart:[],width:0,height:0};const h=Math.max(...m.map(b=>b.height)),v=m.reduce((b,x)=>b+x.width+2,0)-2,y=[];for(let b=0;b<h;b++){const x=[];for(let d=0;d<m.length;d++){const p=m[d],f=b%p.height;x.push(...p.chart[f]),d<m.length-1&&x.push("purl","purl")}y.push(x)}return{chart:y,width:v,height:h}},[t]);N.useEffect(()=>{const m=c.current;if(!m)return;const h=m.getContext("2d");if(!h)return;const{chart:v,width:y,height:b}=u();if(v.length===0)return;const x=20;m.width=y*x,m.height=b*x;for(let d=0;d<b;d++)for(let p=0;p<y;p++){const f=v[d][p],w=Du[f],j=p*x,_=d*x;h.fillStyle=w.color,h.fillRect(j,_,x,x),h.strokeStyle="#666",h.lineWidth=.5,h.strokeRect(j,_,x,x),h.fillStyle="#333",h.font="bold 14px monospace",h.textAlign="center",h.textBaseline="middle",h.fillText(w.symbol,j+x/2,_+x/2)}h.fillStyle="#888",h.font="10px sans-serif";for(let d=0;d<b;d++)h.fillText(`${b-d}`,-12,d*x+x/2)},[t,u]),N.useEffect(()=>{const m=l.current;if(!m)return;const h=m.getContext("2d");if(!h)return;const{chart:v,width:y,height:b}=u();if(v.length===0)return;const x=200;m.width=x,m.height=x;const d=x/y,p=x/b;h.fillStyle="#f5f0e6",h.fillRect(0,0,x,x);for(let j=0;j<b;j++)for(let _=0;_<y;_++){const k=v[j%b][_],S=_*d,C=j*p;(k==="purl"||k.includes("cable"))&&(h.fillStyle="rgba(0,0,0,0.15)",h.fillRect(S,C,d,p*.3),h.fillStyle="rgba(255,255,255,0.2)",h.fillRect(S,C+p*.7,d,p*.3)),k.includes("cable")&&(h.fillStyle="rgba(0,0,0,0.1)",k.includes("f")?(h.beginPath(),h.moveTo(S,C),h.lineTo(S+d,C+p),h.lineTo(S+d,C),h.fill()):(h.beginPath(),h.moveTo(S+d,C),h.lineTo(S,C+p),h.lineTo(S,C),h.fill())),k==="trinity"&&(h.fillStyle="rgba(0,0,0,0.1)",h.beginPath(),h.arc(S+d/2,C+p/2,d*.4,0,Math.PI*2),h.fill())}const f=document.createElement("canvas");f.width=x,f.height=x;const w=f.getContext("2d");w&&(w.drawImage(m,0,0),h.drawImage(f,0,0,x/2,x/2),h.drawImage(f,x/2,0,x/2,x/2),h.drawImage(f,0,x/2,x/2,x/2),h.drawImage(f,x/2,x/2,x/2,x/2))},[t,u]);const g=m=>{r(h=>h.includes(m)?h.filter(v=>v!==m):h.length<n?[...h,m]:h)};return i.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-gray-900 rounded-2xl w-full max-w-4xl max-h-[90vh] flex flex-col border border-gray-800",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:"Knitting Chart Builder"}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create Aran/Irish cable patterns"})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm text-gray-400 mb-3 block",children:["Select Stitch Patterns (up to ",n,")"]}),i.jsx("div",{className:"grid grid-cols-3 gap-2",children:$u.map(m=>i.jsx("button",{onClick:()=>g(m.id),className:`p-3 rounded-lg text-left transition-all ${t.includes(m.id)?"bg-indigo-600 text-white ring-2 ring-indigo-400":"bg-gray-800 text-gray-300 hover:bg-gray-700"} ${t.length>=n&&!t.includes(m.id)?"opacity-50":""}`,disabled:t.length>=n&&!t.includes(m.id),children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-xl",children:m.symbol}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-sm",children:m.name}),i.jsx("div",{className:"text-xs opacity-70",children:m.description})]})]})},m.id))})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm text-gray-400 mb-2 block",children:["Panel Count: ",n]}),i.jsx("input",{type:"range",min:"1",max:"5",value:n,onChange:m=>{const h=parseInt(m.target.value);s(h),t.length>h&&r(v=>v.slice(0,h))},className:"slider w-full"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("label",{className:"text-sm text-gray-400",children:"Stitch Chart"}),i.jsxs("button",{onClick:()=>o(!a),className:"text-xs text-indigo-400 hover:text-indigo-300",children:[a?"Hide":"Show"," Key"]})]}),i.jsx("div",{className:"bg-gray-800 rounded-lg p-4 overflow-auto max-h-64",children:i.jsx("canvas",{ref:c,className:"mx-auto",style:{imageRendering:"pixelated"}})}),a&&i.jsx("div",{className:"mt-3 grid grid-cols-2 gap-1 text-xs",children:Object.entries(Du).slice(0,6).map(([m,h])=>i.jsxs("div",{className:"flex items-center gap-1 text-gray-400",children:[i.jsx("span",{className:"w-5 h-5 flex items-center justify-center rounded text-sm",style:{backgroundColor:h.color,color:"#333"},children:h.symbol}),i.jsx("span",{children:h.name})]},m))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Knitted Preview"}),i.jsx("canvas",{ref:l,className:"w-full aspect-square rounded-lg border border-gray-700"}),i.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Simulated Aran sweater texture"})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>{const m=c.current;if(!m)return;const h=document.createElement("a");h.download="knitting-chart.png",h.href=m.toDataURL("image/png"),h.click()},className:"btn-primary flex-1",children:"Download Chart"}),i.jsx("button",{onClick:()=>{const m=l.current;if(!m)return;const h=document.createElement("a");h.download="knitted-preview.png",h.href=m.toDataURL("image/png"),h.click()},className:"btn-secondary flex-1",children:"Download Preview"})]})]})]})})}const Yo=[{name:"Royal Stewart",threadcount:"R/72 G4 R2 K24 Y2 K24 W2 K2 Y2 K32 W2 B/24",category:"Royal",description:"Official tartan of the Royal House of Stewart",popularity:100},{name:"Black Watch",threadcount:"K/4 B4 K4 B4 K20 G24 K6 G24 K20 B22 K/4",category:"Military",description:"Military regiment (42nd Highland) since 1739",popularity:98},{name:"MacLeod of Lewis",threadcount:"Y/24 K4 Y/24",category:"Clan",description:"Distinctive bright yellow tartan of Clan MacLeod",popularity:95},{name:"Campbell of Argyll",threadcount:"K/2 B6 K6 G28 K6 B6 K4 W4 Y4 W/4",category:"Clan",description:"Clan Campbell of Argyll",popularity:93},{name:"MacDonald",threadcount:"R/8 G32 R6 G32 B32 R/8",category:"Clan",description:"Lords of the Isles",popularity:92},{name:"Gordon",threadcount:"B/2 K2 B2 K6 G28 K28 Y/6",category:"Clan",description:"Clan Gordon of Aberdeenshire",popularity:90},{name:"Buchanan",threadcount:"Y/4 R8 Y4 R2 K4 R2 W2 G24 R4 G24 W2 R2 K4 R2 Y/4",category:"Clan",description:"Clan Buchanan",popularity:88},{name:"Cameron of Erracht",threadcount:"R/4 G48 R6 G4 R6 G48 Y4 B6 Y4 G48 R6 G4 R6 G48 R/4",category:"Clan",description:"Clan Cameron war tartan",popularity:87},{name:"Fraser",threadcount:"R/4 G32 R8 G4 R8 G32 W4 B4 W/4",category:"Clan",description:"Clan Fraser of Lovat",popularity:86},{name:"MacKenzie",threadcount:"B/12 G28 B2 G2 B2 K4 R4 K4 W/2",category:"Clan",description:"Clan MacKenzie",popularity:85},{name:"Stewart of Atholl",threadcount:"B/6 K2 B6 K32 R6 K32 B6 K2 B/6",category:"Clan",description:"Ancient Stewart variant",popularity:84},{name:"Douglas",threadcount:"G/4 B4 G4 B24 K24 B4 W4 B4 K24 B24 G4 B4 G/4",category:"Clan",description:"Grey Douglas tartan",popularity:83},{name:"Wallace",threadcount:"K/2 Y6 K6 R48 K8 Y8 K8 R48 K6 Y6 K/2",category:"Clan",description:"Clan Wallace - Red Wallace",popularity:82},{name:"Lindsay",threadcount:"R/8 B24 R4 B2 R4 G24 R4 G2 R4 B24 R/8",category:"Clan",description:"Clan Lindsay",popularity:81},{name:"Murray of Atholl",threadcount:"G/4 K2 G4 K32 B4 K32 G4 K2 G/4",category:"Clan",description:"Clan Murray",popularity:80},{name:"MacGregor",threadcount:"R/8 G8 R8 G28 K4 G28 R8 G8 R/8",category:"Clan",description:"Clan MacGregor - Rob Roy",popularity:79},{name:"MacLean of Duart",threadcount:"B/2 K6 B6 K6 G48 K6 R6 K/6",category:"Clan",description:"Clan MacLean",popularity:78},{name:"MacPherson",threadcount:"R/4 K4 R4 K4 B24 K4 G24 K4 B24 K4 R4 K4 R/4",category:"Clan",description:"Clan MacPherson",popularity:77},{name:"Robertson",threadcount:"R/4 G2 R48 G28 B4 G28 R48 G2 R/4",category:"Clan",description:"Clan Robertson (Donnachaidh)",popularity:76},{name:"Sinclair",threadcount:"R/4 G32 R8 G32 B8 K4 Y4 K4 B8 G32 R8 G32 R/4",category:"Clan",description:"Clan Sinclair",popularity:75},{name:"Forbes",threadcount:"G/4 W2 G24 B24 G4 B24 G24 W2 G/4",category:"Clan",description:"Clan Forbes",popularity:74},{name:"Grant",threadcount:"R/4 K4 R4 K24 B24 K24 R4 K4 R/4",category:"Clan",description:"Clan Grant",popularity:73},{name:"Ross",threadcount:"R/4 G32 K4 W2 K4 R8 K4 W2 K4 G32 R/4",category:"Clan",description:"Clan Ross",popularity:72},{name:"Scott",threadcount:"R/4 W2 R48 G28 R4 G28 R48 W2 R/4",category:"Clan",description:"Clan Scott",popularity:71},{name:"Hamilton",threadcount:"R/4 W2 R4 W2 B28 W2 R4 W/2",category:"Clan",description:"Clan Hamilton",popularity:70},{name:"Edinburgh",threadcount:"B/8 R4 B8 R4 G28 K4 G28 R4 B8 R4 B/8",category:"District",description:"Scotland's capital city",popularity:68},{name:"Glasgow",threadcount:"G/4 Y2 G24 K4 W4 K4 R24 K4 W4 K4 G24 Y2 G/4",category:"District",description:"Glasgow district tartan",popularity:67},{name:"Highland",threadcount:"G/12 R4 G12 K4 Y4 K4 G12 R4 G/12",category:"District",description:"Generic Highland tartan",popularity:66},{name:"Isle of Skye",threadcount:"B/4 G24 K4 B4 K4 W4 K4 B4 K4 G24 B/4",category:"District",description:"Skye district tartan",popularity:65},{name:"Inverness",threadcount:"R/4 G4 R4 G24 R4 G4 K8 G4 R4 G24 R4 G4 R/4",category:"District",description:"Highland capital",popularity:64},{name:"Aberdeen",threadcount:"G/4 K4 G4 K4 R32 K4 G4 K4 G/4",category:"District",description:"Aberdeen city tartan",popularity:63},{name:"Galloway",threadcount:"K/4 B24 G4 B4 G4 R12 G4 B4 G4 B24 K/4",category:"District",description:"Dumfries & Galloway",popularity:62},{name:"Caledonia",threadcount:"B/4 K2 B4 K4 R24 K4 G24 K4 R24 K4 B4 K2 B/4",category:"District",description:"Ancient name for Scotland",popularity:61},{name:"Royal Scots",threadcount:"R/8 G24 R4 G4 R4 G24 B4 G4 B/4",category:"Military",description:"Royal Scots regiment",popularity:69},{name:"Scots Guards",threadcount:"B/4 K4 B4 K4 G24 K4 R4 K/4",category:"Military",description:"Scots Guards regiment",popularity:68},{name:"Gordon Highlanders",threadcount:"B/4 K2 B4 K32 G24 K6 G24 K32 Y4 B4 K2 B/4",category:"Military",description:"Gordon Highlanders regiment",popularity:67},{name:"Seaforth Highlanders",threadcount:"B/12 G28 B2 G2 B2 K4 R4 K4 W/2",category:"Military",description:"Seaforth Highlanders (MacKenzie)",popularity:66},{name:"Balmoral",threadcount:"GY/4 K4 GY4 K4 R32 K4 GY4 K4 GY/4",category:"Royal",description:"Royal Balmoral - restricted use",popularity:85},{name:"Prince Charles Edward",threadcount:"W/4 R48 K4 R4 K4 G24 K4 W4 K4 G24 K4 R4 K4 R48 W/4",category:"Royal",description:"Jacobite tartan",popularity:75},{name:"Princess Mary",threadcount:"B/8 R4 B8 K4 G24 K4 Y4 K4 G24 K4 B8 R4 B/8",category:"Royal",description:"Princess Mary tartan",popularity:60},{name:"Jacobite",threadcount:"R/8 K4 R8 K4 G24 K4 R8 K4 R/8",category:"Historic",description:"1745 Rebellion",popularity:72},{name:"Bonnie Prince Charlie",threadcount:"W/4 R48 K4 R4 K4 G24 K4 W4 K4 G24 K4 R4 K4 R48 W/4",category:"Historic",description:"Charles Edward Stuart",popularity:70},{name:"Culloden",threadcount:"R/4 G24 B4 G24 K4 R4 K/4",category:"Historic",description:"Battle of Culloden 1746",popularity:68},{name:"Flora MacDonald",threadcount:"G/8 R4 G8 B24 R4 B4 R4 B24 G8 R4 G/8",category:"Historic",description:"Jacobite heroine",popularity:65},{name:"Burberry",threadcount:"K/2 R4 K2 TN24 K2 W/2",category:"Fashion",description:"Classic British check (inspired)",popularity:85},{name:"Blackberry",threadcount:"P/4 K8 P4 K24 W4 K24 P4 K8 P/4",category:"Fashion",description:"Modern purple fashion tartan",popularity:55},{name:"Spirit of Scotland",threadcount:"B/8 K4 B8 K4 P24 K4 B8 K4 B/8",category:"Fashion",description:"Modern Scottish identity",popularity:60},{name:"Pride of Scotland",threadcount:"B/8 K4 B8 K4 P24 K4 G24 K4 P24 K4 B8 K4 B/8",category:"Fashion",description:"Contemporary fashion tartan",popularity:58},{name:"Scottish National",threadcount:"Y/8 R4 Y8 R4 K24 R4 Y8 R4 Y/8",category:"Fashion",description:"Scottish nationalism",popularity:56},{name:"Irish National",threadcount:"G/24 W4 O4 W4 G/24",category:"District",description:"Irish tricolor tartan",popularity:70},{name:"County Galway",threadcount:"G/8 K4 G8 K4 R24 K4 G8 K4 G/8",category:"District",description:"Galway Irish tartan",popularity:55},{name:"St. Patrick",threadcount:"G/4 W4 G24 Y4 G24 W4 G/4",category:"District",description:"Irish St. Patrick tartan",popularity:60},{name:"Anderson",threadcount:"B/4 K4 B4 K24 R4 K24 B4 K4 B/4",category:"Clan",description:"Clan Anderson",popularity:55},{name:"Armstrong",threadcount:"G/4 K16 G4 K4 B16 K4 G4 K16 G/4",category:"Clan",description:"Border clan",popularity:58},{name:"Brodie",threadcount:"R/4 K4 R4 K4 G24 K4 Y4 K4 G24 K4 R4 K4 R/4",category:"Clan",description:"Clan Brodie",popularity:52},{name:"Bruce",threadcount:"Y/8 R4 Y8 R4 G24 R4 Y8 R4 Y/8",category:"Clan",description:"Clan Bruce - Robert the Bruce",popularity:75},{name:"Chisholm",threadcount:"R/4 G4 R4 G24 W4 G24 R4 G4 R/4",category:"Clan",description:"Clan Chisholm",popularity:54},{name:"Colquhoun",threadcount:"B/4 K4 B4 K4 G24 K4 W4 K4 G24 K4 B4 K4 B/4",category:"Clan",description:"Clan Colquhoun",popularity:50},{name:"Crawford",threadcount:"R/4 G4 R4 G24 B4 G24 R4 G4 R/4",category:"Clan",description:"Clan Crawford",popularity:53},{name:"Cunningham",threadcount:"B/4 G24 K4 R4 K4 G24 B/4",category:"Clan",description:"Clan Cunningham",popularity:51},{name:"Davidson",threadcount:"R/4 G4 R4 G24 B4 G4 B4 G24 R4 G4 R/4",category:"Clan",description:"Clan Davidson",popularity:56},{name:"Duncan",threadcount:"B/4 G24 B4 G4 B4 K4 R4 K4 B4 G4 B4 G24 B/4",category:"Clan",description:"Clan Duncan",popularity:54},{name:"Elliot",threadcount:"R/4 B24 R4 B4 R4 G24 R4 B4 R4 B24 R/4",category:"Clan",description:"Border Clan Elliot",popularity:52},{name:"Erskine",threadcount:"G/4 K4 G4 K4 R24 K4 G4 K4 G/4",category:"Clan",description:"Clan Erskine",popularity:50},{name:"Farquharson",threadcount:"R/4 K4 R4 K4 G24 K4 Y4 K4 G24 K4 R4 K4 R/4",category:"Clan",description:"Clan Farquharson",popularity:55},{name:"Ferguson",threadcount:"G/4 B24 G4 B4 G4 W4 G4 B4 G4 B24 G/4",category:"Clan",description:"Clan Ferguson",popularity:58},{name:"Graham of Montrose",threadcount:"G/4 K4 G4 K24 W4 K24 G4 K4 G/4",category:"Clan",description:"Clan Graham",popularity:60},{name:"Gunn",threadcount:"G/4 K4 G4 K4 B24 K4 G4 K4 G/4",category:"Clan",description:"Clan Gunn",popularity:52},{name:"Henderson",threadcount:"G/4 K4 G4 K4 B24 K4 W4 K4 B24 K4 G4 K4 G/4",category:"Clan",description:"Clan Henderson",popularity:55},{name:"Home",threadcount:"G/4 K4 G4 K24 R4 K24 G4 K4 G/4",category:"Clan",description:"Clan Home",popularity:48},{name:"Innes",threadcount:"R/4 G24 R4 G4 R4 B24 R4 G4 R4 G24 R/4",category:"Clan",description:"Clan Innes",popularity:50},{name:"Johnston",threadcount:"B/4 K4 B4 K4 G24 K4 Y4 K4 G24 K4 B4 K4 B/4",category:"Clan",description:"Clan Johnston",popularity:54},{name:"Keith",threadcount:"B/4 R4 B4 R4 Y24 R4 B4 R4 B/4",category:"Clan",description:"Clan Keith",popularity:52},{name:"Kennedy",threadcount:"G/4 K4 G4 K24 B4 K24 G4 K4 G/4",category:"Clan",description:"Clan Kennedy",popularity:58},{name:"Kerr",threadcount:"R/4 G24 B4 G24 R/4",category:"Clan",description:"Clan Kerr",popularity:50},{name:"Lamont",threadcount:"B/4 G24 B4 G4 B4 W4 B4 G4 B4 G24 B/4",category:"Clan",description:"Clan Lamont",popularity:52},{name:"Leslie",threadcount:"G/4 B24 K4 B4 K4 Y4 K4 B4 K4 B24 G/4",category:"Clan",description:"Clan Leslie",popularity:53},{name:"MacAlister",threadcount:"R/4 G24 R4 G4 R4 K4 R4 G4 R4 G24 R/4",category:"Clan",description:"Clan MacAlister",popularity:50},{name:"MacArthur",threadcount:"G/4 Y4 G24 K4 Y4 K4 G24 Y4 G/4",category:"Clan",description:"Clan MacArthur",popularity:55},{name:"MacAulay",threadcount:"R/4 G24 R4 G4 R4 B4 R4 G4 R4 G24 R/4",category:"Clan",description:"Clan MacAulay",popularity:52},{name:"MacBeth",threadcount:"R/8 Y4 R8 K4 G24 K4 R8 Y4 R/8",category:"Clan",description:"Clan MacBeth",popularity:58},{name:"MacCallum",threadcount:"B/4 G24 B4 G4 B4 Y4 B4 G4 B4 G24 B/4",category:"Clan",description:"Clan MacCallum",popularity:50},{name:"MacDougall",threadcount:"R/4 K4 R4 K4 B24 K4 G24 K4 B24 K4 R4 K4 R/4",category:"Clan",description:"Clan MacDougall",popularity:54},{name:"MacFarlane",threadcount:"K/4 W8 K4 W4 K24 R4 K24 W4 K4 W8 K/4",category:"Clan",description:"Clan MacFarlane - Black & White",popularity:60},{name:"MacGillivray",threadcount:"R/4 K4 R4 K4 G24 K4 R4 K4 R/4",category:"Clan",description:"Clan MacGillivray",popularity:52},{name:"MacInnes",threadcount:"R/4 G24 K4 R4 K4 G24 R/4",category:"Clan",description:"Clan MacInnes",popularity:50},{name:"MacIntosh",threadcount:"R/4 K4 R4 K4 G24 K4 B4 K4 G24 K4 R4 K4 R/4",category:"Clan",description:"Clan MacIntosh",popularity:62},{name:"MacIntyre",threadcount:"R/4 G24 R4 G4 R4 B4 Y4 B4 R4 G4 R4 G24 R/4",category:"Clan",description:"Clan MacIntyre",popularity:55},{name:"MacKay",threadcount:"B/4 G24 B4 G4 B4 K4 W4 K4 B4 G4 B4 G24 B/4",category:"Clan",description:"Clan MacKay",popularity:58},{name:"MacKinnon",threadcount:"R/4 G24 R4 G4 R4 G24 R/4",category:"Clan",description:"Clan MacKinnon",popularity:54},{name:"MacLachlan",threadcount:"Y/4 K4 Y4 K4 R24 K4 G24 K4 R24 K4 Y4 K4 Y/4",category:"Clan",description:"Clan MacLachlan",popularity:56},{name:"MacLaine of Lochbuie",threadcount:"B/4 K4 B4 K4 G24 K4 Y4 K4 G24 K4 B4 K4 B/4",category:"Clan",description:"MacLaine of Lochbuie",popularity:52},{name:"MacLaren",threadcount:"G/4 K4 G4 K4 B24 K4 Y4 K4 B24 K4 G4 K4 G/4",category:"Clan",description:"Clan MacLaren",popularity:55},{name:"MacMillan",threadcount:"Y/4 R4 Y4 R4 G24 R4 B4 R4 G24 R4 Y4 R4 Y/4",category:"Clan",description:"Clan MacMillan",popularity:58},{name:"MacNab",threadcount:"R/4 K4 R4 K4 G24 K4 CR4 K4 G24 K4 R4 K4 R/4",category:"Clan",description:"Clan MacNab",popularity:54},{name:"MacNaughton",threadcount:"R/4 G24 B4 G4 B4 Y4 B4 G4 B4 G24 R/4",category:"Clan",description:"Clan MacNaughton",popularity:52},{name:"MacNeil",threadcount:"G/4 K4 G4 K4 B24 K4 R4 K4 B24 K4 G4 K4 G/4",category:"Clan",description:"Clan MacNeil of Barra",popularity:58},{name:"MacQuarrie",threadcount:"R/4 K4 R4 K4 G24 K4 Y4 W4 Y4 K4 G24 K4 R4 K4 R/4",category:"Clan",description:"Clan MacQuarrie",popularity:50},{name:"MacQueen",threadcount:"R/4 K4 R4 K24 Y4 K24 R4 K4 R/4",category:"Clan",description:"Clan MacQueen",popularity:52},{name:"MacRae",threadcount:"R/4 K4 R4 K4 G24 K4 R4 K4 R/4",category:"Clan",description:"Clan MacRae",popularity:60},{name:"Malcolm",threadcount:"B/4 G24 B4 G4 B4 R4 B4 G4 B4 G24 B/4",category:"Clan",description:"Clan Malcolm",popularity:54},{name:"Matheson",threadcount:"R/4 G24 R4 G4 R4 K4 R4 G4 R4 G24 R/4",category:"Clan",description:"Clan Matheson",popularity:55},{name:"Maxwell",threadcount:"R/4 G24 R4 G4 R4 K8 R4 G4 R4 G24 R/4",category:"Clan",description:"Clan Maxwell",popularity:54},{name:"Menzies",threadcount:"R/4 W4 R4 W4 G24 W4 R4 W4 R/4",category:"Clan",description:"Clan Menzies - Red & White",popularity:62},{name:"Moncreiffe",threadcount:"R/4 G24 R4 G4 R4 W4 R4 G4 R4 G24 R/4",category:"Clan",description:"Clan Moncreiffe",popularity:48},{name:"Montgomery",threadcount:"B/4 G24 B4 G4 B4 K4 B4 G4 B4 G24 B/4",category:"Clan",description:"Clan Montgomery",popularity:52},{name:"Morrison",threadcount:"G/4 K4 G4 K4 R24 K4 B4 K4 R24 K4 G4 K4 G/4",category:"Clan",description:"Clan Morrison",popularity:55},{name:"Munro",threadcount:"R/4 K4 R4 K4 G24 K4 W4 K4 G24 K4 R4 K4 R/4",category:"Clan",description:"Clan Munro",popularity:58},{name:"Napier",threadcount:"Y/4 K4 Y4 K4 R24 K4 G4 K4 R24 K4 Y4 K4 Y/4",category:"Clan",description:"Clan Napier",popularity:50},{name:"Ogilvie",threadcount:"R/4 Y4 R4 Y4 B24 Y4 R4 Y4 R/4",category:"Clan",description:"Clan Ogilvie",popularity:55},{name:"Ramsay",threadcount:"R/4 G24 B4 G4 B4 W4 B4 G4 B4 G24 R/4",category:"Clan",description:"Clan Ramsay",popularity:52},{name:"Rose",threadcount:"R/4 K4 R4 K24 B4 K24 R4 K4 R/4",category:"Clan",description:"Clan Rose",popularity:54},{name:"Shaw",threadcount:"R/4 K4 R4 K4 G24 K4 B4 K4 G24 K4 R4 K4 R/4",category:"Clan",description:"Clan Shaw",popularity:52},{name:"Skene",threadcount:"R/4 K4 R4 K4 G24 K4 Y4 K4 G24 K4 R4 K4 R/4",category:"Clan",description:"Clan Skene",popularity:50},{name:"Stewart Hunting",threadcount:"G/4 K4 G4 K24 R4 K4 B4 K4 R4 K24 G4 K4 G/4",category:"Clan",description:"Stewart Hunting tartan",popularity:72},{name:"Sutherland",threadcount:"G/4 K4 G4 K24 B4 K4 W4 K4 B4 K24 G4 K4 G/4",category:"Clan",description:"Clan Sutherland",popularity:60},{name:"Urquhart",threadcount:"B/4 G24 K4 G4 K4 W4 K4 G4 K4 G24 B/4",category:"Clan",description:"Clan Urquhart",popularity:54},{name:"Watson",threadcount:"B/4 K4 B4 K24 R4 K24 B4 K4 B/4",category:"Clan",description:"Clan Watson",popularity:52},{name:"Wemyss",threadcount:"R/4 G24 R4 G4 R4 W4 R4 G4 R4 G24 R/4",category:"Clan",description:"Clan Wemyss",popularity:48},{name:"Simple Red & Black",threadcount:"R/24 K4 R/24",category:"Fashion",description:"Simple two-color tartan",popularity:45},{name:"Simple Blue & Green",threadcount:"B/24 G8 B/24",category:"Fashion",description:"Classic color combination",popularity:44},{name:"Buffalo Plaid",threadcount:"R/24 K/24",category:"Fashion",description:"Classic lumberjack pattern",popularity:75},{name:"Gingham",threadcount:"W/8 B/8",category:"Fashion",description:"Classic gingham check",popularity:70}],$v=[...Yo].sort((e,t)=>(t.popularity||0)-(e.popularity||0));function Dv({onClose:e,onSelectTartan:t,config:r}){const[n,s]=N.useState(""),[a,o]=N.useState("all"),[c,l]=N.useState(""),[u,g]=N.useState(null),[m,h]=N.useState(!1),v=N.useRef(null),y=$v.filter(d=>{const p=n===""||d.name.toLowerCase().includes(n.toLowerCase())||d.description&&d.description.toLowerCase().includes(n.toLowerCase()),f=a==="all"||d.category===a;return p&&f}),b=["all","Clan","District","Military","Royal","Historic","Fashion","Corporate"];N.useEffect(()=>{if(!u||!v.current)return;const d=v.current,p=d.getContext("2d");if(p)try{const f=gt(u);if(!f||f.stripes.length===0)return;const w=ut(f),j=Math.min(200,w.length*4);d.width=j,d.height=j;const _=j/w.length,k=Gt[r.weaveType];for(let S=0;S<w.length;S++)for(let C=0;C<w.length;C++){const R=w.threads[C%w.length],M=w.threads[S%w.length],E=k.tieUp[S%k.treadling.length][C%k.threading.length]?R:M,T=Te(E);p.fillStyle=(T==null?void 0:T.hex)||"#808080",p.fillRect(C*_,S*_,_+.5,_+.5)}}catch{p.fillStyle="#333",p.fillRect(0,0,d.width,d.height),p.fillStyle="#666",p.font="12px sans-serif",p.fillText("Invalid threadcount",10,30)}},[u,r.weaveType]);const x=()=>{if(c.trim())try{const d=gt(c.trim());d&&d.stripes.length>0&&t(c.trim(),"Custom Tartan")}catch{alert("Invalid threadcount format. Example: B/24 W4 B24 R2 K24 G24 W/2")}};return i.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-gray-900 rounded-2xl w-full max-w-5xl max-h-[90vh] flex flex-col border border-gray-800",children:[i.jsxs("div",{className:"p-6 border-b border-gray-800 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:"Tartan Library"}),i.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[Yo.length,"+ authentic tartans  Search or paste threadcount"]})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),i.jsxs("div",{className:"p-4 border-b border-gray-800 space-y-4",children:[i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx("input",{type:"text",value:n,onChange:d=>s(d.target.value),placeholder:"Search tartans by name or description...",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 pl-10 text-white placeholder-gray-500 focus:border-indigo-500 focus:outline-none"}),i.jsx("svg",{className:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),i.jsx("button",{onClick:()=>h(!m),className:`px-4 py-2 rounded-lg transition-colors ${m?"bg-indigo-600 text-white":"bg-gray-800 text-gray-400 hover:text-white"}`,children:"Paste Threadcount"})]}),m&&i.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[i.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Paste threadcount notation (e.g., B/24 W4 B24 R2 K24 G24 W/2)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:c,onChange:d=>{l(d.target.value),g(d.target.value)},placeholder:"R/72 G4 R2 K24 Y2 K24 W2 K2 Y2 K32 W2 B/24",className:"flex-1 bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white placeholder-gray-600 focus:border-indigo-500 focus:outline-none font-mono text-sm"}),i.jsx("button",{onClick:x,className:"btn-primary",disabled:!c.trim(),children:"Load"})]}),i.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Color codes: R=Red, B=Blue, G=Green, K=Black, W=White, Y=Yellow, etc. Pivots marked with / (e.g., B/24)"}),u&&i.jsxs("div",{className:"mt-3 flex items-center gap-4",children:[i.jsx("canvas",{ref:v,width:80,height:80,className:"rounded border border-gray-600",style:{imageRendering:"pixelated"}}),i.jsx("span",{className:"text-sm text-gray-400",children:"Preview"})]})]}),i.jsx("div",{className:"flex flex-wrap gap-2",children:b.map(d=>i.jsx("button",{onClick:()=>o(d),className:`px-3 py-1.5 rounded-full text-sm transition-colors ${a===d?"bg-indigo-600 text-white":"bg-gray-800 text-gray-400 hover:text-white"}`,children:d==="all"?"All Tartans":d},d))})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:y.map((d,p)=>i.jsx(Gv,{tartan:d,config:r,onSelect:()=>t(d.threadcount,d.name)},`${d.name}-${p}`))}),y.length===0&&i.jsxs("div",{className:"text-center py-12 text-gray-500",children:['No tartans found matching "',n,'"']})]}),i.jsxs("div",{className:"p-4 border-t border-gray-800 text-center text-xs text-gray-500",children:["Showing ",y.length," of ",Yo.length," tartans  Sorted by popularity  Data sourced from Scottish Register of Tartans"]})]})})}function Gv({tartan:e,config:t,onSelect:r}){const n=N.useRef(null);N.useEffect(()=>{const a=n.current;if(!a)return;const o=a.getContext("2d");if(o)try{const c=gt(e.threadcount);if(!c||c.stripes.length===0)return;const l=ut(c),u=100/l.length;a.width=100,a.height=100;const g=Gt[t.weaveType];for(let m=0;m<l.length;m++)for(let h=0;h<l.length;h++){const v=l.threads[h%l.length],y=l.threads[m%l.length],x=g.tieUp[m%g.treadling.length][h%g.threading.length]?v:y,d=Te(x);o.fillStyle=(d==null?void 0:d.hex)||"#808080",o.fillRect(h*u,m*u,u+.5,u+.5)}}catch{o.fillStyle="#444",o.fillRect(0,0,100,100)}},[e.threadcount,t.weaveType]);const s={Clan:"bg-blue-600",District:"bg-green-600",Military:"bg-red-600",Royal:"bg-purple-600",Historic:"bg-amber-600",Fashion:"bg-pink-600",Corporate:"bg-gray-600"};return i.jsxs("div",{onClick:r,className:"bg-gray-800 rounded-lg overflow-hidden cursor-pointer hover:ring-2 hover:ring-indigo-500 transition-all group",children:[i.jsxs("div",{className:"relative",children:[i.jsx("canvas",{ref:n,width:100,height:100,className:"w-full aspect-square",style:{imageRendering:"pixelated"}}),i.jsx("div",{className:`absolute top-2 right-2 px-2 py-0.5 rounded text-xs text-white ${s[e.category]||"bg-gray-600"}`,children:e.category}),e.popularity&&e.popularity>=90&&i.jsx("div",{className:"absolute top-2 left-2 px-2 py-0.5 rounded text-xs bg-yellow-500 text-black font-medium",children:"Popular"}),i.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:i.jsx("span",{className:"bg-indigo-600 px-3 py-1 rounded text-sm font-medium",children:"Load"})})]}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"font-medium text-white truncate",children:e.name}),e.description&&i.jsx("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:e.description})]})]})}function Kv({onClose:e,threadGauge:t}){const[r,n]=N.useState({targetSize:2.5,threadGauge:t,backgroundColor:"#1a1a2e",foregroundColor:"#d4af37",technique:"jacquard"}),[s,a]=N.useState(""),[o,c]=N.useState("shield"),[l,u]=N.useState(null),[g,m]=N.useState(null),[h,v]=N.useState(8),[y,b]=N.useState(!0),x=N.useRef(null),d=N.useRef(null);N.useRef(null);const p=Ou[r.technique],f=Math.round(r.targetSize*r.threadGauge),w=r.targetSize>=p.minDetail,j=(S,C,R,M)=>{const I=S.getImageData(0,0,C,R),E=I.data,T=new Map;for(let z=0;z<E.length;z+=4){const re=`${E[z]},${E[z+1]},${E[z+2]}`;T.set(re,(T.get(re)||0)+1)}const D=Array.from(T.entries()).sort((z,re)=>re[1]-z[1]).slice(0,M).map(([z])=>z.split(",").map(Number));for(let z=0;z<E.length;z+=4){const re=E[z],O=E[z+1],G=E[z+2];let K=1/0,J=D[0];for(const[ne,et,ke]of D){const kt=(re-ne)**2+(O-et)**2+(G-ke)**2;kt<K&&(K=kt,J=[ne,et,ke])}E[z]=J[0],E[z+1]=J[1],E[z+2]=J[2]}return S.putImageData(I,0,0),D.length};N.useEffect(()=>{const S=x.current,C=d.current;if(!S||!C)return;const R=S.getContext("2d"),M=C.getContext("2d");if(!R||!M)return;const I=f;if(S.width=I,S.height=I,R.fillStyle=r.backgroundColor,R.fillRect(0,0,I,I),R.fillStyle=r.foregroundColor,l){const T=new Image;T.onload=()=>{R.drawImage(T,0,0,I,I),y&&h>0&&j(R,I,I,h),E()},T.src=l}else if(s){const T=Math.floor(I*.6);R.font=`bold ${T}px serif`,R.textAlign="center",R.textBaseline="middle",R.fillText(s.toUpperCase().slice(0,3),I/2,I/2),E()}else{const T=Mu[o],D=new Path2D(T.svg(I*.8));R.save(),R.translate(I*.1,I*.1),R.fill(D),R.restore(),E()}function E(){if(!C||!M||!S)return;const T=280;C.width=T,C.height=T,M.imageSmoothingEnabled=!1,M.drawImage(S,0,0,T,T)}},[r,s,o,l,f,y,h]);const _=S=>{var M;const C=(M=S.target.files)==null?void 0:M[0];if(!C)return;const R=new FileReader;R.onload=I=>{var T;const E=(T=I.target)==null?void 0:T.result;m(E),u(E),a("")},R.readAsDataURL(C)},k=()=>{const S=x.current;S&&S.toBlob(C=>{if(!C)return;const R=URL.createObjectURL(C),M=document.createElement("a");M.href=R,M.download=`crest-${f}x${f}-jacquard.png`,M.click(),URL.revokeObjectURL(R)},"image/png")};return i.jsx("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-gray-900 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"sticky top-0 bg-gray-900 border-b border-gray-800 p-4 flex items-center justify-between z-10",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:["Crest & Monogram Builder",!p.isTraditional&&i.jsx("span",{className:"text-xs px-2 py-0.5 bg-amber-900/50 text-amber-300 rounded-full",children:"Beyond Traditional Tartan"})]}),i.jsx("p",{className:"text-sm text-gray-400",children:"Design embroidered or woven emblems for your tartan"})]}),i.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"p-6 grid md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Production Technique"}),i.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.entries(Ou).map(([S,C])=>i.jsxs("button",{onClick:()=>n({...r,technique:S}),className:`p-3 rounded-lg text-left transition-all ${r.technique===S?C.isTraditional?"bg-emerald-900/50 border-2 border-emerald-500":"bg-amber-900/50 border-2 border-amber-500":"bg-gray-800 border-2 border-transparent hover:border-gray-600"}`,children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-medium",children:C.name}),C.isTraditional?i.jsx("span",{className:"text-xs px-2 py-0.5 bg-emerald-900/50 text-emerald-300 rounded-full",children:"Traditional"}):i.jsx("span",{className:"text-xs px-2 py-0.5 bg-amber-900/50 text-amber-300 rounded-full",children:"Modern"})]}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:C.description})]},S))})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"label",children:["Target Size: ",r.targetSize,'"  ',r.targetSize,'"']}),i.jsx("input",{type:"range",min:"0.5",max:"6",step:"0.25",value:r.targetSize,onChange:S=>n({...r,targetSize:parseFloat(S.target.value)}),className:"slider w-full"}),i.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[i.jsx("span",{children:'0.5" (Tie Pin)'}),i.jsx("span",{children:'3" (Badge)'}),i.jsx("span",{children:'6" (Patch)'})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"label",children:["Thread Gauge: ",r.threadGauge," TPI"]}),i.jsx("input",{type:"range",min:"24",max:"120",step:"4",value:r.threadGauge,onChange:S=>n({...r,threadGauge:parseInt(S.target.value)}),className:"slider w-full"}),i.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[i.jsx("span",{children:"24 (Coarse)"}),i.jsx("span",{children:"72 (Standard)"}),i.jsx("span",{children:"120 (Fine)"})]})]}),i.jsxs("div",{className:`p-4 rounded-lg ${w?"bg-emerald-900/30 border border-emerald-800":"bg-amber-900/30 border border-amber-800"}`,children:[i.jsxs("div",{className:"text-sm font-medium mb-2",children:["Resolution: ",f,"  ",f," threads"]}),i.jsx("p",{className:"text-xs text-gray-400",children:w?`At ${r.targetSize}" with ${r.threadGauge} TPI, your crest will have sufficient detail for ${p.name.toLowerCase()}.`:`Warning: ${r.targetSize}" is below the ${p.minDetail}" minimum for readable detail with ${p.name.toLowerCase()}. Consider increasing size.`})]}),i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Monogram Text (1-3 letters)"}),i.jsx("input",{type:"text",maxLength:3,value:s,onChange:S=>{a(S.target.value),u(null)},placeholder:"e.g., DJM",className:"input"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Shape Frame"}),i.jsx("div",{className:"grid grid-cols-4 gap-2",children:Object.entries(Mu).map(([S,C])=>i.jsx("button",{onClick:()=>c(S),className:`p-2 rounded-lg text-center text-sm transition-all ${o===S?"bg-indigo-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:C.name},S))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Or Upload Image (Logo, Crest, Photo)"}),i.jsx("input",{type:"file",accept:"image/*",onChange:_,className:"block w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-indigo-600 file:text-white hover:file:bg-indigo-700 cursor-pointer"}),l&&i.jsxs("div",{className:"mt-3 space-y-3",children:[i.jsx("button",{onClick:()=>{u(null),m(null)},className:"text-xs text-red-400 hover:text-red-300",children:"Clear uploaded image"}),i.jsxs("div",{className:"p-3 bg-gray-800/50 rounded-lg border border-gray-700",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("label",{className:"text-sm text-gray-300",children:"Limit Colors (for looms)"}),i.jsx("button",{onClick:()=>b(!y),className:`w-10 h-5 rounded-full transition-colors ${y?"bg-indigo-600":"bg-gray-700"}`,children:i.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform ${y?"translate-x-5":"translate-x-0.5"}`})})]}),y&&i.jsxs("div",{children:[i.jsxs("label",{className:"text-xs text-gray-500",children:["Max Colors: ",h]}),i.jsx("input",{type:"range",min:"2",max:"16",value:h,onChange:S=>v(parseInt(S.target.value)),className:"slider w-full"}),i.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[i.jsx("span",{children:"2 (simple)"}),i.jsx("span",{children:"6 (Lochcarron)"}),i.jsx("span",{children:"16 (detailed)"})]})]})]}),g&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Original"}),i.jsx("img",{src:g,alt:"Original",className:"w-full aspect-square object-cover rounded border border-gray-700"})]}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-xs text-gray-500 mb-1",children:["Weavable (",f,"px)"]}),i.jsx("canvas",{ref:d,className:"w-full aspect-square rounded border border-gray-700",style:{imageRendering:"pixelated"}})]})]})]})]}),!l&&i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Background"}),i.jsx("input",{type:"color",value:r.backgroundColor,onChange:S=>n({...r,backgroundColor:S.target.value}),className:"w-full h-10 rounded-lg cursor-pointer"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Foreground"}),i.jsx("input",{type:"color",value:r.foregroundColor,onChange:S=>n({...r,foregroundColor:S.target.value}),className:"w-full h-10 rounded-lg cursor-pointer"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Pixel Preview (Actual Resolution)"}),i.jsx("div",{className:"flex justify-center",children:i.jsx("canvas",{ref:d,className:"rounded-lg border border-gray-700",style:{imageRendering:"pixelated"}})}),i.jsxs("p",{className:"text-center text-xs text-gray-500 mt-2",children:["This is how your crest will look at ",f,"",f," threads"]})]}),i.jsx("canvas",{ref:x,className:"hidden"}),i.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-medium text-amber-400 mb-2",children:"Production Note"}),i.jsx("p",{className:"text-xs text-gray-400",children:p.warning})]}),i.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"Recommended Manufacturers"}),i.jsxs("ul",{className:"text-xs text-gray-400 space-y-1",children:[r.technique==="jacquard"&&i.jsxs(i.Fragment,{children:[i.jsxs("li",{children:[" ",i.jsx("strong",{children:"Lochcarron of Scotland"})," - Traditional jacquard weaving"]}),i.jsxs("li",{children:[" ",i.jsx("strong",{children:"House of Edgar"})," - Custom figured tartan"]})]}),r.technique==="embroidery"&&i.jsxs(i.Fragment,{children:[i.jsxs("li",{children:[" ",i.jsx("strong",{children:"Hand & Lock"})," - Luxury embroidery (London)"]}),i.jsxs("li",{children:[" ",i.jsx("strong",{children:"Coats & Clark"})," - Industrial embroidery"]})]}),r.technique==="print"&&i.jsxs(i.Fragment,{children:[i.jsxs("li",{children:[" ",i.jsx("strong",{children:"Printful"})," - On-demand fabric printing"]}),i.jsxs("li",{children:[" ",i.jsx("strong",{children:"Spoonflower"})," - Custom fabric printing"]})]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:k,className:"btn-primary flex-1",children:"Download Pixel Map"}),i.jsx("button",{onClick:e,className:"btn-secondary flex-1",children:"Close"})]})]})]})]})})}function Uv({data:e,config:t,onClose:r}){const[n,s]=N.useState("scarf-wide"),[a,o]=N.useState(t.threadGauge),[c,l]=N.useState(12),{sett:u}=e.result,g=$g(u,n,{gauge:a}),m=Gg(g,c),h=Bo[n],v=()=>{const y=Dg(g),b=`
TARTAN PRODUCTION SPECIFICATION
================================
Pattern: ${u.name||"Unnamed Tartan"}
Threadcount: ${u.threadcount}

Product: ${h.name}
${h.description}

${y}

COST ESTIMATE
-------------
Cost per skein: $${c.toFixed(2)}
${m.colorCosts.map(f=>`  ${f.color}: $${f.cost.toFixed(2)}`).join(`
`)}

Total Yarn Cost: $${m.totalYarnCost.toFixed(2)}

Generated by Tartanism - https://thedavidmurray.github.io/Tartanism
    `.trim(),x=new Blob([b],{type:"text/plain"}),d=URL.createObjectURL(x),p=document.createElement("a");p.href=d,p.download=`tartan-spec-${e.result.seed}.txt`,p.click(),URL.revokeObjectURL(d)};return i.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"card max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b border-gray-800 flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-semibold",children:"Yarn Calculator & Production Spec"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Product Template"}),i.jsx("select",{value:n,onChange:y=>s(y.target.value),className:"input",children:Object.entries(Bo).map(([y,b])=>i.jsxs("option",{value:y,children:[b.name," (",b.dimensions.width,'"  ',b.dimensions.length,'")']},y))}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h.description})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Gauge (TPI)"}),i.jsx("input",{type:"number",min:"8",max:"96",value:a,onChange:y=>o(parseInt(y.target.value)||24),className:"input"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Cost per Skein ($)"}),i.jsx("input",{type:"number",min:"1",max:"100",step:"0.5",value:c,onChange:y=>l(parseFloat(y.target.value)||12),className:"input"})]})]}),i.jsxs("div",{className:"p-3 bg-gray-800/50 rounded-lg",children:[i.jsxs("div",{className:"text-sm font-medium text-gray-300 mb-2",children:["Yarn Weight: ",g.yarnProfile.weightClass]}),i.jsxs("div",{className:"text-xs text-gray-500 grid grid-cols-3 gap-2",children:[i.jsxs("span",{children:["WPI: ",g.yarnProfile.wpi]}),i.jsxs("span",{children:["Yards/100g: ",g.yarnProfile.yardsPer100g]}),i.jsxs("span",{children:["Waste: ",((g.wasteMultiplier-1)*100).toFixed(0),"%"]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Yarn Requirements by Color"}),i.jsx("div",{className:"space-y-2",children:g.requirements.map(y=>i.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-800/30 rounded-lg",children:[i.jsx("div",{className:"w-8 h-8 rounded border border-gray-600",style:{backgroundColor:y.hex}}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"text-sm font-medium",children:[y.colorName," (",y.color,")"]}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Warp: ",y.warpYards," yd | Weft: ",y.weftYards," yd"]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:"text-sm font-medium",children:[y.totalYards," yards"]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[y.skeins," skeins (",y.weightGrams,"g)"]})]}),i.jsxs("div",{className:"text-right text-green-400 font-medium w-16",children:["$",(y.skeins*c).toFixed(2)]})]},y.color))})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-4 p-4 bg-indigo-900/20 rounded-lg border border-indigo-800/30",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-indigo-300",children:g.totalYards}),i.jsx("div",{className:"text-xs text-gray-500",children:"Total Yards"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-indigo-300",children:g.totalSkeins}),i.jsx("div",{className:"text-xs text-gray-500",children:"Total Skeins"})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-2xl font-bold text-indigo-300",children:[g.totalWeight,"g"]}),i.jsx("div",{className:"text-xs text-gray-500",children:"Total Weight"})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["$",m.totalYarnCost.toFixed(2)]}),i.jsx("div",{className:"text-xs text-gray-500",children:"Est. Yarn Cost"})]})]}),i.jsxs("div",{className:"p-3 bg-gray-900 rounded-lg",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Threadcount"}),i.jsx("div",{className:"font-mono text-sm text-gray-300",children:u.threadcount})]})]}),i.jsxs("div",{className:"p-4 border-t border-gray-800 flex gap-3 justify-end",children:[i.jsx("button",{onClick:v,className:"btn-secondary",children:"Download Spec"}),i.jsx("button",{onClick:r,className:"btn-primary",children:"Close"})]})]})})}function Fv({onClose:e,onColorsChange:t}){const[r,n]=N.useState(()=>{const x=localStorage.getItem("tartanism-custom-colors");return x?JSON.parse(x):[]}),[s,a]=N.useState({code:"",name:"",hex:"#808080"}),[o,c]=N.useState(null),l=x=>{n(x),localStorage.setItem("tartanism-custom-colors",JSON.stringify(x)),t(x)},u=()=>{if(!s.code||!s.name){alert("Please enter both a code and name for the color.");return}if(s.code.length>4){alert("Color code should be 1-4 characters.");return}if(r.some(d=>d.code.toUpperCase()===s.code.toUpperCase())){alert("A color with this code already exists.");return}if(yt[s.code.toUpperCase()]){alert("This code conflicts with a built-in color. Choose a different code.");return}const x=[...r,{...s,code:s.code.toUpperCase()}];l(x),a({code:"",name:"",hex:"#808080"})},g=x=>{const d=[...r];d[x]={...s,code:s.code.toUpperCase()},l(d),c(null),a({code:"",name:"",hex:"#808080"})},m=x=>{if(confirm("Delete this custom color?")){const d=r.filter((p,f)=>f!==x);l(d)}},h=x=>{a(r[x]),c(x)},v=()=>{c(null),a({code:"",name:"",hex:"#808080"})},y=()=>{const x=JSON.stringify(r,null,2),d=new Blob([x],{type:"application/json"}),p=URL.createObjectURL(d),f=document.createElement("a");f.href=p,f.download="tartanism-custom-colors.json",f.click(),URL.revokeObjectURL(p)},b=()=>{const x=document.createElement("input");x.type="file",x.accept=".json",x.onchange=d=>{var f;const p=(f=d.target.files)==null?void 0:f[0];if(p){const w=new FileReader;w.onload=j=>{var _;try{const k=JSON.parse((_=j.target)==null?void 0:_.result);Array.isArray(k)&&k.every(S=>S.code&&S.name&&S.hex)?(l([...r,...k]),alert(`Imported ${k.length} colors!`)):alert("Invalid color file format.")}catch{alert("Error reading file.")}},w.readAsText(p)}},x.click()};return i.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:e,children:i.jsxs("div",{className:"card max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",onClick:x=>x.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b border-gray-800 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold",children:"Yarn Color Builder"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create custom colors for your tartans"})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg space-y-4",children:[i.jsx("h3",{className:"font-medium text-gray-200",children:o!==null?"Edit Color":"Add New Color"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Color Code (1-4 chars)"}),i.jsx("input",{type:"text",value:s.code,onChange:x=>a({...s,code:x.target.value.slice(0,4)}),placeholder:"e.g. MY, CUS",className:"input",maxLength:4})]}),i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Color Name"}),i.jsx("input",{type:"text",value:s.name,onChange:x=>a({...s,name:x.target.value}),placeholder:"e.g. My Custom Blue",className:"input"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"label",children:"Color Value"}),i.jsxs("div",{className:"flex gap-3 items-center",children:[i.jsx("input",{type:"color",value:s.hex,onChange:x=>a({...s,hex:x.target.value}),className:"w-16 h-10 rounded cursor-pointer border-0"}),i.jsx("input",{type:"text",value:s.hex,onChange:x=>a({...s,hex:x.target.value}),placeholder:"#RRGGBB",className:"input flex-1 font-mono",pattern:"^#[0-9A-Fa-f]{6}$"}),i.jsx("div",{className:"w-20 h-10 rounded border border-gray-600",style:{backgroundColor:s.hex}})]})]}),i.jsx("div",{className:"flex gap-2",children:o!==null?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>g(o),className:"btn-primary flex-1",children:"Update Color"}),i.jsx("button",{onClick:v,className:"btn-secondary",children:"Cancel"})]}):i.jsx("button",{onClick:u,className:"btn-primary flex-1",children:"+ Add Color"})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h3",{className:"font-medium text-gray-200",children:["Your Custom Colors (",r.length,")"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:b,className:"btn-secondary text-xs",children:" Import"}),r.length>0&&i.jsx("button",{onClick:y,className:"btn-secondary text-xs",children:" Export"})]})]}),r.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("p",{children:"No custom colors yet."}),i.jsx("p",{className:"text-sm mt-1",children:"Add colors above to build your yarn palette!"})]}):i.jsx("div",{className:"grid gap-2",children:r.map((x,d)=>i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-800/30 rounded-lg",children:[i.jsx("div",{className:"w-10 h-10 rounded-lg border border-gray-600 flex-shrink-0",style:{backgroundColor:x.hex}}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-medium text-gray-200",children:x.name}),i.jsxs("div",{className:"text-sm text-gray-400 font-mono",children:[x.code,"  ",x.hex]})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>h(d),className:"p-2 text-gray-400 hover:text-white rounded transition-colors",title:"Edit",children:""}),i.jsx("button",{onClick:()=>m(d),className:"p-2 text-gray-400 hover:text-red-400 rounded transition-colors",title:"Delete",children:""})]})]},d))})]}),i.jsxs("div",{className:"bg-indigo-900/20 p-4 rounded-lg border border-indigo-800/30",children:[i.jsx("h4",{className:"font-medium text-indigo-300 mb-2",children:"Tips"}),i.jsxs("ul",{className:"text-sm text-gray-400 space-y-1",children:[i.jsx("li",{children:" Use short codes (1-4 chars) that don't conflict with existing colors"}),i.jsx("li",{children:" Custom colors will appear in your color palette selection"}),i.jsx("li",{children:" Export your colors to share them or back them up"}),i.jsx("li",{children:" Match colors to real yarn you have for accurate production planning"})]})]})]}),i.jsx("div",{className:"p-4 border-t border-gray-800 flex justify-end",children:i.jsx("button",{onClick:e,className:"btn-primary",children:"Done"})})]})})}function Wv({onClose:e}){return i.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:e,children:i.jsxs("div",{className:"card max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",onClick:t=>t.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b border-gray-800 flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-semibold",children:"How to Use Tartanism"}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white",children:""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-indigo-400 mb-3",children:"What is a Tartan?"}),i.jsxs("p",{className:"text-gray-300 leading-relaxed",children:["A tartan is a patterned cloth consisting of criss-crossed horizontal and vertical bands in multiple colors. Originating in Scotland, tartans are defined by their ",i.jsx("strong",{children:"sett"}),"  a sequence of colored threads that repeats in both the warp (vertical) and weft (horizontal) directions. This creates the distinctive checkered pattern where colors blend at intersections."]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-indigo-400 mb-3",children:"Understanding Threadcount Notation"}),i.jsxs("p",{className:"text-gray-300 mb-3",children:["Tartans are recorded using threadcount notation, like: ",i.jsx("code",{className:"bg-gray-800 px-2 py-1 rounded",children:"B/24 W4 B24 R2 K24 G24 W/2"})]}),i.jsxs("ul",{className:"text-gray-300 space-y-2 list-disc list-inside",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Letters"})," = Color codes (B=Blue, W=White, R=Red, K=Black, G=Green, etc.)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Numbers"})," = Thread count for that color stripe"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Slash (/)"})," = Pivot point where the pattern mirrors (symmetric setts)"]}),i.jsx("li",{children:'Example: "B/24" means 24 blue threads at the pivot, pattern mirrors here'})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-indigo-400 mb-3",children:"Generator Settings"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white mb-2",children:"Batch Size"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"How many unique tartans to generate at once. Range: 1-50."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white mb-2",children:"Thread Gauge (TPI)"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Threads Per Inch  determines the fabric density. Higher = finer weave. Traditional kilt cloth uses 48 TPI. Typical range: 12-48."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white mb-2",children:"Colors (3-6)"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Min and max number of distinct colors in the tartan. Most traditional tartans use 3-6 colors. More colors = more complex patterns."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white mb-2",children:"Stripes (4-12)"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Number of color bands in the sett before it repeats/mirrors. More stripes = more intricate design. Range: 2-20."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white mb-2",children:"Thread Width (4-48)"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Min and max threads per individual stripe. Wider stripes = bolder bands. Narrower = more detailed. Even numbers are standard for weaving."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white mb-2",children:"Total Threads (60-180)"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Total thread count for the full sett. Traditional kilt-scale tartans typically have 200-280 threads. This controls overall pattern size."})]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-indigo-400 mb-3",children:"Weave Patterns"}),i.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:"Plain Weave (1/1)"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Simple over-under pattern. Creates sharp color definition."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:"2/2 Twill "}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Traditional tartan weave. Creates diagonal lines and color blending."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:"3/1 Twill"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Steeper diagonal. More warp color visible on face."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:"Herringbone"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"V-shaped zigzag pattern created by reversing twill direction."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:"Houndstooth"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Classic broken check pattern with pointed shapes."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:"Basket Weave"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Groups of threads woven together for textured appearance."})]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-indigo-400 mb-3",children:"Symmetry Options"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:"Symmetric"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Pattern mirrors at pivot points (most common). The sett reads the same forwards and backwards."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:"Asymmetric"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Pattern repeats without mirroring. Less common but creates unique directional designs."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:"Either"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Generator randomly chooses symmetric or asymmetric for variety."})]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-indigo-400 mb-3",children:"Optical Illusion Mode"}),i.jsx("p",{className:"text-gray-300 mb-3",children:"Applies 3D shape masks to create embedded geometry effects. The tartan pattern is modified with brightness variations to simulate depth and dimensionality."}),i.jsxs("div",{className:"grid sm:grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"text-gray-400",children:[" ",i.jsx("strong",{children:"Cubes"}),"  Isometric 3D cube illusion"]}),i.jsxs("div",{className:"text-gray-400",children:[" ",i.jsx("strong",{children:"Hexagons"}),"  Honeycomb pattern"]}),i.jsxs("div",{className:"text-gray-400",children:[" ",i.jsx("strong",{children:"Spheres"}),"  Floating bubble effect"]}),i.jsxs("div",{className:"text-gray-400",children:[" ",i.jsx("strong",{children:"Waves"}),"  Rippling water surface"]}),i.jsxs("div",{className:"text-gray-400",children:[" ",i.jsx("strong",{children:"Diamonds"}),"  Faceted gem pattern"]}),i.jsxs("div",{className:"text-gray-400",children:[" ",i.jsx("strong",{children:"Penrose"}),"  Aperiodic tiling"]}),i.jsxs("div",{className:"text-gray-400",children:[" ",i.jsx("strong",{children:"Escher"}),"  Impossible staircase"]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-indigo-400 mb-3",children:"Color Palette"}),i.jsx("p",{className:"text-gray-300 mb-3",children:"48 traditional tartan colors organized by family. Click colors to enable/disable them in generation. Colors use official Scottish Register codes and are perceptually balanced."}),i.jsx("div",{className:"text-gray-400 text-sm",children:"Color families: Blues, Reds, Greens, Yellows, Browns, Grays, Purples, and accent colors."})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-indigo-400 mb-3",children:"Export & Production Tools"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:" WIF Export (Loom Draft)"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Weaving Information File format. Import into loom software (WeavePoint, Fiberworks, etc.) to weave the pattern on a floor loom or dobby loom."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:" Yarn Calculator"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Calculate yarn requirements for production. Select product type (scarf, blanket, kilt, etc.) to get yardage, weight, and cost estimates per color."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:" SVG Download"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Vector graphic export. Perfect for printing, further editing, or sharing at any resolution."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:" Copy Seed"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Copy the generation seed to recreate the exact same pattern later."})]}),i.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-white",children:" Export CSV"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Export all generated tartans as a spreadsheet with full metadata."})]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-indigo-400 mb-3",children:"Tartan Card Actions"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"bg-gray-700 px-3 py-1 rounded text-sm",children:"Mutate"}),i.jsx("span",{className:"text-gray-400 text-sm",children:"Generate variations of this tartan with slight modifications"})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"bg-gray-700 px-3 py-1 rounded text-sm",children:"Edit"}),i.jsx("span",{className:"text-gray-400 text-sm",children:"Open in Builder to manually adjust colors and stripe widths"})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsx("span",{className:"text-gray-400 text-sm",children:"Click the tartan image to see a tiled preview at different scales"})})]})]})]}),i.jsx("div",{className:"p-4 border-t border-gray-800 flex justify-end",children:i.jsx("button",{onClick:e,className:"btn-primary",children:"Got it!"})})]})})}function zv(){const{user:e,loading:t,isConfigured:r,signInWithGoogle:n,signOut:s}=Sv(),[a,o]=N.useState("generator"),[c,l]=N.useState([]),[u,g]=N.useState({batchSize:6,colorMin:3,colorMax:6,stripeMin:4,stripeMax:12,threadMin:4,threadMax:48,totalMin:60,totalMax:180,threadGauge:24,weaveType:"twill-2-2",symmetry:"symmetric",opticalMode:!1,shapeMask:Pg(),allowedColors:Object.keys(yt),loomCompatible:!1}),[m,h]=N.useState(null),[v,y]=N.useState(!1),[b,x]=N.useState(null),[d,p]=N.useState(null),[f,w]=N.useState(!1),[j,_]=N.useState(!1),[k,S]=N.useState(!1),[C,R]=N.useState(!1),[M,I]=N.useState(!1),[E,T]=N.useState(null),[D,z]=N.useState(null),[re,O]=N.useState(null),[G,K]=N.useState(!1),[J,ne]=N.useState(!1),[et,ke]=N.useState(!1),[kt,L]=N.useState(!1),[W,A]=N.useState(!1),[ee,ve]=N.useState(!1),[Fe,ft]=N.useState(!0),[Pe,Fr]=N.useState(()=>{const U=localStorage.getItem("tartanism-custom-colors");return U?JSON.parse(U):[]}),Ls=N.useCallback(()=>{const q=gg(u.batchSize,{colorCount:{min:u.colorMin,max:u.colorMax},stripeCount:{min:u.stripeMin,max:u.stripeMax},threadCount:{min:u.threadMin,max:u.threadMax},totalThreads:{min:u.totalMin,max:u.totalMax},symmetry:u.symmetry,allowedColors:u.allowedColors.length>0?u.allowedColors:void 0}).map(Y=>({id:`${Y.seed}-${Date.now()}`,result:Y,isOptical:u.opticalMode}));l(Y=>[...q,...Y])},[u]),yf=N.useCallback((U,q)=>{const Y=gt(U);if(!Y||Y.stripes.length===0)return;const Z={id:`library-${q}-${Date.now()}`,result:{sett:Y,seed:Date.now(),constraints:Cr,signature:{signature:U,structureSignature:U,proportionSignature:U}},isOptical:u.opticalMode};l(Q=>[Z,...Q]),R(!1)},[u.opticalMode]),vf=N.useCallback(()=>{if(!E||!D)return;const U=E.result.sett,q=D.result.sett,Y=[],Z=[...new Set([...U.colors,...q.colors])];for(let Q=0;Q<4;Q++){const ae=[],ie=Date.now()+Q;if(Q===0){const ue=Math.max(U.stripes.length,q.stripes.length);for(let oe=0;oe<ue;oe++)oe<U.stripes.length&&oe%2===0?ae.push({...U.stripes[oe]}):oe<q.stripes.length&&ae.push({...q.stripes[oe%q.stripes.length]})}else if(Q===1)U.stripes.forEach((ue,oe)=>{const St=oe%q.colors.length;ae.push({...ue,color:q.colors[St]})});else if(Q===2)q.stripes.forEach((ue,oe)=>{const St=oe%U.colors.length;ae.push({...ue,color:U.colors[St]})});else{const ue=Math.max(U.stripes.length,q.stripes.length);for(let oe=0;oe<ue;oe++){const We=Math.random()>.5?U:q,Le=oe%We.stripes.length,Mt={...We.stripes[Le]};Math.random()>.7&&(Mt.color=Z[Math.floor(Math.random()*Z.length)]),ae.push(Mt)}}ae.length>0&&(ae[0].isPivot=!0,ae[ae.length-1].isPivot=!0);const $e=ae.map(ue=>`${ue.color}${ue.isPivot?"/":""}${ue.count}`).join(" "),tt=gt($e);tt&&tt.stripes.length>0&&Y.push({id:`breed-${ie}`,result:{sett:tt,seed:ie,constraints:Cr,signature:{signature:$e,structureSignature:$e,proportionSignature:$e}},parentId:`${E.id}+${D.id}`,isOptical:u.opticalMode})}l(Q=>[...Y,...Q]),I(!1),T(null),z(null)},[E,D,u.opticalMode]),xf=N.useCallback(U=>{E?!D&&U.id!==E.id&&z(U):T(U)},[E,D]),wf=N.useCallback(U=>{g(q=>({...q,allowedColors:U}))},[]),bf=N.useCallback((U,q)=>{const Y=q.replace(/[^a-zA-Z]/g,"").toUpperCase().slice(0,3)||"CX";let Z=Y,Q=1;for(;Pe.some($e=>$e.code===Z)||Te(Z);)Z=`${Y}${Q}`,Q++;const ae={code:Z,name:q,hex:U},ie=[...Pe,ae];Fr(ie),localStorage.setItem("tartanism-custom-colors",JSON.stringify(ie))},[Pe]),kf=N.useCallback((U,q)=>{const Y=gt("K/8 W8");if(!Y)return;const Z={id:`geo-${Date.now()}`,result:{sett:Y,seed:Date.now(),constraints:Cr,signature:{signature:q,structureSignature:"",proportionSignature:""}},imagePattern:{imageData:U,repeatMode:"normal",pixelSize:1}};l(Q=>[Z,...Q]),ne(!1)},[u.opticalMode]),Sf=N.useCallback((U,q)=>{const Y=gt("K/8 W8");if(!Y)return;const Z={id:`img-${Date.now()}`,result:{sett:Y,seed:Date.now(),constraints:Cr,signature:{signature:"image-pattern",structureSignature:"",proportionSignature:""}},imagePattern:{imageData:U,repeatMode:q.repeatMode,pixelSize:q.pixelSize}};l(Q=>[Z,...Q]),ke(!1)},[]),_f=N.useCallback((U,q)=>{const Y=gt("K/8 W8");if(!Y)return;const Z={id:`motif-${Date.now()}`,result:{sett:Y,seed:Date.now(),constraints:Cr,signature:{signature:q,structureSignature:"",proportionSignature:""}},imagePattern:{imageData:U,repeatMode:"normal",pixelSize:1}};l(Q=>[Z,...Q]),L(!1)},[]),jf=N.useCallback(U=>{const{sett:q,seed:Y}=U.result,Z=[];for(let Q=0;Q<4;Q++){const ae=Y+Q+1e3,ie=Io({...Cr,allowedColors:u.allowedColors.length>0?u.allowedColors:void 0},ae),$e=ie.sett.stripes.map((ue,oe)=>oe<q.stripes.length&&Math.random()>.5?{...ue,color:q.stripes[oe].color}:ue),tt=gt($e.map(ue=>`${ue.color}${ue.isPivot?"/":""}${ue.count}`).join(" "));Z.push({id:`${ae}-${Date.now()}`,result:{...ie,sett:tt},parentId:U.id,isOptical:U.isOptical})}l(Q=>[...Z,...Q])},[u.allowedColors]),Cf=N.useCallback(U=>{h(U),y(!0)},[]),Nf=N.useCallback(U=>{const q=Io({},Date.now()),Y={id:`custom-${Date.now()}`,result:{...q,sett:U},isOptical:u.opticalMode};l(Z=>[Y,...Z]),y(!1),h(null)},[u.opticalMode]),Rf=N.useCallback(U=>{const{sett:q}=U.result,Y=ut(q),Z=Gt[u.weaveType],Q=4,ae=Y.length*Q;let ie=`<svg xmlns="http://www.w3.org/2000/svg" width="${ae}" height="${ae}" viewBox="0 0 ${ae} ${ae}">`;for(let oe=0;oe<Y.length;oe++)for(let St=0;St<Y.length;St++){const We=Ia(Y,Y,Z,St,oe),Le=Te(We.color);Le&&(ie+=`<rect x="${St*Q}" y="${oe*Q}" width="${Q}" height="${Q}" fill="${Le.hex}"/>`)}ie+="</svg>";const $e=new Blob([ie],{type:"image/svg+xml"}),tt=URL.createObjectURL($e),ue=document.createElement("a");ue.href=tt,ue.download=`tartan-${U.result.seed}.svg`,ue.click(),URL.revokeObjectURL(tt)},[u.weaveType]),Ef=N.useCallback(U=>{const{sett:q}=U.result,Y=Gt[u.weaveType],Z=Lg(q,Y,{title:q.name||`Tartan ${U.result.seed}`,author:"Tartanism",warpRepeats:2,weftRepeats:2}),Q=new Blob([Z.content],{type:"text/plain"}),ae=URL.createObjectURL(Q),ie=document.createElement("a");ie.href=ae,ie.download=Z.filename,ie.click(),URL.revokeObjectURL(ae)},[u.weaveType]),Tf=N.useCallback((U,q=300)=>{const{sett:Y}=U.result,Z=ut(Y),Q=Gt[u.weaveType],ie=6*q,$e=Math.ceil(ie/Z.length),tt=document.createElement("canvas"),ue=Z.length*$e;tt.width=ue,tt.height=ue;const oe=tt.getContext("2d");if(!oe)return;const St=We=>{const Le=Pe.find(Mt=>Mt.code===We);return Le?{code:Le.code,name:Le.name,hex:Le.hex}:Te(We)};for(let We=0;We<Z.length;We++)for(let Le=0;Le<Z.length;Le++){const Mt=Ia(Z,Z,Q,Le,We),Yl=St(Mt.color);Yl&&(oe.fillStyle=Yl.hex,oe.fillRect(Le*$e,We*$e,$e,$e))}tt.toBlob(We=>{if(!We)return;const Le=URL.createObjectURL(We),Mt=document.createElement("a");Mt.href=Le,Mt.download=`tartan-${U.result.seed}-${q}dpi.png`,Mt.click(),URL.revokeObjectURL(Le)},"image/png")},[u.weaveType,Pe]),Pf=N.useCallback(U=>{navigator.clipboard.writeText(U.toString())},[]);return N.useCallback(()=>{const U=["id","seed","threadcount","colors","totalThreads","colorCount","isOptical"],q=c.map(ie=>[ie.id,ie.result.seed,`"${ie.result.sett.threadcount}"`,`"${ie.result.sett.colors.join(",")}"`,ie.result.sett.totalThreads,ie.result.sett.colors.length,ie.isOptical?"true":"false"]),Y=[U.join(","),...q.map(ie=>ie.join(","))].join(`
`),Z=new Blob([Y],{type:"text/csv"}),Q=URL.createObjectURL(Z),ae=document.createElement("a");ae.href=Q,ae.download=`tartans-${Date.now()}.csv`,ae.click(),URL.revokeObjectURL(Q)},[c]),i.jsxs("div",{className:"h-screen flex flex-col overflow-hidden noise",children:[i.jsxs("header",{className:"flex-shrink-0 border-b border-white/5 glass z-40",children:[i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-violet-600 flex items-center justify-center shadow-lg shadow-indigo-500/20",children:i.jsx("span",{className:"text-xl font-bold text-white",children:"T"})}),i.jsxs("div",{className:"hidden sm:block",children:[i.jsx("h1",{className:"text-lg font-semibold text-gradient leading-tight",children:"Tartanism"}),i.jsx("p",{className:"text-[10px] text-gray-500 leading-tight tracking-wide uppercase",children:"Pattern Studio"})]})]}),i.jsxs("nav",{className:"hidden lg:flex items-center gap-1",children:[i.jsx("button",{onClick:()=>o("generator"),className:`nav-item ${a==="generator"?"nav-item-active":""}`,children:"Generator"}),i.jsx("button",{onClick:()=>{y(!0),h(null)},className:"nav-item",children:"Builder"}),i.jsx("button",{onClick:()=>R(!0),className:"nav-item",children:"Library"}),i.jsx("div",{className:"w-px h-5 bg-white/10 mx-2"}),i.jsx("button",{onClick:()=>K(!0),className:"nav-item",children:""}),i.jsx("button",{onClick:()=>ne(!0),className:"nav-item",children:""}),i.jsx("button",{onClick:()=>ke(!0),className:"nav-item",children:""}),i.jsx("button",{onClick:()=>L(!0),className:"nav-item",children:""}),i.jsx("button",{onClick:()=>A(!0),className:"nav-item",children:""}),c.length>=2&&i.jsx("button",{onClick:()=>{I(!M),T(null),z(null)},className:`nav-item ${M?"bg-pink-500/20 text-pink-300":""}`,children:""}),i.jsx("button",{onClick:()=>w(!0),className:"nav-item",children:"?"})]}),i.jsxs("div",{className:"flex items-center gap-2 lg:hidden",children:[i.jsxs("button",{onClick:Ls,className:"btn-primary py-2 px-4",children:["Roll ",u.batchSize]}),i.jsx("button",{onClick:()=>ve(!ee),className:"btn-icon",children:i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:ee?i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]}),i.jsxs("div",{className:"hidden lg:flex items-center gap-3",children:[i.jsxs("button",{onClick:Ls,className:"btn-primary",children:[i.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Roll ",u.batchSize]}),i.jsx("button",{onClick:()=>ft(!Fe),className:"btn-icon",title:Fe?"Show settings":"Hide settings",children:i.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),ee&&i.jsxs("div",{className:"lg:hidden border-t border-white/5 bg-black/50 backdrop-blur-xl animate-fadeIn",children:[i.jsxs("div",{className:"p-4 grid grid-cols-4 gap-2",children:[i.jsxs("button",{onClick:()=>{y(!0),ve(!1)},className:"flex flex-col items-center gap-1 p-3 rounded-xl bg-white/5 hover:bg-white/10 transition-all",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-gray-400",children:"Builder"})]}),i.jsxs("button",{onClick:()=>{R(!0),ve(!1)},className:"flex flex-col items-center gap-1 p-3 rounded-xl bg-white/5 hover:bg-white/10 transition-all",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-gray-400",children:"Library"})]}),i.jsxs("button",{onClick:()=>{K(!0),ve(!1)},className:"flex flex-col items-center gap-1 p-3 rounded-xl bg-white/5 hover:bg-white/10 transition-all",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-gray-400",children:"Extract"})]}),i.jsxs("button",{onClick:()=>{ne(!0),ve(!1)},className:"flex flex-col items-center gap-1 p-3 rounded-xl bg-white/5 hover:bg-white/10 transition-all",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-gray-400",children:"Geometric"})]}),i.jsxs("button",{onClick:()=>{ke(!0),ve(!1)},className:"flex flex-col items-center gap-1 p-3 rounded-xl bg-white/5 hover:bg-white/10 transition-all",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-gray-400",children:"Image"})]}),i.jsxs("button",{onClick:()=>{L(!0),ve(!1)},className:"flex flex-col items-center gap-1 p-3 rounded-xl bg-white/5 hover:bg-white/10 transition-all",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-gray-400",children:"Motifs"})]}),i.jsxs("button",{onClick:()=>{A(!0),ve(!1)},className:"flex flex-col items-center gap-1 p-3 rounded-xl bg-white/5 hover:bg-white/10 transition-all",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-gray-400",children:"Knit"})]}),i.jsxs("button",{onClick:()=>{ft(!Fe),ve(!1)},className:"flex flex-col items-center gap-1 p-3 rounded-xl bg-white/5 hover:bg-white/10 transition-all",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-gray-400",children:"Settings"})]})]}),c.length>=2&&i.jsx("div",{className:"px-4 pb-4",children:i.jsxs("button",{onClick:()=>{I(!M),T(null),z(null),ve(!1)},className:`w-full py-3 rounded-xl font-medium transition-all ${M?"bg-pink-500/20 text-pink-300 border border-pink-500/30":"bg-white/5 text-gray-300 border border-white/10"}`,children:[" ",M?"Exit Breeding Mode":"Breed Patterns"]})})]})]}),i.jsx("main",{className:"flex-1 overflow-hidden",children:i.jsxs("div",{className:`h-full max-w-7xl mx-auto px-3 sm:px-4 py-3 ${Fe?"":"grid lg:grid-cols-[280px_1fr] gap-4"}`,children:[!Fe&&i.jsx("aside",{className:"overflow-y-auto scrollbar-thin self-start max-h-[calc(100vh-100px)] hidden lg:block",children:i.jsx(Nv,{config:u,onChange:g,onGenerate:Ls,onOpenColorBuilder:()=>_(!0),customColors:Pe})}),i.jsxs("section",{className:"overflow-y-auto scrollbar-thin h-full mobile-no-scrollbar",children:[M&&i.jsxs("div",{className:"mb-6 p-4 bg-gradient-to-r from-pink-900/30 to-purple-900/30 rounded-xl border border-pink-800/50",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:" Pattern DNA Breeding"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Select two tartans to combine their genetic traits"})]}),i.jsx("button",{onClick:()=>{I(!1),T(null),z(null)},className:"text-gray-400 hover:text-white",children:""})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:`flex-1 p-3 rounded-lg border-2 border-dashed ${E?"border-pink-500 bg-pink-950/30":"border-gray-600"}`,children:E?i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-16 h-16 rounded bg-gray-800 overflow-hidden",children:i.jsx(Iu,{data:E,config:u})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-sm text-white font-medium",children:"Parent 1"}),i.jsxs("p",{className:"text-xs text-gray-400",children:[E.result.sett.colors.length," colors"]})]}),i.jsx("button",{onClick:()=>T(null),className:"text-gray-500 hover:text-red-400 text-sm",children:""})]}):i.jsx("p",{className:"text-center text-gray-500 py-2",children:"Click a tartan to select Parent 1"})}),i.jsx("div",{className:"text-2xl text-pink-400",children:""}),i.jsx("div",{className:`flex-1 p-3 rounded-lg border-2 border-dashed ${D?"border-purple-500 bg-purple-950/30":"border-gray-600"}`,children:D?i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-16 h-16 rounded bg-gray-800 overflow-hidden",children:i.jsx(Iu,{data:D,config:u})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-sm text-white font-medium",children:"Parent 2"}),i.jsxs("p",{className:"text-xs text-gray-400",children:[D.result.sett.colors.length," colors"]})]}),i.jsx("button",{onClick:()=>z(null),className:"text-gray-500 hover:text-red-400 text-sm",children:""})]}):i.jsx("p",{className:"text-center text-gray-500 py-2",children:"Click a tartan to select Parent 2"})}),i.jsx("button",{onClick:vf,disabled:!E||!D,className:`px-6 py-3 rounded-lg font-medium transition-all ${E&&D?"bg-gradient-to-r from-pink-600 to-purple-600 text-white hover:from-pink-500 hover:to-purple-500":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:" Breed Offspring"})]}),E&&D&&i.jsx("p",{className:"mt-3 text-xs text-gray-400 text-center",children:"Will create 4 offspring: interleaved, structure swap (2), and random mix"})]}),c.length===0?i.jsxs("div",{className:"text-center py-20",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("h2",{className:"text-2xl font-semibold text-gray-300 mb-2",children:"Ready to design tartans?"}),i.jsx("p",{className:"text-gray-500 mb-6",children:"Configure your constraints and roll to generate mathematically valid patterns."}),i.jsx("button",{onClick:Ls,className:"btn-primary",children:"Roll Your First Tartan"})]}):i.jsx("div",{className:"grid sm:grid-cols-2 xl:grid-cols-3 gap-3",children:c.map(U=>i.jsx(Cv,{data:U,config:u,customColors:Pe,breedingMode:M,isSelectedForBreeding:(E==null?void 0:E.id)===U.id||(D==null?void 0:D.id)===U.id,onSelectForBreeding:xf,onMutate:jf,onEdit:Cf,onTiledPreview:x,onCopySeed:Pf,onDownloadSVG:Rf,onDownloadWIF:Ef,onDownloadPNG:Tf,onShowYarnCalc:p,onShowMockups:O},U.id))})]})]})}),i.jsx("footer",{className:"flex-shrink-0 h-6 flex items-center justify-center border-t border-gray-800/50 text-[10px] text-gray-600",children:"Scottish Register conventions  Built for plaid"}),v&&i.jsx(Rv,{initialSett:m==null?void 0:m.result.sett,config:u,customColors:Pe,onSave:Nf,onClose:()=>{y(!1),h(null)}}),b&&i.jsx(Ev,{data:b,config:u,customColors:Pe,onClose:()=>x(null)}),d&&i.jsx(Uv,{data:d,config:u,onClose:()=>p(null)}),f&&i.jsx(Wv,{onClose:()=>w(!1)}),j&&i.jsx(Fv,{onClose:()=>_(!1),onColorsChange:U=>Fr(U)}),k&&i.jsx(Kv,{onClose:()=>S(!1),threadGauge:u.threadGauge}),C&&i.jsx(Dv,{onClose:()=>R(!1),onSelectTartan:yf,config:u}),re&&i.jsx(Tv,{data:re,config:u,customColors:Pe,onClose:()=>O(null)}),G&&i.jsx(Pv,{onClose:()=>K(!1),onColorsExtracted:wf,onSaveAsYarn:bf}),J&&i.jsx(Iv,{onClose:()=>ne(!1),onCreatePattern:kf}),et&&i.jsx(Ov,{onClose:()=>ke(!1),onCreatePattern:Sf}),kt&&i.jsx(Mv,{onClose:()=>L(!1),onCreatePattern:_f}),W&&i.jsx(Bv,{onClose:()=>A(!1)})]})}Ki.createRoot(document.getElementById("root")).render(i.jsx(qf.StrictMode,{children:i.jsx(kv,{children:i.jsx(zv,{})})}));
//# sourceMappingURL=index-_RUyMC01.js.map
